{"version":3,"names":["InputSelectDynamic","exports","class_1","hostRef","this","apiData","lightUp","data","Array","loading","message","prototype","FetchData","strings","common","get","headers","Headers","append","fetch","api","method","credentials","then","response","ok","status","json","_this","catch","error","Number","isInteger","inputConnectionError","navigator","onLine","inputInternetConnectionError","_a","sent","Validate","IsValid","componentWillLoad","Decode","input","doc","DOMParser","parseFromString","documentElement","textContent","render","h","key","class","name","label","map","item","selected","selectedId","value","style","top","left","width","height","backgroundColor","onClick","inputRefresh"],"sources":["src/components/input/inputSelectDynamic.tsx"],"sourcesContent":["import { Component, h, Prop, State, Watch, Method } from '@stencil/core';\nimport { common } from '../../global/data/common';\n\n\ninterface SelectOption {\n    name: string;\n    value: string;\n}\n\n\n@Component({\n      tag: 'ks-input-select-dynamic'\n})\nexport class InputSelectDynamic {\n\n    @Prop() name: string;\n    @Prop() label: string;\n\n    @Prop() api: string;\n    @Prop({mutable: true, reflect: true}) apiData = \"\";\n    @Prop() selectedId: string;\n\n    @Prop({mutable: true}) lightUp: boolean = false;\n\n    @State() data = new Array<SelectOption>();\n\n    @State() loading: boolean = false;\n    @State() message: string = \"\";\n\n    @Watch('apiData')\n    async FetchData() {\n        const strings = common.get(\"translations\");\n\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        this.loading = true;\n        this.message = \"\";\n        await fetch(this.api + this.apiData, {\n            method: 'GET',\n            headers: headers,\n            credentials: \"same-origin\"\n        })\n            .then(response => {\n                if(!response.ok)\n                    throw response.status;\n\n                return response.json()\n            })\n            .then(data => {\n                this.data = data;\n            })\n            .catch(error => {\n                let message = error;\n\n                if(Number.isInteger(error))\n                    message = strings.inputConnectionError + error;\n\n                else if(!navigator.onLine)\n                    message = strings.inputInternetConnectionError;\n\n                this.message = message;\n            });\n    \n        this.loading = false;\n    }\n\n    @Method()\n    async Validate() {\n        this.lightUp = false;\n    }\n\n    @Method()\n    async IsValid() {\n        return !this.loading && this.message == \"\";\n    }\n\n    componentWillLoad() {\n        this.FetchData();\n    }\n\n    Decode(input) {\n        var doc = new DOMParser().parseFromString(input, \"text/html\");\n        return doc.documentElement.textContent;\n    }\n\n\trender() {            \n        const strings = common.get(\"translations\");\n\n        return(\n            <div class=\"uk-position-relative\">\n                <ks-input-select name={this.name} label={this.label} error={this.message != \"\"} light-up={this.lightUp}>\n                    {this.data.map( (item: SelectOption)=>\n                        <option selected={this.selectedId == item.value ? true : false} value={item.value}>{this.Decode(item.name)}</option>\n                    )}\n                </ks-input-select>\n\n                {this.loading ?\n                    <div class=\"uk-position-absolute uk-animation-fade\"\n                         style={{top: \"20px\", left: \"0px\", width: \"100%\", height: \"50px\", backgroundColor: \"rgba(255, 255, 255, 0.7)\"}}>\n\n                        <div uk-spinner class=\"uk-position-center\"></div>\n                    </div>\n                : null}\n\n                {this.message != \"\" ?\n                    <div class=\"uk-position-absolute\"\n                         style={{top: \"20px\", left: \"0px\", width: \"100%\", height: \"50px\", backgroundColor: \"rgba(255, 255, 255)\"}}>\n\n                        <p class=\"uk-position-center uk-text-danger\">\n                            {this.message} <a onClick={()=>this.FetchData()}>{strings.inputRefresh}</a>\n                        </p>\n                        \n                    </div>\n                : null}\n            </div>\n        );\n    }\n}\n"],"mappings":"qrDAaaA,EAAkBC,EAAA,qCAH/B,SAAAC,EAAAC,G,UAS0CC,KAAOC,QAAG,GAGzBD,KAAOE,QAAY,MAEjCF,KAAAG,KAAO,IAAIC,MAEXJ,KAAOK,QAAY,MACnBL,KAAOM,QAAW,EA4F9B,CAzFSR,EAAAS,UAAAC,UAAN,W,+HACUC,EAAUC,EAAOC,IAAI,gBAEvBC,EAAU,IAAIC,QAClBD,EAAQE,OAAO,SAAU,YACzBF,EAAQE,OAAO,gBAAiB,YAEhCd,KAAKK,QAAU,KACfL,KAAKM,QAAU,GACf,SAAMS,MAAMf,KAAKgB,IAAMhB,KAAKC,QAAS,CACjCgB,OAAQ,MACRL,QAASA,EACTM,YAAa,gBAEZC,MAAK,SAAAC,GACF,IAAIA,EAASC,GACT,MAAMD,EAASE,OAEnB,OAAOF,EAASG,MACpB,IACCJ,MAAK,SAAAhB,GACFqB,EAAKrB,KAAOA,CAChB,IACCsB,OAAM,SAAAC,GACH,IAAIpB,EAAUoB,EAEd,GAAGC,OAAOC,UAAUF,GAChBpB,EAAUG,EAAQoB,qBAAuBH,OAExC,IAAII,UAAUC,OACfzB,EAAUG,EAAQuB,6BAEtBR,EAAKlB,QAAUA,CACnB,K,OAxBJ2B,EAAAC,OA0BAlC,KAAKK,QAAU,M,kBAIbP,EAAAS,UAAA4B,SAAN,W,qFACInC,KAAKE,QAAU,M,iBAIbJ,EAAAS,UAAA6B,QAAN,W,qFACI,UAAQpC,KAAKK,SAAWL,KAAKM,SAAW,G,QAG5CR,EAAAS,UAAA8B,kBAAA,WACIrC,KAAKQ,W,EAGTV,EAAAS,UAAA+B,OAAA,SAAOC,GACH,IAAIC,GAAM,IAAIC,WAAYC,gBAAgBH,EAAO,aACjD,OAAOC,EAAIG,gBAAgBC,W,EAGlC9C,EAAAS,UAAAsC,OAAA,eAAArB,EAAAxB,KACO,IAAMS,EAAUC,EAAOC,IAAI,gBAE3B,OACImC,EAAA,OAAAC,IAAA,2CAAKC,MAAM,wBACPF,EAAA,mBAAAC,IAAA,2CAAiBE,KAAMjD,KAAKiD,KAAMC,MAAOlD,KAAKkD,MAAOxB,MAAO1B,KAAKM,SAAW,GAAE,WAAYN,KAAKE,SAC1FF,KAAKG,KAAKgD,KAAK,SAACC,GACb,OAAAN,EAAQ,UAAAO,SAAU7B,EAAK8B,YAAcF,EAAKG,MAAQ,KAAO,MAAOA,MAAOH,EAAKG,OAAQ/B,EAAKc,OAAOc,EAAKH,MAArG,KAIPjD,KAAKK,QACFyC,EAAK,OAAAE,MAAM,yCACNQ,MAAO,CAACC,IAAK,OAAQC,KAAM,MAAOC,MAAO,OAAQC,OAAQ,OAAQC,gBAAiB,6BAEnFf,EAAA,yBAAgBE,MAAM,wBAE5B,KAEDhD,KAAKM,SAAW,GACbwC,EAAK,OAAAE,MAAM,uBACNQ,MAAO,CAACC,IAAK,OAAQC,KAAM,MAAOC,MAAO,OAAQC,OAAQ,OAAQC,gBAAiB,wBAEnFf,EAAG,KAAAE,MAAM,qCACJhD,KAAKM,QAAO,IAAEwC,EAAA,KAAGgB,QAAS,WAAI,OAAAtC,EAAKhB,WAAL,GAAmBC,EAAQsD,gBAIpE,K,kIAtGa,G","ignoreList":[]}
{"version":3,"file":"ks-order-inpost.entry.system.js","sources":["src/components/order/confirmation/orderInpost.css?tag=ks-order-inpost","src/components/order/confirmation/OrderInpost.tsx"],"sourcesContent":["ks-order-inpost .content {\n    background-color: #e8e8e8;\n    position: relative;\n    box-sizing: border-box;\n    margin: 20px;\n    max-width: 1400px;\n    width: 100%;\n    max-height: 100%;\n    overflow-y: auto;\n}\n\n@media screen and (max-width: 640px) {\n    ks-order-inpost .content {\n        margin: 0px;\n    }\n}\n\nks-order-inpost > ks-button {\n    max-width: 300px;\n    height: 46px;\n    margin: 10px auto 0 auto;\n}\n\nks-order-inpost .topBar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background-color: #ffcd00;\n    height: 46px;\n}\n\nks-order-inpost .missing {\n    color: var(--color-secondary);\n    margin-bottom: 10px;\n}\n\nks-order-inpost .topBar ks-img2 {\n    height: 40px;\n}\n\nks-order-inpost .map {\n    height: calc(100dvh - 46px);\n    max-height: 900px;\n    overflow-x: hidden;\n}\n\n@media screen and (max-width: 640px) {\n    ks-order-inpost .map {\n        max-height: 100%;\n    }\n}\n","import { Component, h, Prop, Element, State, Method } from '@stencil/core';\n\n@Component({\n  tag: 'ks-order-inpost',\n  styleUrl: 'orderInpost.css'\n})\nexport class OrderInpost {\n    @Element() root: HTMLElement;\n    @Prop() token: string = \"\";\n    @Prop() api: string = \"\";\n    @Prop() button: string = \"\";\n    @Prop() search: string = \"Wrocław, Polska\";\n    @Prop() phone: string = \"\";\n    \n    @Prop() test: boolean = false;\n\n    @Prop() pointMessage: string = \"\";\n    @Prop() missingMessage: string = \"\";\n    @Prop() invalidPhoneMessage: string = \"\";\n    @Prop() editAddressLink: string = \"\";\n\n    @State() address: string = \"\";\n    @State() code: string = \"\";\n    @State() initialized = false;\n    @State() validPhone = true;\n    @State() validCode = true;\n    @State() valid: boolean = true;\n\n    widget: any;\n    overlay: HTMLKsOverlayElement;\n\n    componentDidLoad() {\n        this.overlay = this.root.querySelector(\"ks-overlay\");\n    }\n\n    componentWillLoad() {\n        this.Validate(true);\n    }\n\n    show(event: Event) {\n        event.preventDefault();\n        this.overlay.show();\n        this.initialized = true;\n    }\n\n    hide(event?: Event) {\n        event?.preventDefault();\n        this.overlay.hide();\n        this.Validate();\n    }\n\n\n    @Method()\n    async Validate(initial = false) {\n        if(/^[+]*(?:48)*\\s*(?:45|50|51|53|57|60|66|69|72|73|78|79|88)(?:(?:[0-9]{7})|(?:[0-9]\\s[0-9]{3}\\s[0-9]{3}))$/.test(this.phone) === false) {\n            this.valid = false;\n            this.validPhone = false;\n            return;\n        }\n\n        if(this.code === \"\") {\n            this.valid = false;\n            if(!initial) this.validCode = false; // give a chance before yelling at the user\n            return;\n        }\n\n        this.valid = true;\n        this.validPhone = true;\n        this.validCode = true;\n    }\n\n    @Method()\n    async IsValid() {\n        return this.valid;\n    }\n\n    @Method()\n        async select(point: string, address: string) {\n            this.code = point;\n            this.address = address;\n            this.Validate();\n            this.hide(null);\n    \n            let formData = new FormData();\n                formData.append(\"rodzaj\", \"wysylka_inpost\");\n                formData.append(\"koszyk\", \"0\");\n                formData.append(\"value\", address);\n                formData.append(\"punktodbioru\", point);\n            \n            var headers = new Headers();\n                headers.append('pragma', 'no-cache');\n                headers.append('cache-control', 'no-cache');\n            \n            fetch(this.api, {\n                method: 'POST', \n                headers: headers, \n                body: formData,\n                credentials: \"same-origin\"\n            });\n        }\n\n    render() {\n        const endpoint = this.test ?\n            \"https://sandbox-easy-geowidget-sdk.easypack24.net\" :\n            \"https://geowidget.inpost.pl\"\n\n        return [\n            this.code ? <p>{this.pointMessage}: {this.code}</p> : null,\n            !this.validCode && <p class=\"missing\">{this.missingMessage}</p>,\n            !this.validPhone && <p class=\"missing\">{this.invalidPhoneMessage} {this.phone && `Podany nr: ${this.phone}`}</p>,\n\n            this.validPhone ? \n                <ks-button round icon=\"map-pin\" secondary={!this.validCode} onClick={(e)=>this.show(e)} name={this.button}/> :\n                <ks-button round icon=\"edit\" secondary={true} link={this.editAddressLink} name={\"Edytuj dane wysyłki\"}/>,\n                    \n            <input type=\"hidden\" name=\"lokalizacjaRuch\" value={this.code}/>,\n            <input type=\"hidden\" name=\"ShippingDestinationCode\" value={this.code}/>,\n\n            <ks-overlay dark>\n                <div class=\"content\">\n                    <div class=\"topBar\">\n                        <ks-img2 src=\"res/cart/inpost-dark.svg\" vertical height={100} width={300}/>\n                        <ks-button transparent icon=\"x\" onClick={(e)=>this.hide(e)} />\n                    </div>\n                    {this.initialized && [\n                        <link rel=\"stylesheet\" href={`${endpoint}/inpost-geowidget.css`}/>,\n                        <script src={`${endpoint}/inpost-geowidget.js`} defer></script>,\n\n                        <script type=\"text/javascript\" innerHTML=\"\n                            document.addEventListener('onpointselect', (event) => {\n                                console.log(event)\n                                document.querySelector('ks-order-inpost').select(event.detail.name, event.detail.address.line1 + ' ' + event.detail.address.line2)\n                            });\n                        \"></script>,\n                        \n                        <div class=\"map\" innerHTML={`<inpost-geowidget onpoint=\"onpointselect\" token='${this.token}' language='pl' config='parcelcollect'></inpost-geowidget>`} />\n                    ]}\n                </div>\n            </ks-overlay>\n        ];\n    }\n}"],"names":[],"mappings":"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"}
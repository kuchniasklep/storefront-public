{"version":3,"names":["productNotifyCss","ProductNotify","exports","class_1","prototype","requestHandler","event","strings","product","get","productId","api","commonDynamic","notifyAvailability","preventDefault","ValidateInput","this","root","querySelector","_a","sent","dialog","showLoading","target","data","FormData","append","fetch","body","method","then","response","__awaiter","_this","__generator","json","containsData","Error","notifyErrorParagraph","status","showSuccess","heading","paragraph","showFailure","catch","error","message","window","navigator","onLine","noInternet","console","log","notifyErrorHeading","show","componentDidLoad","render","h","onSubmit","e","class","notifyHeading","notifyParagraph","href","common","email","name","required","nomessage","placeholder","icon","checked","label","notifyBackorders","notifyAgreement","submit","notifyMe"],"sources":["src/components/product/product-notify.css?tag=ks-product-notify","src/components/product/product-notify.tsx"],"sourcesContent":["ks-product-notify {\n    display: block;\n}\n\nks-product-notify fieldset {\n    border: none;\n    margin: 0;\n    padding: 0;\n}\n\nks-product-notify .info {\n    text-align: center;\n    margin-bottom: 40px;\n}\n\nks-product-notify .info a {\n    text-decoration: none;\n    color: black;\n    margin: 0 5px;\n}\n\nks-product-notify h3 {\n    font-family: var(--font-emphasis);\n    font-size: 20px;\n    font-weight: 700;\n}\n\nks-product-notify ks-input-check {\n    margin-bottom: 5px;\n}\n\nks-product-notify ks-button {\n    margin-top: 20px;\n}","import { Component, h, Element, Method, State } from '@stencil/core';\nimport { product } from \"../../global/data/product\";\nimport { common } from \"../../global/data/common\";\nimport { commonDynamic } from \"../../global/data/commonDynamic\";\nimport ValidateInput from '../input/validate';\n\n@Component({\n    tag: 'ks-product-notify',\n    styleUrl: 'product-notify.css'\n})\nexport class ProductNotify {\n    @Element() root: HTMLElement;\n    dialog: HTMLKsDialogElement;\n\n    @State() resultHeading: string;\n    @State() resultParagraph: string;\n\n    async requestHandler(event: Event) {\n        const strings = product.get(\"strings\");\n        const productId = product.get(\"id\");\n        const api = commonDynamic.get(\"api\").notifyAvailability;\n\n        event.preventDefault();\n        if(!await ValidateInput(this.root.querySelector('form')))\n            return;\n\n        this.dialog.showLoading();\n\n        const target = event.target as HTMLFormElement;\n        const data = new FormData(target);\n        data.append(\"product\", productId);\n\n        await fetch(api, { body: data, method: \"post\"})\n        .then(async response => response.json())\n        .then(async data => {\n            const containsData = \"status\" in data && \"heading\" in data && \"paragraph\" in data;\n            if (!containsData) throw new Error(strings.notifyErrorParagraph);\n                \n            if(data.status == \"success\")\n                this.dialog.showSuccess(data.heading, data.paragraph);\n\n            else this.dialog.showFailure(data.heading, data.paragraph);\n        })\n        .catch(async error => {\n            let message = \"\";\n\n            if(!window.navigator.onLine)\n                message = strings.noInternet;\n\n            else if(error.message != \"\")\n                message = error.message;\n\n            console.log(error.message);\n            this.dialog.showFailure(strings.notifyErrorHeading, message);\n        });\n    }\n\n    @Method()\n    async show() {\n        this.dialog.show();\n    }\n\n    componentDidLoad() {\n        this.dialog = this.root.querySelector('ks-dialog');\n    }\n\n\trender() {\n        const strings = product.get(\"strings\");\n\n\t\treturn <ks-dialog>\n            <form onSubmit={e => this.requestHandler(e)}>\n                <fieldset>\n                    <div class=\"info\">\n                        <h3>{strings.notifyHeading}</h3>\n                        <p>{strings.notifyParagraph}</p>\n\n                        <a href={\"mailto:\" + common.get('email')}>{common.get('email')}</a> â€¢\n                        <a href={\"tel:\" + common.get('phone')}>{common.get('phone')}</a>\n                    </div>\n\n                    <ks-input-text email name=\"email\" required nomessage placeholder=\"E-mail\" icon=\"mail\"/>\n                    <ks-input-check checked name=\"backorders\" nomessage label={strings.notifyBackorders}></ks-input-check>\n\n                    <ks-input-check name=\"zgoda\" required nomessage label={strings.notifyAgreement}></ks-input-check>\n\n                    <ks-button submit name={strings.notifyMe} />\n                </fieldset>\n            </form>\n        </ks-dialog>;\n    }\n\n}\n"],"mappings":"o2DAAA,IAAMA,EAAmB,sZ,ICUZC,EAAaC,EAAA,+B,oFAOhBC,EAAAC,UAAAC,eAAN,SAAqBC,G,qIACXC,EAAUC,EAAQC,IAAI,WACtBC,EAAYF,EAAQC,IAAI,MACxBE,EAAMC,EAAcH,IAAI,OAAOI,mBAErCP,EAAMQ,iBACF,SAAMC,EAAcC,KAAKC,KAAKC,cAAc,U,OAAhD,IAAIC,EAAAC,OACA,UAEJJ,KAAKK,OAAOC,cAENC,EAASjB,EAAMiB,OACfC,EAAO,IAAIC,SAASF,GAC1BC,EAAKE,OAAO,UAAWhB,GAEvB,SAAMiB,MAAMhB,EAAK,CAAEiB,KAAMJ,EAAMK,OAAQ,SACtCC,MAAK,SAAMC,GAAQ,OAAAC,UAAAC,OAAA,4BAAAC,YAAAlB,MAAA,SAAAG,GAAI,SAAAY,EAASI,O,UAChCL,MAAK,SAAMN,GAAI,OAAAQ,UAAAC,OAAA,qB,2CACNG,EAAe,WAAYZ,GAAQ,YAAaA,GAAQ,cAAeA,EAC7E,IAAKY,EAAc,MAAM,IAAIC,MAAM9B,EAAQ+B,sBAE3C,GAAGd,EAAKe,QAAU,UACdvB,KAAKK,OAAOmB,YAAYhB,EAAKiB,QAASjB,EAAKkB,gBAE1C1B,KAAKK,OAAOsB,YAAYnB,EAAKiB,QAASjB,EAAKkB,W,mBAEnDE,OAAM,SAAMC,GAAK,OAAAb,UAAAC,OAAA,qB,2CACVa,EAAU,GAEd,IAAIC,OAAOC,UAAUC,OACjBH,EAAUvC,EAAQ2C,gBAEjB,GAAGL,EAAMC,SAAW,GACrBA,EAAUD,EAAMC,QAEpBK,QAAQC,IAAIP,EAAMC,SAClB9B,KAAKK,OAAOsB,YAAYpC,EAAQ8C,mBAAoBP,G,2BArBxD3B,EAAAC,O,kBA0BEjB,EAAAC,UAAAkD,KAAN,W,qFACItC,KAAKK,OAAOiC,O,iBAGhBnD,EAAAC,UAAAmD,iBAAA,WACIvC,KAAKK,OAASL,KAAKC,KAAKC,cAAc,Y,EAG7Cf,EAAAC,UAAAoD,OAAA,eAAAvB,EAAAjB,KACO,IAAMT,EAAUC,EAAQC,IAAI,WAElC,OAAOgD,EAAA,iBACGA,EAAA,QAAMC,SAAU,SAAAC,GAAK,OAAA1B,EAAK5B,eAAesD,EAApB,GACjBF,EAAA,gBACIA,EAAA,OAAKG,MAAM,QACPH,EAAA,UAAKlD,EAAQsD,eACbJ,EAAA,SAAIlD,EAAQuD,iBAEZL,EAAA,KAAGM,KAAM,UAAYC,EAAOvD,IAAI,UAAWuD,EAAOvD,IAAI,UAAa,KACnEgD,EAAA,KAAGM,KAAM,OAASC,EAAOvD,IAAI,UAAWuD,EAAOvD,IAAI,WAGvDgD,EAAA,iBAAeQ,MAAK,KAACC,KAAK,QAAQC,SAAQ,KAACC,UAAS,KAACC,YAAY,SAASC,KAAK,SAC/Eb,EAAA,kBAAgBc,QAAO,KAACL,KAAK,aAAaE,UAAS,KAACI,MAAOjE,EAAQkE,mBAEnEhB,EAAA,kBAAgBS,KAAK,QAAQC,SAAQ,KAACC,UAAS,KAACI,MAAOjE,EAAQmE,kBAE/DjB,EAAA,aAAWkB,OAAM,KAACT,KAAM3D,EAAQqE,a,yHA3E1B,I"}
{"version":3,"names":["orderConfirmationFormCss","OrderForm","constructor","hostRef","this","loading","render","h","key","action","method","onSubmit","event","Submit","rounded","submit","secondary","name","submitString","tall","class","back","preventDefault","form","root","querySelector","inputs","querySelectorAll","highestPosition","Number","MAX_VALUE","valid","i","length","input","closest","Validate","IsValid","inputTop","getBoundingClientRect","top","document","body","window","scroll","behavior","error","ShowPrompt","message","prompt","Show"],"sources":["src/components/order/confirmation/orderConfirmationForm.css?tag=ks-order-confirmation-form","src/components/order/confirmation/orderConfirmationForm.tsx"],"sourcesContent":["ks-order-confirmation-form .formsubmit > * {\n    font-size: 20px;\n    font-weight: 700;\n    font-family: var(--font-emphasis);\n}\n\nks-order-confirmation-form .formsubmit {\n    margin: 20px;\n}","import { Component, h, Prop, State, Element } from '@stencil/core';\n\n@Component({\n      tag: 'ks-order-confirmation-form',\n      styleUrl: 'orderConfirmationForm.css'\n})\nexport class OrderForm {\n    @Prop() action: string;\n    @Prop() method: string;\n    @Prop() submitString: string;\n    @Prop() back: string;\n\n    @Element() root: HTMLElement;\n\n    @State() loading: boolean = false;\n\n\trender() {\n\t\treturn(\n            <form action={this.action} method={this.method} onSubmit={(event)=>this.Submit(event)}>\n                <slot/>\n\n                <ks-button rounded submit secondary name={this.submitString} loading={this.loading} tall class=\"formsubmit\"/>\n                <ks-order-form-modal back={this.back}></ks-order-form-modal>\n            </form>\n\t\t);\n    }\n\n    async Submit(event: Event) {\n        event.preventDefault();\n\n        const form = this.root.querySelector(\"form\");\n        const inputs = form.querySelectorAll(\"ks-input-dynamic, ks-order-document-select, ks-input-text, ks-input-textarea, ks-input-check, ks-order-inpost, ks-order-pocztapunkt, ks-order-dpd\");\n\n        let highestPosition = Number.MAX_VALUE;\n\n        let valid = true;\n        for (let i = 0; i < inputs.length; i++) {\n            const input = inputs[i] as any;\n            \n            if(input.closest(\"ks-input-dynamic *\") != null) continue;\n\n            await input.Validate();\n            if(!await input.IsValid()) {\n                const inputTop = (input as HTMLElement).getBoundingClientRect().top\n                    - document.body.getBoundingClientRect().top;\n\n                if(inputTop < highestPosition)\n                    highestPosition = inputTop;\n\n                valid = false;\n            }\n        }\n\n        if(valid) {\n            this.loading = true;\n            form.submit();\n        }\n\n        else {\n            try {\n                window.scroll({top: highestPosition -100, behavior: \"smooth\"});\n            }\n            catch(error) {\n                window.scroll(0, highestPosition -100);\n            }\n        }\n    }\n\n    ShowPrompt(message: string) {\n        const prompt = this.root.querySelector(\"ks-order-form-modal\") as any;\n        prompt.Show(message);\n    }\n}\n"],"mappings":"sDAAA,MAAMA,EAA2B,+J,MCMpBC,EAAS,MAJtB,WAAAC,CAAAC,G,UAYaC,KAAOC,QAAY,KA0D/B,CAxDA,MAAAC,GACC,OACUC,EAAM,QAAAC,IAAA,2CAAAC,OAAQL,KAAKK,OAAQC,OAAQN,KAAKM,OAAQC,SAAWC,GAAQR,KAAKS,OAAOD,IAC3EL,EAAO,QAAAC,IAAA,6CAEPD,EAAW,aAAAC,IAAA,2CAAAM,QAAO,KAACC,OAAM,KAACC,UAAU,KAAAC,KAAMb,KAAKc,aAAcb,QAASD,KAAKC,QAASc,KAAK,KAAAC,MAAM,eAC/Fb,EAAqB,uBAAAC,IAAA,2CAAAa,KAAMjB,KAAKiB,O,CAK5C,YAAMR,CAAOD,GACTA,EAAMU,iBAEN,MAAMC,EAAOnB,KAAKoB,KAAKC,cAAc,QACrC,MAAMC,EAASH,EAAKI,iBAAiB,qJAErC,IAAIC,EAAkBC,OAAOC,UAE7B,IAAIC,EAAQ,KACZ,IAAK,IAAIC,EAAI,EAAGA,EAAIN,EAAOO,OAAQD,IAAK,CACpC,MAAME,EAAQR,EAAOM,GAErB,GAAGE,EAAMC,QAAQ,uBAAyB,KAAM,eAE1CD,EAAME,WACZ,UAAUF,EAAMG,UAAW,CACvB,MAAMC,EAAYJ,EAAsBK,wBAAwBC,IAC1DC,SAASC,KAAKH,wBAAwBC,IAE5C,GAAGF,EAAWV,EACVA,EAAkBU,EAEtBP,EAAQ,K,EAIhB,GAAGA,EAAO,CACN3B,KAAKC,QAAU,KACfkB,EAAKR,Q,KAGJ,CACD,IACI4B,OAAOC,OAAO,CAACJ,IAAKZ,EAAiB,IAAKiB,SAAU,U,CAExD,MAAMC,GACFH,OAAOC,OAAO,EAAGhB,EAAiB,I,GAK9C,UAAAmB,CAAWC,GACP,MAAMC,EAAS7C,KAAKoB,KAAKC,cAAc,uBACvCwB,EAAOC,KAAKF,E","ignoreList":[]}
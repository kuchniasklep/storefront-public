{"version":3,"file":"ks-input-dynamic.entry.system.js","sources":["src/components/input/inputDynamic.tsx"],"sourcesContent":["import { Component, h, Prop, Element, Method, State } from '@stencil/core';\nimport { common } from '../../global/data/common';\n\n\n@Component({\n      tag: 'ks-input-dynamic'\n})\nexport class InputDynamic {\n    @Element() root: HTMLElement;\n\n    @Prop() api: string = \"\";\n    @Prop() message: string = \"\";\n\n    ready: Promise<boolean>;\n\n    componentDidLoad() { \n        const input = this.root.querySelector(\"input\") as HTMLInputElement;\n        const component = this.root.querySelector(\"ks-input-text\") as HTMLKsInputTextElement;\n        component.setAttribute(\"novalidate\", \"novalidate\");\n\n        input.onchange = ()=>this.Validate();\n    }\n\n    @Method()\n    async Validate() {\n        const strings = common.get(\"translations\");\n\n        const input = this.root.querySelector(\"input\") as HTMLInputElement;\n        const component = this.root.querySelector(\"ks-input-text\") as HTMLKsInputTextElement;\n\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        this.ready = new Promise<boolean>(async (resolve)=>{\n            await component.Validate()\n            if(await component.IsValid()) {\n                this.loading = true;\n\n                await fetch(this.api + input.value, {\n                    method: 'GET', \n                    headers: headers,\n                    credentials: \"same-origin\"\n                })\n                    .then(response => {\n                        if(!response.ok)\n                            throw response.status;\n\n                        return response.text();\n                    })\n                    .then(data => {\n                        if (data == \"false\")\n                            throw this.message;\n\n                        else if (data != \"true\")\n                            throw data;\n\n                        else resolve(true);\n                    })\n                    .catch(error => {\n                        let message = error;\n\n                        if(Number.isInteger(error))\n                            message = strings.inputConnectionError + error;\n\n                        else if(!navigator.onLine)\n                            message = strings.inputInternetConnectionError;\n                        \n                        component.setAttribute(\"message\", message);\n                        resolve(false);\n                    });\n            }\n            else resolve(false);\n\n            this.loading = false;\n        });\n    }\n\n    @Method()\n    async IsValid() {\n        return await this.ready;\n    }\n\n    @State() loading: boolean = false;\n\n\trender() {\n\t\treturn (\n            <div class=\"uk-position-relative\">\n                <slot />\n\n                {this.loading ?\n                    <div class=\"uk-position-absolute uk-animation-fade\"\n                         style={{top: \"7px\", right: \"7px\", animationDuration: \"0.3s\", animationDelay: \"0.5s\"}}\n                         uk-spinner=\"ratio: 0.9\">\n                    </div>\n                : null}\n            </div>\n        );\n    }\n}\n"],"names":[],"mappings":"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"}
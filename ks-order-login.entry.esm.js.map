{"version":3,"file":"ks-order-login.entry.esm.js","sources":["src/components/order/shipping/orderLogin.css?tag=ks-order-login","src/components/order/shipping/orderLogin.tsx"],"sourcesContent":["ks-order-login {\n    display: block;\n    padding: 30px;\n    background-color: #f2f2f2;\n    text-align: center;\n}\n\n@media (min-width: 1200px) {\n    ks-order-login {\n        padding: 40px;\n    }\n}\n\nks-order-login .contents {\n    max-width: 500px;\n    margin: auto;\n}\n\nks-order-login .recovery {\n    display: block;\n    margin-top: 10px;\n}\n\nks-order-login .contents h1 {\n    font-weight: 700;\n    font-size: 28px;\n}","import { Component, h, Element, Prop, Host } from '@stencil/core';\n\n@Component({\n  tag: 'ks-order-login',\n  styleUrl: 'orderLogin.css'\n})\nexport class OrderLogin {\n\n    @Element() root: HTMLElement;\n\n    @Prop() api: string = \"\";\n    @Prop() action: string = \"\";\n    @Prop() passwordMessage: string = \"\";\n    @Prop() passwordRecovery: string = \"\";\n\n    @Prop() heading: string = \"\";\n    @Prop() login: string = \"\";\n    @Prop() passwordRecoveryString: string = \"\";\n    @Prop() cartProductsMessage: string = \"\";\n\n    @Prop() promptHeading: string = \"\";\n    @Prop() promptToCart: string = \"\";\n    @Prop() promptToConfirmation: string = \"\";\n\n    render() {\n        return <Host>\n            <section class=\"contents\">\n                <h1>{this.heading}</h1>\n\n                <form onSubmit={(event)=>this.Submit(event)}>\n                    <slot />\n\n                    <ks-button submit name={this.login} />\n                </form>\n\n                <a class=\"recovery\" href={this.passwordRecovery}>\n                    {this.passwordRecoveryString}\n                </a>\n            </section>\n            <ks-order-login-prompt \n                heading={this.promptHeading}\n                toCart={this.promptToCart}\n                toConfirmation={this.promptToConfirmation}\n            />\n        </Host>;\n    }\n\n    async Submit(event: Event) {\n        event.preventDefault();\n\n        const form = this.root.querySelector(\"form\");\n        const email = form.querySelector(\"ks-input-dynamic, ks-input-text[email]\") as HTMLKsInputDynamicElement;\n        const pass = form.querySelector(\"ks-input-text[password]\") as HTMLKsInputTextElement;\n\n        await email.Validate();\n        await pass.Validate();\n\n        if (await email.IsValid() && await pass.IsValid()) {\n            var headers = new Headers();\n            headers.append('pragma', 'no-cache');\n            headers.append('cache-control', 'no-cache');\n\n            const formData = new FormData(form);\n\n            const response = await fetch(this.api, {\n                body: formData,\n                method: 'POST',\n                headers: headers,\n                credentials: \"same-origin\"\n            }).then(response => response.text());\n\n            if(response == \"false\")\n                pass.message = this.passwordMessage;\n\n            else if(response == \"true\") {\n                this.LoginPrompt(formData);\n            }\n        }\n    }\n\n    async LoginPrompt(data: FormData) {\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        const formData = new FormData();\n        formData.set(\"data\", `email=${encodeURIComponent(data.get(\"email\").toString())}&haslo=${encodeURIComponent(data.get(\"haslo\").toString())}`)\n\n        const response = await fetch(this.action, {\n            body: formData,\n            method: 'POST',\n            headers: headers,\n            credentials: \"same-origin\"\n        }).then(response => response.text());\n\n        const dialog = this.root.querySelector(\"ks-order-login-prompt\");\n\n        if(response.search(\"koszyk.html\") != -1) dialog.show(this.cartProductsMessage);\n        else dialog.show();\n    }\n}"],"names":[],"mappings":"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"}
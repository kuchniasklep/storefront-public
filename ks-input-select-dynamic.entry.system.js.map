{"version":3,"file":"ks-input-select-dynamic.entry.system.js","sources":["src/components/input/inputSelectDynamic.tsx"],"sourcesContent":["import { Component, h, Prop, State, Watch, Method } from '@stencil/core';\nimport { common } from '../../global/data/common';\n\n\ninterface SelectOption {\n    name: string;\n    value: string;\n}\n\n\n@Component({\n      tag: 'ks-input-select-dynamic'\n})\nexport class InputSelectDynamic {\n\n    @Prop() name: string;\n    @Prop() label: string;\n\n    @Prop() api: string;\n    @Prop({mutable: true, reflect: true}) apiData = \"\";\n    @Prop() selectedId: string;\n\n    @Prop({mutable: true}) lightUp: boolean = false;\n\n    @State() data = new Array<SelectOption>();\n\n    @State() loading: boolean = false;\n    @State() message: string = \"\";\n\n    @Watch('apiData')\n    async FetchData() {\n        const strings = common.get(\"translations\");\n\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        this.loading = true;\n        this.message = \"\";\n        await fetch(this.api + this.apiData, {\n            method: 'GET',\n            headers: headers,\n            credentials: \"same-origin\"\n        })\n            .then(response => {\n                if(!response.ok)\n                    throw response.status;\n\n                return response.json()\n            })\n            .then(data => {\n                this.data = data;\n            })\n            .catch(error => {\n                let message = error;\n\n                if(Number.isInteger(error))\n                    message = strings.inputConnectionError + error;\n\n                else if(!navigator.onLine)\n                    message = strings.inputInternetConnectionError;\n\n                this.message = message;\n            });\n    \n        this.loading = false;\n    }\n\n    @Method()\n    async Validate() {\n        this.lightUp = false;\n    }\n\n    @Method()\n    async IsValid() {\n        return !this.loading && this.message == \"\";\n    }\n\n    componentWillLoad() {\n        this.FetchData();\n    }\n\n    Decode(input) {\n        var doc = new DOMParser().parseFromString(input, \"text/html\");\n        return doc.documentElement.textContent;\n    }\n\n\trender() {            \n        const strings = common.get(\"translations\");\n\n        return(\n            <div class=\"uk-position-relative\">\n                <ks-input-select name={this.name} label={this.label} error={this.message != \"\"} light-up={this.lightUp}>\n                    {this.data.map( (item: SelectOption)=>\n                        <option selected={this.selectedId == item.value ? true : false} value={item.value}>{this.Decode(item.name)}</option>\n                    )}\n                </ks-input-select>\n\n                {this.loading ?\n                    <div class=\"uk-position-absolute uk-animation-fade\"\n                         style={{top: \"20px\", left: \"0px\", width: \"100%\", height: \"50px\", backgroundColor: \"rgba(255, 255, 255, 0.7)\"}}>\n\n                        <div uk-spinner class=\"uk-position-center\"></div>\n                    </div>\n                : null}\n\n                {this.message != \"\" ?\n                    <div class=\"uk-position-absolute\"\n                         style={{top: \"20px\", left: \"0px\", width: \"100%\", height: \"50px\", backgroundColor: \"rgba(255, 255, 255)\"}}>\n\n                        <p class=\"uk-position-center uk-text-danger\">\n                            {this.message} <a onClick={()=>this.FetchData()}>{strings.inputRefresh}</a>\n                        </p>\n                        \n                    </div>\n                : null}\n            </div>\n        );\n    }\n}\n"],"names":[],"mappings":"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"}
{"version":3,"names":["orderInpostCss","OrderInpost","constructor","hostRef","this","api","button","search","pointMessage","missingMessage","description","address","code","initialized","valid","componentDidLoad","overlay","root","querySelector","show","event","preventDefault","window","easyPackAsyncInit","easyPack","init","defaultLocale","mapType","searchType","points","types","functions","map","initialTypes","widget","mapWidget","point","name","value","punktodbioru","formData","FormData","append","headers","Headers","fetch","method","body","credentials","Validate","hide","searchPlace","IsValid","render","h","class","key","round","icon","onClick","e","type","dark","src","vertical","height","width","transparent","rel","href","async","id"],"sources":["src/components/order/confirmation/orderInpost.css?tag=ks-order-inpost","src/components/order/confirmation/OrderInpost.tsx"],"sourcesContent":["ks-order-inpost .content {\n    background-color: #e8e8e8;\n\n    position: relative;\n    box-sizing: border-box;\n    margin: 20px;\n    max-width: 1400px;\n    width: 100%;\n    max-height: 100%;\n    overflow-y: auto;\n}\n\n@media screen and (max-width: 640px) {\n    ks-order-inpost .content {\n        margin: 0px;\n    }\n}\n\nks-order-inpost > ks-button {\n    max-width: 300px;\n    height: 46px;\n    margin: 15px auto 0 auto;\n}\n\nks-order-inpost .topBar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background-color: #ffcd00;\n    height: 46px;\n}\n\nks-order-inpost .missing {\n    color: #dc0032;\n}\n\nks-order-inpost .topBar ks-img2 {\n    height: 40px;\n}\n\nks-order-inpost #easypack-map {\n    height: calc(100dvh - 46px);\n    max-height: 900px;\n    overflow-x: hidden;\n}\n\n@media screen and (max-width: 640px) {\n    ks-order-inpost #easypack-map {\n        max-height: 100%;\n    }\n}\n","import { Component, h, Prop, Element, State, Method } from '@stencil/core';\ndeclare var easyPack: any;\n\n@Component({\n  tag: 'ks-order-inpost',\n  styleUrl: 'orderInpost.css'\n})\nexport class OrderInpost {\n    @Element() root: HTMLElement;\n    @Prop() api: string = \"\";\n    @Prop() button: string = \"\";\n    @Prop() search: string = \"WrocÅ‚aw, Polska\";\n    \n    @Prop() pointMessage: string = \"\";\n    @Prop() missingMessage: string = \"\";\n\n    @State() description: string = \"\";\n    @State() address: string = \"\";\n    @State() code: string = \"\";\n\n    @State() initialized = false;\n\n    widget: any;\n    overlay: HTMLKsOverlayElement;\n\n    componentDidLoad() {\n        this.overlay = this.root.querySelector(\"ks-overlay\");\n    }\n\n    show(event: Event) {\n        event.preventDefault();\n        this.overlay.show();\n\n        if(!this.initialized) {\n            (window as any).easyPackAsyncInit = ()=>{\n                easyPack.init({\n                    defaultLocale: 'pl',\n                    mapType: 'osm',\n                    searchType: 'osm',\n                    points: {\n                        types: ['parcel_locker'],\n                        functions: ['parcel_collect']\n                    },\n                    map: {\n                        initialTypes: ['parcel_locker']\n                    }\n                });\n    \n                this.widget = easyPack.mapWidget(\"easypack-map\", (point) => {\n                    this.address = point.name + \", \" + point.address[\"line1\"] + \", \" + point.address[\"line2\"];\n                    this.code = point.name;\n                    this.description = point.address[\"line1\"] + \", \" + point.address[\"line2\"] + \"<br />\" + point.name;\n        \n                    const value = point.address[\"line1\"] + \", \" + point.address[\"line2\"] + \"  (\" + point.name + \")\";\n                    const punktodbioru = point.name;\n        \n                    let formData = new FormData();\n                        formData.append(\"rodzaj\", \"wysylka_inpost\");\n                        formData.append(\"koszyk\", \"0\");\n                        formData.append(\"value\", value);\n                        formData.append(\"punktodbioru\", punktodbioru);\n        \n                    var headers = new Headers();\n                        headers.append('pragma', 'no-cache');\n                        headers.append('cache-control', 'no-cache');\n        \n                    fetch(this.api, {\n                        method: 'POST', \n                        headers: headers, \n                        body: formData,\n                        credentials: \"same-origin\"\n                    });\n        \n                    this.Validate();\n                    this.hide();\n                });\n\n                this.widget.searchPlace(this.search);\n            }\n\n            \n            this.initialized = !this.initialized;\n        }\n    }\n\n    hide(event?: Event) {\n        event?.preventDefault();\n        this.overlay.hide();\n    }\n\n    @State() valid: boolean = true;\n\n    @Method()\n    async Validate() {\n        this.valid = this.address != \"\";\n    }\n\n    @Method()\n    async IsValid() {\n        return this.valid;\n    }\n\n    render() {\n        return [\n            this.address ? <p>{this.address} {this.pointMessage}</p> : null,\n            this.valid === false ? <p class=\"missing\">{this.missingMessage}</p> : null,\n\n            <ks-button round icon=\"map-pin\" onClick={(e)=>this.show(e)} name={this.button}/>,\n                    \n            <input type=\"hidden\" name=\"lokalizacjaRuch\" value={this.address}/>,\n            <input type=\"hidden\" name=\"ShippingDestinationCode\" value={this.code}/>,\n\n            <ks-overlay dark>\n                <div class=\"content\">\n                    <div class=\"topBar\">\n                        <ks-img2 src=\"res/cart/inpost-dark.svg\" vertical height={100} width={300}/>\n                        <ks-button transparent icon=\"x\" onClick={(e)=>this.hide(e)} />\n                    </div>\n                    \n                    {this.initialized ? [\n                        <link rel=\"stylesheet\" href=\"https://geowidget.easypack24.net/css/easypack.css\" />,\n                        <script async src=\"https://geowidget.easypack24.net/js/sdk-for-javascript.js\"></script>,\n                        \n                        <div id=\"easypack-map\"></div>\n                    ] : null}\n                </div>\n            </ks-overlay>\n        ];\n    }\n}"],"mappings":"sDAAA,MAAMA,EAAiB,yxB,MCOVC,EAAW,MAJxB,WAAAC,CAAAC,G,UAMYC,KAAGC,IAAW,GACdD,KAAME,OAAW,GACjBF,KAAMG,OAAW,kBAEjBH,KAAYI,aAAW,GACvBJ,KAAcK,eAAW,GAExBL,KAAWM,YAAW,GACtBN,KAAOO,QAAW,GAClBP,KAAIQ,KAAW,GAEfR,KAAWS,YAAG,MAsEdT,KAAKU,MAAY,IAuC7B,CAxGG,gBAAAC,GACIX,KAAKY,QAAUZ,KAAKa,KAAKC,cAAc,a,CAG3C,IAAAC,CAAKC,GACDA,EAAMC,iBACNjB,KAAKY,QAAQG,OAEb,IAAIf,KAAKS,YAAa,CACjBS,OAAeC,kBAAoB,KAChCC,SAASC,KAAK,CACVC,cAAe,KACfC,QAAS,MACTC,WAAY,MACZC,OAAQ,CACJC,MAAO,CAAC,iBACRC,UAAW,CAAC,mBAEhBC,IAAK,CACDC,aAAc,CAAC,oBAIvB7B,KAAK8B,OAASV,SAASW,UAAU,gBAAiBC,IAC9ChC,KAAKO,QAAUyB,EAAMC,KAAO,KAAOD,EAAMzB,QAAQ,SAAW,KAAOyB,EAAMzB,QAAQ,SACjFP,KAAKQ,KAAOwB,EAAMC,KAClBjC,KAAKM,YAAc0B,EAAMzB,QAAQ,SAAW,KAAOyB,EAAMzB,QAAQ,SAAW,SAAWyB,EAAMC,KAE7F,MAAMC,EAAQF,EAAMzB,QAAQ,SAAW,KAAOyB,EAAMzB,QAAQ,SAAW,MAAQyB,EAAMC,KAAO,IAC5F,MAAME,EAAeH,EAAMC,KAE3B,IAAIG,EAAW,IAAIC,SACfD,EAASE,OAAO,SAAU,kBAC1BF,EAASE,OAAO,SAAU,KAC1BF,EAASE,OAAO,QAASJ,GACzBE,EAASE,OAAO,eAAgBH,GAEpC,IAAII,EAAU,IAAIC,QACdD,EAAQD,OAAO,SAAU,YACzBC,EAAQD,OAAO,gBAAiB,YAEpCG,MAAMzC,KAAKC,IAAK,CACZyC,OAAQ,OACRH,QAASA,EACTI,KAAMP,EACNQ,YAAa,gBAGjB5C,KAAK6C,WACL7C,KAAK8C,MAAM,IAGf9C,KAAK8B,OAAOiB,YAAY/C,KAAKG,OAAO,EAIxCH,KAAKS,aAAeT,KAAKS,W,EAIjC,IAAAqC,CAAK9B,GACDA,GAAOC,iBACPjB,KAAKY,QAAQkC,M,CAMjB,cAAMD,GACF7C,KAAKU,MAAQV,KAAKO,SAAW,E,CAIjC,aAAMyC,GACF,OAAOhD,KAAKU,K,CAGhB,MAAAuC,GACI,MAAO,CACHjD,KAAKO,QAAU2C,EAAA,SAAIlD,KAAKO,QAAO,IAAGP,KAAKI,cAAoB,KAC3DJ,KAAKU,QAAU,MAAQwC,EAAG,KAAAC,MAAM,WAAWnD,KAAKK,gBAAsB,KAEtE6C,EAAW,aAAAE,IAAA,2CAAAC,MAAM,KAAAC,KAAK,UAAUC,QAAUC,GAAIxD,KAAKe,KAAKyC,GAAIvB,KAAMjC,KAAKE,SAEvEgD,EAAA,SAAAE,IAAA,2CAAOK,KAAK,SAASxB,KAAK,kBAAkBC,MAAOlC,KAAKO,UACxD2C,EAAA,SAAAE,IAAA,2CAAOK,KAAK,SAASxB,KAAK,0BAA0BC,MAAOlC,KAAKQ,OAEhE0C,EAAA,cAAAE,IAAA,2CAAYM,KAAI,MACZR,EAAK,OAAAE,IAAA,2CAAAD,MAAM,WACPD,EAAK,OAAAE,IAAA,2CAAAD,MAAM,UACPD,EAAA,WAAAE,IAAA,2CAASO,IAAI,2BAA2BC,SAAQ,KAACC,OAAQ,IAAKC,MAAO,MACrEZ,EAAW,aAAAE,IAAA,2CAAAW,YAAW,KAACT,KAAK,IAAIC,QAAUC,GAAIxD,KAAK8C,KAAKU,MAG3DxD,KAAKS,YAAc,CAChByC,EAAA,QAAMc,IAAI,aAAaC,KAAK,sDAC5Bf,EAAA,UAAQgB,MAAK,KAACP,IAAI,8DAElBT,EAAK,OAAAiB,GAAG,kBACR,O","ignoreList":[]}
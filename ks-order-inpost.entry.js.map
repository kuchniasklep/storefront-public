{"version":3,"names":["OrderInpost","this","initialized","componentDidLoad","root","style","display","Show","event","preventDefault","element","document","querySelector","UIkit","modal","show","window","easyPackAsyncInit","easyPack","init","defaultLocale","mapType","searchType","points","types","functions","map","initialTypes","widget","mapWidget","point","address","name","code","description","value","punktodbioru","formData","FormData","append","headers","Headers","fetch","api","method","body","credentials","Validate","Hide","searchPlace","search","hide","async","valid","render","h","rel","href","src","innerHTML","class","animation","onClick","e","button","type","id","height","width"],"sources":["src/components/order/confirmation/OrderInpost.tsx"],"sourcesContent":["import { Component, h, Prop, Element, State, Method } from '@stencil/core';\n\ndeclare var easyPack: any;\ndeclare const UIkit: any;\n\n@Component({\n  tag: 'ks-order-inpost',\n})\nexport class OrderInpost {\n\n    @Prop() search: string = \"WrocÅ‚aw, Polska\";\n    @Prop() api: string = \"\";\n    @Prop() button: string = \"\";\n\n    @Element() root: HTMLElement;\n\n    widget: any;\n\n    componentDidLoad() {\n        this.root.style.display = \"block\";\n    }\n\n    @State() description: string = \"\";\n    @State() address: string = \"\";\n    @State() code: string = \"\";\n\n    initialized = false;\n\n    Show(event: Event) {\n        event.preventDefault();\n        const element = document.querySelector(\"#ks-order-inpost\");\n        UIkit.modal(element).show();\n\n        if(!this.initialized) {\n            (window as any).easyPackAsyncInit = ()=>{\n                easyPack.init({\n                    defaultLocale: 'pl',\n                    mapType: 'osm',\n                    searchType: 'osm',\n                    points: {\n                        types: ['parcel_locker'],\n                        functions: ['parcel_collect']\n                    },\n                    map: {\n                        initialTypes: ['parcel_locker']\n                    }\n                });\n    \n                this.widget = easyPack.mapWidget(\"easypack-map\", (point) => {\n                    this.address = point.name + \", \" + point.address[\"line1\"] + \", \" + point.address[\"line2\"];\n                    this.code = point.name;\n                    this.description = point.address[\"line1\"] + \", \" + point.address[\"line2\"] + \"<br />\" + point.name;\n        \n                    const value = point.address[\"line1\"] + \", \" + point.address[\"line2\"] + \"  (\" + point.name + \")\";\n                    const punktodbioru = point.name;\n        \n                    let formData = new FormData();\n                        formData.append(\"rodzaj\", \"wysylka_inpost\");\n                        formData.append(\"koszyk\", \"0\");\n                        formData.append(\"value\", value);\n                        formData.append(\"punktodbioru\", punktodbioru);\n        \n                    var headers = new Headers();\n                        headers.append('pragma', 'no-cache');\n                        headers.append('cache-control', 'no-cache');\n        \n                    fetch(this.api, {\n                        method: 'POST', \n                        headers: headers, \n                        body: formData,\n                        credentials: \"same-origin\"\n                    });\n        \n                    this.Validate();\n                    this.Hide();\n                });\n\n                this.widget.searchPlace(this.search);\n            }\n\n            \n            this.initialized = !this.initialized;\n        }\n    }\n\n    Hide() {\n        const element = document.querySelector(\"#ks-order-inpost\");\n        UIkit.modal(element).hide();\n    }\n\n    @State() valid: boolean = true;\n\n    @Method()\n    async Validate() {\n        this.valid = this.address != \"\";\n    }\n\n    @Method()\n    async IsValid() {\n        return this.valid;\n    }\n\n    render() {\n        return[\n            <link rel=\"stylesheet\" href=\"https://geowidget.easypack24.net/css/easypack.css\" />,\n            <script async src=\"https://geowidget.easypack24.net/js/sdk-for-javascript.js\"></script>,\n            \n            <style innerHTML=\"\n                @keyframes ks-fade {\n                    from {opacity: 1.0;}\n                    to {opacity: 0.4;}\n                }\n\n                #easypack-map #listvillages {\n                    left: 0 !important;\n                    right: 0 !important;\n                    top: initial !important;\n                }\n\n                #easypack-map .input-group {\n                    padding: 0 !important;\n                    width: calc(100% - 60px) !important;\n                    height: 60px !important;\n                }\n\n                #easypack-map input {\n                    height: 60px;\n                }\n                #easypack-map button {\n                    height: 60px;\n                }\n            \"></style>,\n\n            <p innerHTML={this.description}></p>,\n\n            <button class={\"uk-button uk-width-1-1 uk-margin-top \" + (this.valid ? \"uk-button-secondary\" : \"uk-button-danger\")}\n                    style={{animation: this.valid ? \"\" : \"ks-fade 0.5s cubic-bezier(.86,.01,.67,1) infinite alternate\"}}\n                    onClick={(e)=>this.Show(e)}>{this.button}</button>,\n                    \n            <input type=\"hidden\" name=\"lokalizacjaRuch\" value={this.address}/>,\n            <input type=\"hidden\" name=\"ShippingDestinationCode\" value={this.code}/>,\n\n            <div id=\"ks-order-inpost\" class=\"uk-modal-full\" uk-modal>\n                <div class=\"uk-modal-dialog\">\n                    <div class=\"uk-background-cover uk-flex uk-flex-between uk-flex-column\" uk-height-viewport>\n                        <div id=\"easypack-map\" style={{height: \"100vh\", width: \"100vw\"}}></div>\n\n                        <button class=\"uk-button uk-button-secondary uk-position-top-right\"\n                                style={{width: \"60px\", height: \"60px\"}}\n                                onClick={()=>this.Hide()}>\n                            <span uk-icon=\"close\"></span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        ]\n    }\n}"],"mappings":"4DAQaA,EAAW,M,yBAkBpBC,KAAAC,YAAc,M,YAhBW,kB,SACH,G,YACG,G,iBAUM,G,aACJ,G,UACH,G,WAkEE,I,CAxE1BC,mBACIF,KAAKG,KAAKC,MAAMC,QAAU,O,CAS9BC,KAAKC,GACDA,EAAMC,iBACN,MAAMC,EAAUC,SAASC,cAAc,oBACvCC,MAAMC,MAAMJ,GAASK,OAErB,IAAId,KAAKC,YAAa,CACjBc,OAAeC,kBAAoB,KAChCC,SAASC,KAAK,CACVC,cAAe,KACfC,QAAS,MACTC,WAAY,MACZC,OAAQ,CACJC,MAAO,CAAC,iBACRC,UAAW,CAAC,mBAEhBC,IAAK,CACDC,aAAc,CAAC,oBAIvB1B,KAAK2B,OAASV,SAASW,UAAU,gBAAiBC,IAC9C7B,KAAK8B,QAAUD,EAAME,KAAO,KAAOF,EAAMC,QAAQ,SAAW,KAAOD,EAAMC,QAAQ,SACjF9B,KAAKgC,KAAOH,EAAME,KAClB/B,KAAKiC,YAAcJ,EAAMC,QAAQ,SAAW,KAAOD,EAAMC,QAAQ,SAAW,SAAWD,EAAME,KAE7F,MAAMG,EAAQL,EAAMC,QAAQ,SAAW,KAAOD,EAAMC,QAAQ,SAAW,MAAQD,EAAME,KAAO,IAC5F,MAAMI,EAAeN,EAAME,KAE3B,IAAIK,EAAW,IAAIC,SACfD,EAASE,OAAO,SAAU,kBAC1BF,EAASE,OAAO,SAAU,KAC1BF,EAASE,OAAO,QAASJ,GACzBE,EAASE,OAAO,eAAgBH,GAEpC,IAAII,EAAU,IAAIC,QACdD,EAAQD,OAAO,SAAU,YACzBC,EAAQD,OAAO,gBAAiB,YAEpCG,MAAMzC,KAAK0C,IAAK,CACZC,OAAQ,OACRJ,QAASA,EACTK,KAAMR,EACNS,YAAa,gBAGjB7C,KAAK8C,WACL9C,KAAK+C,MAAM,IAGf/C,KAAK2B,OAAOqB,YAAYhD,KAAKiD,OAAO,EAIxCjD,KAAKC,aAAeD,KAAKC,W,EAIjC8C,OACI,MAAMtC,EAAUC,SAASC,cAAc,oBACvCC,MAAMC,MAAMJ,GAASyC,M,CAMzBC,iBACInD,KAAKoD,MAAQpD,KAAK8B,SAAW,E,CAIjCqB,gBACI,OAAOnD,KAAKoD,K,CAGhBC,SACI,MAAM,CACFC,EAAA,QAAMC,IAAI,aAAaC,KAAK,sDAC5BF,EAAA,UAAQH,MAAK,KAACM,IAAI,8DAElBH,EAAA,SAAOI,UAAU,uvBA0BjBJ,EAAA,KAAGI,UAAW1D,KAAKiC,cAEnBqB,EAAA,UAAQK,MAAO,yCAA2C3D,KAAKoD,MAAQ,sBAAwB,oBACvFhD,MAAO,CAACwD,UAAW5D,KAAKoD,MAAQ,GAAK,+DACrCS,QAAUC,GAAI9D,KAAKM,KAAKwD,IAAK9D,KAAK+D,QAE1CT,EAAA,SAAOU,KAAK,SAASjC,KAAK,kBAAkBG,MAAOlC,KAAK8B,UACxDwB,EAAA,SAAOU,KAAK,SAASjC,KAAK,0BAA0BG,MAAOlC,KAAKgC,OAEhEsB,EAAA,OAAKW,GAAG,kBAAkBN,MAAM,gBAAe,iBAC3CL,EAAA,OAAKK,MAAM,mBACPL,EAAA,OAAKK,MAAM,6DAA4D,2BACnEL,EAAA,OAAKW,GAAG,eAAe7D,MAAO,CAAC8D,OAAQ,QAASC,MAAO,WAEvDb,EAAA,UAAQK,MAAM,sDACNvD,MAAO,CAAC+D,MAAO,OAAQD,OAAQ,QAC/BL,QAAS,IAAI7D,KAAK+C,QACtBO,EAAA,kBAAc,c"}
{"version":3,"names":["OrderInpost","constructor","hostRef","this","search","api","button","description","address","code","initialized","valid","componentDidLoad","root","style","display","Show","event","preventDefault","element","document","querySelector","UIkit","modal","show","window","easyPackAsyncInit","easyPack","init","defaultLocale","mapType","searchType","points","types","functions","map","initialTypes","widget","mapWidget","point","name","value","punktodbioru","formData","FormData","append","headers","Headers","fetch","method","body","credentials","Validate","Hide","searchPlace","hide","IsValid","render","h","key","rel","href","async","src","innerHTML","class","animation","onClick","e","type","id","height","width"],"sources":["src/components/order/confirmation/OrderInpost.tsx"],"sourcesContent":["import { Component, h, Prop, Element, State, Method } from '@stencil/core';\n\ndeclare var easyPack: any;\ndeclare const UIkit: any;\n\n@Component({\n  tag: 'ks-order-inpost',\n})\nexport class OrderInpost {\n\n    @Prop() search: string = \"WrocÅ‚aw, Polska\";\n    @Prop() api: string = \"\";\n    @Prop() button: string = \"\";\n\n    @Element() root: HTMLElement;\n\n    widget: any;\n\n    componentDidLoad() {\n        this.root.style.display = \"block\";\n    }\n\n    @State() description: string = \"\";\n    @State() address: string = \"\";\n    @State() code: string = \"\";\n\n    initialized = false;\n\n    Show(event: Event) {\n        event.preventDefault();\n        const element = document.querySelector(\"#ks-order-inpost\");\n        UIkit.modal(element).show();\n\n        if(!this.initialized) {\n            (window as any).easyPackAsyncInit = ()=>{\n                easyPack.init({\n                    defaultLocale: 'pl',\n                    mapType: 'osm',\n                    searchType: 'osm',\n                    points: {\n                        types: ['parcel_locker'],\n                        functions: ['parcel_collect']\n                    },\n                    map: {\n                        initialTypes: ['parcel_locker']\n                    }\n                });\n    \n                this.widget = easyPack.mapWidget(\"easypack-map\", (point) => {\n                    this.address = point.name + \", \" + point.address[\"line1\"] + \", \" + point.address[\"line2\"];\n                    this.code = point.name;\n                    this.description = point.address[\"line1\"] + \", \" + point.address[\"line2\"] + \"<br />\" + point.name;\n        \n                    const value = point.address[\"line1\"] + \", \" + point.address[\"line2\"] + \"  (\" + point.name + \")\";\n                    const punktodbioru = point.name;\n        \n                    let formData = new FormData();\n                        formData.append(\"rodzaj\", \"wysylka_inpost\");\n                        formData.append(\"koszyk\", \"0\");\n                        formData.append(\"value\", value);\n                        formData.append(\"punktodbioru\", punktodbioru);\n        \n                    var headers = new Headers();\n                        headers.append('pragma', 'no-cache');\n                        headers.append('cache-control', 'no-cache');\n        \n                    fetch(this.api, {\n                        method: 'POST', \n                        headers: headers, \n                        body: formData,\n                        credentials: \"same-origin\"\n                    });\n        \n                    this.Validate();\n                    this.Hide();\n                });\n\n                this.widget.searchPlace(this.search);\n            }\n\n            \n            this.initialized = !this.initialized;\n        }\n    }\n\n    Hide() {\n        const element = document.querySelector(\"#ks-order-inpost\");\n        UIkit.modal(element).hide();\n    }\n\n    @State() valid: boolean = true;\n\n    @Method()\n    async Validate() {\n        this.valid = this.address != \"\";\n    }\n\n    @Method()\n    async IsValid() {\n        return this.valid;\n    }\n\n    render() {\n        return[\n            <link rel=\"stylesheet\" href=\"https://geowidget.easypack24.net/css/easypack.css\" />,\n            <script async src=\"https://geowidget.easypack24.net/js/sdk-for-javascript.js\"></script>,\n            \n            <style innerHTML=\"\n                @keyframes ks-fade {\n                    from {opacity: 1.0;}\n                    to {opacity: 0.4;}\n                }\n\n                #easypack-map #listvillages {\n                    left: 0 !important;\n                    right: 0 !important;\n                    top: initial !important;\n                }\n\n                #easypack-map .input-group {\n                    padding: 0 !important;\n                    width: calc(100% - 60px) !important;\n                    height: 60px !important;\n                }\n\n                #easypack-map input {\n                    height: 60px;\n                }\n                #easypack-map button {\n                    height: 60px;\n                }\n            \"></style>,\n\n            <p innerHTML={this.description}></p>,\n\n            <button class={\"uk-button uk-width-1-1 uk-margin-top \" + (this.valid ? \"uk-button-secondary\" : \"uk-button-danger\")}\n                    style={{animation: this.valid ? \"\" : \"ks-fade 0.5s cubic-bezier(.86,.01,.67,1) infinite alternate\"}}\n                    onClick={(e)=>this.Show(e)}>{this.button}</button>,\n                    \n            <input type=\"hidden\" name=\"lokalizacjaRuch\" value={this.address}/>,\n            <input type=\"hidden\" name=\"ShippingDestinationCode\" value={this.code}/>,\n\n            <div id=\"ks-order-inpost\" class=\"uk-modal-full\" uk-modal>\n                <div class=\"uk-modal-dialog\">\n                    <div class=\"uk-background-cover uk-flex uk-flex-between uk-flex-column\" uk-height-viewport>\n                        <div id=\"easypack-map\" style={{height: \"100vh\", width: \"100vw\"}}></div>\n\n                        <button class=\"uk-button uk-button-secondary uk-position-top-right\"\n                                style={{width: \"60px\", height: \"60px\"}}\n                                onClick={()=>this.Hide()}>\n                            <span uk-icon=\"close\"></span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        ]\n    }\n}"],"mappings":"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","ignoreList":[]}
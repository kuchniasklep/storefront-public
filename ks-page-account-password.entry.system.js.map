{"version":3,"file":"ks-page-account-password.entry.system.js","sources":["src/components/pages/account/password.css?tag=ks-page-account-password","src/components/pages/account/password.tsx"],"sourcesContent":["ks-page-account-password {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex: 1 1 auto;\n    \n}\n\nks-page-account-password .container {\n    max-width: 100%;\n    width: 500px;\n    padding: 30px;\n    background-color: #fff;\n    border-radius: 10px;\n}\n\nks-page-account-password .buttons {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    margin-top: 30px;\n}\n\nks-page-account-password .container > h1 {\n    text-align: center;\n    margin: 10px 0px 5px 0px;\n}\n\n\nks-page-account-password .success {\n    text-align: center;\n}\n\nks-page-account-password .success .loader {\n    position: relative;\n    width: 100px;\n    height: 100px;\n    margin: auto;\n}\n\nks-page-account-password ks-dialog .content {\n    width: 100%;\n}\n\nks-page-account-password #notification-dialog section ks-button {\n    margin-top: 20px;\n}\n\nks-page-account-password .login > * {\n    font-size: 18px;\n    font-weight: 700;\n    font-family: var(--font-emphasis);\n}\n\n@media (max-width: 1060px) {\n    ks-page-account-password {\n        background-color: #fff;\n    }\n\n    ks-page-account-password .container {\n        padding: 40px 20px;\n    }\n}","import { Component, h, Host, Prop, Element, State } from '@stencil/core';\nimport ValidateInput from '../../input/validate';\n\n@Component({\n    tag: 'ks-page-account-password',\n    styleUrl: 'password.css'\n})\nexport class PageAccountPassword {\n    @Element() root: HTMLElement;\n    \n    @Prop() heading: string = \"Zmiana Hasła\";\n    @Prop() customerId: string;\n\n    @Prop() oldPasswordApi: string = \"res/true?haslo_stare=\";\n    @Prop() oldPasswordMessage: string = \"Wpisane hasło nie jest poprawne\";\n    @Prop() changeApi: string;\n    \n    @Prop() accountLink: string;\n\n    @Prop() success_heading: string = \"Zmieniono hasło\";\n    @Prop() success_message: string = \"Hasło zostało prawidłowo zmienione, za chwilę nastąpi przekierowanie na panel klienta.\";\n\n    @Prop() failure_heading: string = \"Hasło nie zostało zmienione\";\n    @Prop() failure_message: string = \"Spróbuj wprowadzić dane ponownie, jeżeli problem pojawi się ponownie skontaktuj się z obsługą sklepu.\";\n    \n    @State() loading: boolean = false;\n    @State() notification_heading: string;\n    @State() notification_message: string;\n\n\trender() {\n\t\treturn <Host>\n            <section class=\"container\">\n                <h1>{this.heading}</h1>\n\n                <form id=\"change\" enctype=\"application/x-www-form-urlencoded\" onSubmit={(event)=>this.submit_change(event)}>\n                    <ks-input-dynamic api={this.oldPasswordApi} message={this.oldPasswordMessage}>\n                        <ks-input-text password required name='haslo_stare' label=\"Stare hasło\" icon=\"key\" />\n                    </ks-input-dynamic>\n                    <ks-input-text password required name='nowe_haslo' label=\"Nowe hasło\" icon=\"key\" max={128} passwordCharacters />\n                    <ks-input-text password required name='haslo_powtorz' label=\"Powtórz nowe hasło\" icon=\"key\" sameAs=\"nowe_haslo\" />\n\n                    <input type=\"hidden\" name=\"id\" value={this.customerId} />\n                    <input type=\"hidden\" name=\"akcja\" value=\"zapisz\" />\n\n                    <div class=\"buttons\">\n                        <ks-button rounded submit name=\"Zmień hasło\" loading={this.loading} />\n                        <ks-button rounded border link={this.accountLink} name=\"Wróć do panelu klienta\" loading={this.loading} />\n                    </div>\n                </form>\n\n                <ks-dialog id=\"notification-dialog\" dark>\n                    <section>\n                        <h1>{this.notification_heading}</h1>\n                        <p>{this.notification_message}</p>\n\n                        <ks-button rounded onClick={()=>this.hide_notification()} name=\"Wróć do logowania\" />\n                    </section>\n                </ks-dialog>\n\n                <ks-overlay dark id=\"loading-overlay\" close={false}>\n                    <div class=\"success\">\n                        <h1>{this.success_heading}</h1>\n                        <p>{this.success_message}</p>\n                        <div class=\"loader\">\n                            <ks-loader large />\n                        </div>\n                    </div>\n                </ks-overlay>\n            </section>\n        </Host>;\n\t}\n\n    redirect_to_account() {\n        const dialog = this.root.querySelector(\"#loading-overlay\") as any;\n        dialog.show();\n\n        setTimeout(() => {\n            window.location.href = this.accountLink;\n        }, 1000);\n    }\n\n    show_notification(heading: string, message: string) {\n        this.notification_heading = heading;\n        this.notification_message = message;\n\n        const dialog = this.root.querySelector(\"#notification-dialog\") as any;\n        dialog.show();\n    }\n\n    hide_notification() {\n        const dialog = this.root.querySelector(\"#notification-dialog\") as any;\n        dialog.hide();\n    }\n\n    async submit_change(event: Event) {\n        event.preventDefault();\n        this.loading = true;\n\n        const form = this.root.querySelector(\"#change\") as HTMLFormElement;\n\n        if(!await ValidateInput(form)) {\n            this.loading = false;\n            return;\n        }\n\n        const filteredParams = new URLSearchParams();\n\n        new FormData(form).forEach((value, key) => {\n            filteredParams.append(key, value.toString());\n        })\n\n        const formData = new FormData();\n        formData.append(\"data\", filteredParams.toString());\n\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        await fetch(this.changeApi, {\n            body: formData,\n            method: 'POST',\n            headers: headers,\n            credentials: \"same-origin\"\n        })\n        .then(response => {\n            if(!response.ok) throw response.status;\n            return response.text();\n        })\n        .then(response => {\n            if(response.includes(\"Twoje hasło zostało zmienione\"))\n                this.redirect_to_account();\n            else this.show_notification(this.failure_heading, this.failure_message);\n        })\n        .catch(error => {\n            console.log(error);\n            let message = error;\n\n            if(!navigator.onLine)\n                message = \"Brak połączenia z internetem.\";\n\n            else if(Number.isInteger(error))\n                message = `Błąd połączenia - ${error}`;\n\n            this.show_notification(this.failure_heading, message);\n        });\n\n        this.loading = false;\n    }\n}\n"],"names":[],"mappings":"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"}
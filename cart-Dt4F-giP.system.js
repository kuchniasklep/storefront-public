var __awaiter=this&&this.__awaiter||function(t,n,r,i){function e(t){return t instanceof r?t:new r((function(n){n(t)}))}return new(r||(r=Promise))((function(r,u){function o(t){try{c(i.next(t))}catch(t){u(t)}}function a(t){try{c(i["throw"](t))}catch(t){u(t)}}function c(t){t.done?r(t.value):e(t.value).then(o,a)}c((i=i.apply(t,n||[])).next())}))};var __generator=this&&this.__generator||function(t,n){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},i,e,u,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(n){return c([t,n])}}function c(a){if(i)throw new TypeError("Generator is already executing.");while(o&&(o=0,a[0]&&(r=0)),r)try{if(i=1,e&&(u=a[0]&2?e["return"]:a[0]?e["throw"]||((u=e["return"])&&u.call(e),0):e.next)&&!(u=u.call(e,a[1])).done)return u;if(e=0,u)a=[a[0]&2,u.value];switch(a[0]){case 0:case 1:u=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;e=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(u=r.trys,u=u.length>0&&u[u.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!u||a[1]>u[0]&&a[1]<u[3])){r.label=a[1];break}if(a[0]===6&&r.label<u[1]){r.label=u[1];u=a;break}if(u&&r.label<u[2]){r.label=u[2];r.ops.push(a);break}if(u[2])r.ops.pop();r.trys.pop();continue}a=n.call(t,r)}catch(t){a=[6,t];e=0}finally{i=u=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};System.register(["./cart-uSma8YvW.system.js","./fetch-H5Atuhfj.system.js","./dataLayer-CPBiml8-.system.js"],(function(t){"use strict";var n,r,i,e;return{setters:[function(t){n=t.c},function(t){r=t.j;i=t.f},function(t){e=t.D}],execute:function(){t({a:c,b:g,c:l,d:h,e:p,f:v,g:s,h:d,p:a,r:u,s:f,u:B});function u(t){return __awaiter(this,void 0,void 0,(function(){var r,i,u;var o=this;var a;return __generator(this,(function(c){switch(c.label){case 0:r=(a=n.get("products"))===null||a===void 0?void 0:a[t];if(r)e.removeFromCart(r);return[4,b(n.get("api").productRemove,{id:t})];case 1:i=c.sent();if(i){if(i.products.length==0)document.location.reload();else y("Błąd usuwania produktu",i,(function(t){return __awaiter(o,void 0,void 0,(function(){return __generator(this,(function(n){B(t);return[2]}))}))}))}u=document.querySelector('ks-cart-product[ikey="'.concat(t,'"]'));if(u)u.ResetLoading();return[2]}}))}))}var o=new AbortController;function a(t,r){return __awaiter(this,void 0,void 0,(function(){var i,e;var u=this;return __generator(this,(function(a){switch(a.label){case 0:i=null;o.abort();o=new AbortController;return[4,b(n.get("api").productCount,{id:t,ilosc:r.toString()},o.signal)];case 1:e=a.sent();if(e){y("Błąd ilości produktu",e,(function(t){return __awaiter(u,void 0,void 0,(function(){var n,r;return __generator(this,(function(e){if("error"in t){A().show("Błąd ilości produktu",t.error.message);i=(r=(n=t===null||t===void 0?void 0:t.error)===null||n===void 0?void 0:n.maxCount)!==null&&r!==void 0?r:null}else B(t);if("discount"in t==false)_();return[2]}))}))}))}return[2,i]}}))}))}function c(t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:n.set("loadingDeals",true);return[4,b(n.get("api").addDeal,{id:t})];case 1:r=i.sent();n.set("loadingDeals",false);if(!(!r||"error"in r))return[3,2];A().show("Błąd dodawania gratisu",r.error.message);return[2];case 2:return[4,B(r)];case 3:i.sent();i.label=4;case 4:return[2]}}))}))}function s(t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:m("ks-cart-select-shipping");m("ks-cart-select-payment");r=B;return[4,b(n.get("api").countryChange,{data:t})];case 1:r.apply(void 0,[i.sent()]);k("ks-cart-select-shipping");k("ks-cart-select-payment");return[2]}}))}))}function f(t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:m("ks-cart-select-payment");r=B;return[4,b(n.get("api").shippingChange,{data:t.toString()})];case 1:r.apply(void 0,[i.sent()]);k("ks-cart-select-payment");return[2]}}))}))}function d(t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:r=B;return[4,b(n.get("api").paymentChange,{data:t.toString()})];case 1:r.apply(void 0,[i.sent()]);return[2]}}))}))}function v(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(r){switch(r.label){case 0:t=B;return[4,b(n.get("api").discountRemove)];case 1:t.apply(void 0,[r.sent()]);_();return[2]}}))}))}function _(){n.set("discount",{})}function h(t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:return[4,b(n.get("api").discountCode,{data:t})];case 1:r=i.sent();y("Błąd dodawania kodu",r,(function(t){B(t)}));k("ks-cart-discount-code");return[2]}}))}))}function l(t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(i){switch(i.label){case 0:return[4,b(n.get("api").discountPoints,{data:t.toString()})];case 1:r=i.sent();w("ks-cart-discount-container ks-cart-heading");B(r);k("ks-cart-discount-points");return[2]}}))}))}function w(t){var n=document.querySelectorAll(t);var r=0;if(n.length==2)r=n[1].getBoundingClientRect().top-n[0].getBoundingClientRect().top;if(r)window.scrollBy(0,-r)}function p(t){return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(e){switch(e.label){case 0:i=n.get("api").easyprotectChange;j();return[4,r(i,t).then((function(t){return t.json()})).then((function(t){return B(t)}))];case 1:e.sent();S();return[2]}}))}))}function g(t){return __awaiter(this,void 0,void 0,(function(){var r;return __generator(this,(function(e){switch(e.label){case 0:r=n.get("api").easyprotectRemove;j();return[4,i(r,{id:t}).then((function(t){return t.json()})).then((function(t){return B(t)}))];case 1:e.sent();S();return[2]}}))}))}function m(t){var n=document.querySelector(t);if(n&&"StartLoading"in n)n.StartLoading()}function k(t){var n=document.querySelector(t);if(n&&"ResetLoading"in n)n.ResetLoading()}function y(t,n,r){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){if("message"in n){A().show(t,n.message);delete n.message;setTimeout((function(){r(n)}),200)}else r(n);return[2]}))}))}function b(t,n,r){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){j();return[2,i(t,n,r).then((function(t){return t.json()})).then((function(t){S();return t})).catch((function(t){S();if(t.name!="AbortError"){x().show(t)}return{}}))]}))}))}function B(t){Object.keys(t).map((function(r){n.set(r,t[r])}));if("discount"in t==false)_()}function j(){n.set("loading",n.get("loading")+1)}function S(){if(n.get("loading")>0)n.set("loading",n.get("loading")-1)}function A(){return document.querySelector("ks-message-popup")}function x(){return document.querySelector("ks-error-popup")}}}}));
//# sourceMappingURL=cart-Dt4F-giP.system.js.map
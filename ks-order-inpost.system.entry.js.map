{"version":3,"names":["orderInpostCss","OrderInpost","exports","class_1","hostRef","this","token","api","button","search","phone","test","pointMessage","missingMessage","invalidPhoneMessage","editAddressLink","address","code","initialized","validPhone","validCode","valid","prototype","componentDidLoad","overlay","root","querySelector","componentWillLoad","Validate","show","event","preventDefault","hide","initial","IsValid","select","point","formData","FormData","append","headers","Headers","fetch","method","body","credentials","render","_this","endpoint","h","key","class","concat","round","icon","secondary","onClick","e","name","link","type","value","dark","src","vertical","height","width","transparent","rel","href","defer","innerHTML"],"sources":["src/components/order/confirmation/orderInpost.css?tag=ks-order-inpost","src/components/order/confirmation/OrderInpost.tsx"],"sourcesContent":["ks-order-inpost .content {\n    background-color: #e8e8e8;\n    position: relative;\n    box-sizing: border-box;\n    margin: 20px;\n    max-width: 1400px;\n    width: 100%;\n    max-height: 100%;\n    overflow-y: auto;\n}\n\n@media screen and (max-width: 640px) {\n    ks-order-inpost .content {\n        margin: 0px;\n    }\n}\n\nks-order-inpost > ks-button {\n    max-width: 300px;\n    height: 46px;\n    margin: 10px auto 0 auto;\n}\n\nks-order-inpost .topBar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background-color: #ffcd00;\n    height: 46px;\n}\n\nks-order-inpost .missing {\n    color: var(--color-secondary);\n    margin-bottom: 10px;\n}\n\nks-order-inpost .topBar ks-img2 {\n    height: 40px;\n}\n\nks-order-inpost .map {\n    height: calc(100dvh - 46px);\n    max-height: 900px;\n    overflow-x: hidden;\n}\n\n@media screen and (max-width: 640px) {\n    ks-order-inpost .map {\n        max-height: 100%;\n    }\n}\n","import { Component, h, Prop, Element, State, Method } from '@stencil/core';\n\n@Component({\n  tag: 'ks-order-inpost',\n  styleUrl: 'orderInpost.css'\n})\nexport class OrderInpost {\n    @Element() root: HTMLElement;\n    @Prop() token: string = \"\";\n    @Prop() api: string = \"\";\n    @Prop() button: string = \"\";\n    @Prop() search: string = \"Wrocław, Polska\";\n    @Prop() phone: string = \"\";\n    \n    @Prop() test: boolean = false;\n\n    @Prop() pointMessage: string = \"\";\n    @Prop() missingMessage: string = \"\";\n    @Prop() invalidPhoneMessage: string = \"\";\n    @Prop() editAddressLink: string = \"\";\n\n    @State() address: string = \"\";\n    @State() code: string = \"\";\n    @State() initialized = false;\n    @State() validPhone = true;\n    @State() validCode = true;\n    @State() valid: boolean = true;\n\n    widget: any;\n    overlay: HTMLKsOverlayElement;\n\n    componentDidLoad() {\n        this.overlay = this.root.querySelector(\"ks-overlay\");\n    }\n\n    componentWillLoad() {\n        this.Validate(true);\n    }\n\n    show(event: Event) {\n        event.preventDefault();\n        this.overlay.show();\n        this.initialized = true;\n    }\n\n    hide(event?: Event) {\n        event?.preventDefault();\n        this.overlay.hide();\n        this.Validate();\n    }\n\n\n    @Method()\n    async Validate(initial = false) {\n        if(/^[+]*(?:48)*\\s*(?:45|50|51|53|57|60|66|69|72|73|78|79|88)(?:(?:[0-9]{7})|(?:[0-9]\\s[0-9]{3}\\s[0-9]{3}))$/.test(this.phone) === false) {\n            this.valid = false;\n            this.validPhone = false;\n            return;\n        }\n\n        if(this.code === \"\") {\n            this.valid = false;\n            if(!initial) this.validCode = false; // give a chance before yelling at the user\n            return;\n        }\n\n        this.valid = true;\n        this.validPhone = true;\n        this.validCode = true;\n    }\n\n    @Method()\n    async IsValid() {\n        return this.valid;\n    }\n\n    @Method()\n        async select(point: string, address: string) {\n            this.code = point;\n            this.address = address;\n            this.Validate();\n            this.hide(null);\n    \n            let formData = new FormData();\n                formData.append(\"rodzaj\", \"wysylka_inpost\");\n                formData.append(\"koszyk\", \"0\");\n                formData.append(\"value\", address);\n                formData.append(\"punktodbioru\", point);\n            \n            var headers = new Headers();\n                headers.append('pragma', 'no-cache');\n                headers.append('cache-control', 'no-cache');\n            \n            fetch(this.api, {\n                method: 'POST', \n                headers: headers, \n                body: formData,\n                credentials: \"same-origin\"\n            });\n        }\n\n    render() {\n        const endpoint = this.test ?\n            \"https://sandbox-easy-geowidget-sdk.easypack24.net\" :\n            \"https://geowidget.inpost.pl\"\n\n        return [\n            this.code ? <p>{this.pointMessage}: {this.code}</p> : null,\n            !this.validCode && <p class=\"missing\">{this.missingMessage}</p>,\n            !this.validPhone && <p class=\"missing\">{this.invalidPhoneMessage} {this.phone && `Podany nr: ${this.phone}`}</p>,\n\n            this.validPhone ? \n                <ks-button round icon=\"map-pin\" secondary={!this.validCode} onClick={(e)=>this.show(e)} name={this.button}/> :\n                <ks-button round icon=\"edit\" secondary={true} link={this.editAddressLink} name={\"Edytuj dane wysyłki\"}/>,\n                    \n            <input type=\"hidden\" name=\"lokalizacjaRuch\" value={this.code}/>,\n            <input type=\"hidden\" name=\"ShippingDestinationCode\" value={this.code}/>,\n\n            <ks-overlay dark>\n                <div class=\"content\">\n                    <div class=\"topBar\">\n                        <ks-img2 src=\"res/cart/inpost-dark.svg\" vertical height={100} width={300}/>\n                        <ks-button transparent icon=\"x\" onClick={(e)=>this.hide(e)} />\n                    </div>\n                    {this.initialized && [\n                        <link rel=\"stylesheet\" href={`${endpoint}/inpost-geowidget.css`}/>,\n                        <script src={`${endpoint}/inpost-geowidget.js`} defer></script>,\n\n                        <script type=\"text/javascript\" innerHTML=\"\n                            document.addEventListener('onpointselect', (event) => {\n                                console.log(event)\n                                document.querySelector('ks-order-inpost').select(event.detail.name, event.detail.address.line1 + ' ' + event.detail.address.line2)\n                            });\n                        \"></script>,\n                        \n                        <div class=\"map\" innerHTML={`<inpost-geowidget onpoint=\"onpointselect\" token='${this.token}' language='pl' config='parcelcollect'></inpost-geowidget>`} />\n                    ]}\n                </div>\n            </ks-overlay>\n        ];\n    }\n}"],"mappings":"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","ignoreList":[]}
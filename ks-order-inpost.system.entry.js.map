{"version":3,"names":["OrderInpost","exports","this","initialized","class_1","prototype","componentDidLoad","root","style","display","Show","event","_this","preventDefault","element","document","querySelector","UIkit","modal","show","window","easyPackAsyncInit","easyPack","init","defaultLocale","mapType","searchType","points","types","functions","map","initialTypes","widget","mapWidget","point","address","name","code","description","value","punktodbioru","formData","FormData","append","headers","Headers","fetch","api","method","body","credentials","Validate","Hide","searchPlace","search","hide","valid","IsValid","render","h","rel","href","async","src","innerHTML","class","animation","onClick","e","button","type","id","height","width"],"sources":["src/components/order/confirmation/OrderInpost.tsx"],"sourcesContent":["import { Component, h, Prop, Element, State, Method } from '@stencil/core';\n\ndeclare var easyPack: any;\ndeclare const UIkit: any;\n\n@Component({\n  tag: 'ks-order-inpost',\n})\nexport class OrderInpost {\n\n    @Prop() search: string = \"WrocÅ‚aw, Polska\";\n    @Prop() api: string = \"\";\n    @Prop() button: string = \"\";\n\n    @Element() root: HTMLElement;\n\n    widget: any;\n\n    componentDidLoad() {\n        this.root.style.display = \"block\";\n    }\n\n    @State() description: string = \"\";\n    @State() address: string = \"\";\n    @State() code: string = \"\";\n\n    initialized = false;\n\n    Show(event: Event) {\n        event.preventDefault();\n        const element = document.querySelector(\"#ks-order-inpost\");\n        UIkit.modal(element).show();\n\n        if(!this.initialized) {\n            (window as any).easyPackAsyncInit = ()=>{\n                easyPack.init({\n                    defaultLocale: 'pl',\n                    mapType: 'osm',\n                    searchType: 'osm',\n                    points: {\n                        types: ['parcel_locker'],\n                        functions: ['parcel_collect']\n                    },\n                    map: {\n                        initialTypes: ['parcel_locker']\n                    }\n                });\n    \n                this.widget = easyPack.mapWidget(\"easypack-map\", (point) => {\n                    this.address = point.name + \", \" + point.address[\"line1\"] + \", \" + point.address[\"line2\"];\n                    this.code = point.name;\n                    this.description = point.address[\"line1\"] + \", \" + point.address[\"line2\"] + \"<br />\" + point.name;\n        \n                    const value = point.address[\"line1\"] + \", \" + point.address[\"line2\"] + \"  (\" + point.name + \")\";\n                    const punktodbioru = point.name;\n        \n                    let formData = new FormData();\n                        formData.append(\"rodzaj\", \"wysylka_inpost\");\n                        formData.append(\"koszyk\", \"0\");\n                        formData.append(\"value\", value);\n                        formData.append(\"punktodbioru\", punktodbioru);\n        \n                    var headers = new Headers();\n                        headers.append('pragma', 'no-cache');\n                        headers.append('cache-control', 'no-cache');\n        \n                    fetch(this.api, {\n                        method: 'POST', \n                        headers: headers, \n                        body: formData,\n                        credentials: \"same-origin\"\n                    });\n        \n                    this.Validate();\n                    this.Hide();\n                });\n\n                this.widget.searchPlace(this.search);\n            }\n\n            \n            this.initialized = !this.initialized;\n        }\n    }\n\n    Hide() {\n        const element = document.querySelector(\"#ks-order-inpost\");\n        UIkit.modal(element).hide();\n    }\n\n    @State() valid: boolean = true;\n\n    @Method()\n    async Validate() {\n        this.valid = this.address != \"\";\n    }\n\n    @Method()\n    async IsValid() {\n        return this.valid;\n    }\n\n    render() {\n        return[\n            <link rel=\"stylesheet\" href=\"https://geowidget.easypack24.net/css/easypack.css\" />,\n            <script async src=\"https://geowidget.easypack24.net/js/sdk-for-javascript.js\"></script>,\n            \n            <style innerHTML=\"\n                @keyframes ks-fade {\n                    from {opacity: 1.0;}\n                    to {opacity: 0.4;}\n                }\n\n                #easypack-map #listvillages {\n                    left: 0 !important;\n                    right: 0 !important;\n                    top: initial !important;\n                }\n\n                #easypack-map .input-group {\n                    padding: 0 !important;\n                    width: calc(100% - 60px) !important;\n                    height: 60px !important;\n                }\n\n                #easypack-map input {\n                    height: 60px;\n                }\n                #easypack-map button {\n                    height: 60px;\n                }\n            \"></style>,\n\n            <p innerHTML={this.description}></p>,\n\n            <button class={\"uk-button uk-width-1-1 uk-margin-top \" + (this.valid ? \"uk-button-secondary\" : \"uk-button-danger\")}\n                    style={{animation: this.valid ? \"\" : \"ks-fade 0.5s cubic-bezier(.86,.01,.67,1) infinite alternate\"}}\n                    onClick={(e)=>this.Show(e)}>{this.button}</button>,\n                    \n            <input type=\"hidden\" name=\"lokalizacjaRuch\" value={this.address}/>,\n            <input type=\"hidden\" name=\"ShippingDestinationCode\" value={this.code}/>,\n\n            <div id=\"ks-order-inpost\" class=\"uk-modal-full\" uk-modal>\n                <div class=\"uk-modal-dialog\">\n                    <div class=\"uk-background-cover uk-flex uk-flex-between uk-flex-column\" uk-height-viewport>\n                        <div id=\"easypack-map\" style={{height: \"100vh\", width: \"100vw\"}}></div>\n\n                        <button class=\"uk-button uk-button-secondary uk-position-top-right\"\n                                style={{width: \"60px\", height: \"60px\"}}\n                                onClick={()=>this.Hide()}>\n                            <span uk-icon=\"close\"></span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        ]\n    }\n}"],"mappings":"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"}
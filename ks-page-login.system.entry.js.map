{"version":3,"names":["login","createStore","loginCss","PageLogin","exports","class_1","prototype","componentWillLoad","loginDataElement","document","getElementById","this","loginData","JSON","parse","innerHTML","Object","keys","map","key","set","loadCommonData","commonData","commonDynamicData","Build","componentDidLoad","get","externalLogin","showForgot","dialog","root","querySelector","show","render","_this","strings","google","facebook","h","loadCommon","skipbase","class","action","method","header","required","email","name","label","icon","placeholder","emailPlaceholder","password","passwordPlaceholder","onClick","forgotPassword","submit","primary","round","nofollow","link","border","narrow","register","dark","forgotMessage","forgotSubmit","close","loginapi","registerapi","errorpopup","overlay","translations","formfetch","data","then","text","includes","window","location","replace","length","hide","Error","externalLoginError"],"sources":["src/global/data/login.ts","src/components/pages/login/login.css?tag=ks-page-login","src/components/pages/login/login.tsx"],"sourcesContent":["import { createStore } from \"@stencil/store\";\n\nexport const login = createStore({} as LoginData);\n\nexport interface LoginData {\n    strings: LoginStringsData;\n    register: string;\n    login: string;\n    forgot: string;\n\n    externalLogin: string;\n    externalRegister: string;\n    \n    google: LoginExternalData | false;\n    facebook: LoginExternalData | false;\n}\n\nexport interface LoginStringsData {\n    header: string;\n    email: string;\n    emailPlaceholder: string;\n    password: string;\n    passwordPlaceholder: string;\n    forgotPassword: string;\n    forgotMessage: string;\n    forgotSubmit: string;\n    register: string;\n    login: string;\n    externalLogin: string;\n    externalLoginError: string;\n}\n\nexport interface LoginExternalData {\n    name: string,\n    link: string,\n}\n\n","ks-page-login .background {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    background-color: white;\n    padding: 80px 20px;\n}\n\nks-page-login .card {\n    width: 100%;\n    max-width: 400px;\n\n    background-color: white;\n}\n\nks-page-login h1 {\n    text-align: center;\n    margin-bottom: 10px;\n}\n\nks-page-login .forgot {\n    float: right;\n    cursor: pointer;\n    margin-top: -10px;\n\n    transition: opacity 0.3s ease;\n}\n\nks-page-login .forgot:hover {\n    opacity: 0.7;\n}\n\nks-page-login .forgot:active {\n    opacity: 0.5;\n}\n\nks-page-login .login {\n    margin-top: 50px;\n}\n\nks-page-login .login > * {\n    background: rgb(24,141,219);\n    background: linear-gradient(321deg, rgba(24,141,219,1) 0%, rgba(0,26,78,1) 100%);\n\n    transition: opacity 0.3s ease;\n}\n\nks-page-login .login > *:hover {\n    opacity: 0.9;\n}\n\nks-page-login .login > *:active {\n    opacity: 0.8;\n}\n\nks-page-login .register {\n    margin: 10px auto 0 auto;\n    width: 90%;\n}\n\nks-page-login .forgot-dialog p {\n    text-align: center;\n}\n\nks-page-login .forgotSubmit {\n    margin: 20px 0 20px 0;\n}\n\nks-page-login .externalButtons {\n    display: flex;\n    margin-top: 10px;\n    margin-bottom: 20px;\n    gap: 5px;\n    align-items: center;\n    justify-content: center;\n}\n\nks-page-login .external {\n    width: 100%;\n}\n\nks-page-login .external > * {\n    background: linear-gradient(321deg, rgb(77 77 77) 0%, rgba(26,26,26,1) 100%);\n    transition: opacity 0.3s ease;\n}\n\nks-page-login .external:last-child > * {\n    background: linear-gradient(30deg, rgb(77 77 77) 0%, rgba(26,26,26,1) 100%);\n}\n\nks-page-login .external > *:hover {\n    opacity: 0.9;\n}\n\nks-page-login .external > *:active {\n    opacity: 0.8;\n}","import { Component, h, Prop, Build, Element } from '@stencil/core';\nimport { login, LoginData } from \"../../../global/data/login\";\nimport { loadCommonData } from '../../../global/functions/loadCommon';\nimport { formfetch } from \"../../../global/functions/fetch\";\n\n@Component({\n    tag: 'ks-page-login',\n    styleUrl: 'login.css'\n})\nexport class PageLogin {\n    @Element() root: HTMLElement;\n\n    @Prop() skipbase: boolean;\n    @Prop() commonData: string;\n    @Prop() commonDynamicData: string;\n\n    @Prop() loginData: string;\n\n    componentWillLoad() {\n        const loginDataElement = document.getElementById(this.loginData);\n\t\tconst loginData = JSON.parse(loginDataElement.innerHTML) as LoginData;\n\n        Object.keys(loginData).map(key => {\n\t\t\tlogin.set(key as keyof LoginData, loginData[key]);\n\t\t});\n\n        loadCommonData(this.commonData, this.commonDynamicData, Build);\n    }\n\n    componentDidLoad() {\n        if(login.get(\"externalLogin\") && login.get(\"externalRegister\"))\n            this.externalLogin(login.get(\"externalLogin\"), login.get(\"externalRegister\"));\n    }\n\n    showForgot() {\n        const dialog = this.root.querySelector(\"ks-dialog.forgot-dialog\") as HTMLKsDialogElement;\n        dialog.show();\n    }\n\n\trender() {\n        const strings = login.get(\"strings\");\n        const google = login.get(\"google\");\n        const facebook = login.get(\"facebook\");\n\n\t\treturn <ks-page-base loadCommon={false} skipbase={this.skipbase} commonData={this.commonData} commonDynamicData={this.commonDynamicData}>\n            <div class=\"background\">\n                <ks-simpleform class=\"card\" action={login.get(\"login\")} method=\"post\">\n                    <h1>{strings.header}</h1>\n\n                    <ks-input-text required email name=\"email\"\n                        label={strings.email} icon={\"at-sign\"} right-icon\n                        placeholder={strings.emailPlaceholder}\n                    />\n\n                    <ks-input-text required password name=\"haslo\" \n                        label={strings.password} icon={\"key\"} right-icon\n                        placeholder={strings.passwordPlaceholder}\n                    />\n\n                    <span class=\"forgot\" onClick={()=>this.showForgot()}>{strings.forgotPassword}</span>\n\n                    <ks-button submit class=\"login\" primary name={strings.login} round />\n\n                    {google || facebook ?\n                        <div class=\"externalButtons\">\n                            { google ? \n                                <ks-button nofollow round icon=\"google\" class=\"external\"\n                                    link={google.link} \n                                    name={strings.externalLogin}  \n                                />\n                            : null }\n\n                            { facebook ? \n                                <ks-button nofollow round icon=\"facebook\" class=\"external\"\n                                    link={facebook.link}\n                                    name={strings.externalLogin} \n                                />\n                            : null }\n                        </div>\n                    : null}\n\n                    <ks-button nofollow link={login.get(\"register\")} class=\"register\" border narrow name={strings.register} round />\n                </ks-simpleform>\n\n                <ks-dialog class=\"forgot-dialog\" dark>\n                    <ks-simpleform action={login.get(\"forgot\")} method=\"post\">\n                        <p>{strings.forgotMessage}</p>\n                        <ks-input-text email name=\"emailprzypomnienie\"\n                            label={strings.email} icon={\"at-sign\"} right-icon\n                            placeholder={strings.emailPlaceholder}\n                        />\n                        <ks-button class=\"forgotSubmit\" border narrow name={strings.forgotSubmit} round />\n                    </ks-simpleform>\n                </ks-dialog>\n\n                <ks-overlay dark close={false} class=\"loading\">\n                    <ks-loader />\n                </ks-overlay>\n            </div>\n        </ks-page-base>;\n\t}\n\n    externalLogin(loginapi: string, registerapi: string) {\n        const errorpopup = document.querySelector(\"ks-error-popup\") as HTMLKsErrorPopupElement;\n        const overlay = this.root.querySelector(\"ks-overlay.loading\") as HTMLKsOverlayElement;\n\n        overlay.show();\n        const translations = login.get(\"strings\");\n\n        formfetch(loginapi, {data: \"social\"})\n        .then(data => data.text())\n        .then(data => {\n            if(data.includes(\"noaccount\"))\n                window.location.replace(registerapi);\n\n            else if ( data.length > 10 ) {   \n                overlay.hide();\n                errorpopup.show(new Error(data));\n           } else {\n                overlay.hide();\n                errorpopup.show(new Error(translations.externalLoginError));\n           }\n        });\n    }\n}\n\n\n\n\n"],"mappings":"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"}
{"version":3,"names":["orderLoginCss","OrderLogin","constructor","hostRef","this","api","action","passwordMessage","passwordRecovery","heading","login","passwordRecoveryString","cartProductsMessage","promptHeading","promptToCart","promptToConfirmation","render","h","Host","key","class","onSubmit","event","Submit","submit","name","href","toCart","toConfirmation","preventDefault","form","root","querySelector","email","pass","Validate","IsValid","headers","Headers","append","formData","FormData","response","fetch","body","method","credentials","then","text","message","LoginPrompt","data","set","encodeURIComponent","get","toString","dialog","search","show"],"sources":["src/components/order/shipping/orderLogin.css?tag=ks-order-login","src/components/order/shipping/orderLogin.tsx"],"sourcesContent":["ks-order-login {\n    display: block;\n    padding: 30px;\n    background-color: #f2f2f2;\n    text-align: center;\n}\n\n@media (min-width: 1200px) {\n    ks-order-login {\n        padding: 40px;\n    }\n}\n\nks-order-login .contents {\n    max-width: 500px;\n    margin: auto;\n}\n\nks-order-login .recovery {\n    display: block;\n    margin-top: 10px;\n}\n\nks-order-login .contents h1 {\n    font-weight: 700;\n    font-size: 28px;\n}","import { Component, h, Element, Prop, Host } from '@stencil/core';\n\n@Component({\n  tag: 'ks-order-login',\n  styleUrl: 'orderLogin.css'\n})\nexport class OrderLogin {\n\n    @Element() root: HTMLElement;\n\n    @Prop() api: string = \"\";\n    @Prop() action: string = \"\";\n    @Prop() passwordMessage: string = \"\";\n    @Prop() passwordRecovery: string = \"\";\n\n    @Prop() heading: string = \"\";\n    @Prop() login: string = \"\";\n    @Prop() passwordRecoveryString: string = \"\";\n    @Prop() cartProductsMessage: string = \"\";\n\n    @Prop() promptHeading: string = \"\";\n    @Prop() promptToCart: string = \"\";\n    @Prop() promptToConfirmation: string = \"\";\n\n    render() {\n        return <Host>\n            <section class=\"contents\">\n                <h1>{this.heading}</h1>\n\n                <form onSubmit={(event)=>this.Submit(event)}>\n                    <slot />\n\n                    <ks-button submit name={this.login} />\n                </form>\n\n                <a class=\"recovery\" href={this.passwordRecovery}>\n                    {this.passwordRecoveryString}\n                </a>\n            </section>\n            <ks-order-login-prompt \n                heading={this.promptHeading}\n                toCart={this.promptToCart}\n                toConfirmation={this.promptToConfirmation}\n            />\n        </Host>;\n    }\n\n    async Submit(event: Event) {\n        event.preventDefault();\n\n        const form = this.root.querySelector(\"form\");\n        const email = form.querySelector(\"ks-input-dynamic, ks-input-text[email]\") as HTMLKsInputDynamicElement;\n        const pass = form.querySelector(\"ks-input-text[password]\") as HTMLKsInputTextElement;\n\n        await email.Validate();\n        await pass.Validate();\n\n        if (await email.IsValid() && await pass.IsValid()) {\n            var headers = new Headers();\n            headers.append('pragma', 'no-cache');\n            headers.append('cache-control', 'no-cache');\n\n            const formData = new FormData(form);\n\n            const response = await fetch(this.api, {\n                body: formData,\n                method: 'POST',\n                headers: headers,\n                credentials: \"same-origin\"\n            }).then(response => response.text());\n\n            if(response == \"false\")\n                pass.message = this.passwordMessage;\n\n            else if(response == \"true\") {\n                this.LoginPrompt(formData);\n            }\n        }\n    }\n\n    async LoginPrompt(data: FormData) {\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        const formData = new FormData();\n        formData.set(\"data\", `email=${encodeURIComponent(data.get(\"email\").toString())}&haslo=${encodeURIComponent(data.get(\"haslo\").toString())}`)\n\n        const response = await fetch(this.action, {\n            body: formData,\n            method: 'POST',\n            headers: headers,\n            credentials: \"same-origin\"\n        }).then(response => response.text());\n\n        const dialog = this.root.querySelector(\"ks-order-login-prompt\");\n\n        if(response.search(\"koszyk.html\") != -1) dialog.show(this.cartProductsMessage);\n        else dialog.show();\n    }\n}"],"mappings":"6DAAA,MAAMA,EAAgB,uT,MCMTC,EAAU,MAJvB,WAAAC,CAAAC,G,UAQYC,KAAGC,IAAW,GACdD,KAAME,OAAW,GACjBF,KAAeG,gBAAW,GAC1BH,KAAgBI,iBAAW,GAE3BJ,KAAOK,QAAW,GAClBL,KAAKM,MAAW,GAChBN,KAAsBO,uBAAW,GACjCP,KAAmBQ,oBAAW,GAE9BR,KAAaS,cAAW,GACxBT,KAAYU,aAAW,GACvBV,KAAoBW,qBAAW,EA8E1C,CA5EG,MAAAC,GACI,OAAOC,EAACC,EAAI,CAAAC,IAAA,4CACRF,EAAS,WAAAE,IAAA,2CAAAC,MAAM,YACXH,EAAK,MAAAE,IAAA,4CAAAf,KAAKK,SAEVQ,EAAA,QAAAE,IAAA,2CAAME,SAAWC,GAAQlB,KAAKmB,OAAOD,IACjCL,EAAQ,QAAAE,IAAA,6CAERF,EAAW,aAAAE,IAAA,2CAAAK,OAAM,KAACC,KAAMrB,KAAKM,SAGjCO,EAAA,KAAAE,IAAA,2CAAGC,MAAM,WAAWM,KAAMtB,KAAKI,kBAC1BJ,KAAKO,yBAGdM,EAAA,yBAAAE,IAAA,2CACIV,QAASL,KAAKS,cACdc,OAAQvB,KAAKU,aACbc,eAAgBxB,KAAKW,uB,CAKjC,YAAMQ,CAAOD,GACTA,EAAMO,iBAEN,MAAMC,EAAO1B,KAAK2B,KAAKC,cAAc,QACrC,MAAMC,EAAQH,EAAKE,cAAc,0CACjC,MAAME,EAAOJ,EAAKE,cAAc,iCAE1BC,EAAME,iBACND,EAAKC,WAEX,SAAUF,EAAMG,iBAAmBF,EAAKE,UAAW,CAC/C,IAAIC,EAAU,IAAIC,QAClBD,EAAQE,OAAO,SAAU,YACzBF,EAAQE,OAAO,gBAAiB,YAEhC,MAAMC,EAAW,IAAIC,SAASX,GAE9B,MAAMY,QAAiBC,MAAMvC,KAAKC,IAAK,CACnCuC,KAAMJ,EACNK,OAAQ,OACRR,QAASA,EACTS,YAAa,gBACdC,MAAKL,GAAYA,EAASM,SAE7B,GAAGN,GAAY,QACXR,EAAKe,QAAU7C,KAAKG,qBAEnB,GAAGmC,GAAY,OAAQ,CACxBtC,KAAK8C,YAAYV,E,GAK7B,iBAAMU,CAAYC,GACd,IAAId,EAAU,IAAIC,QAClBD,EAAQE,OAAO,SAAU,YACzBF,EAAQE,OAAO,gBAAiB,YAEhC,MAAMC,EAAW,IAAIC,SACrBD,EAASY,IAAI,OAAQ,SAASC,mBAAmBF,EAAKG,IAAI,SAASC,qBAAqBF,mBAAmBF,EAAKG,IAAI,SAASC,eAE7H,MAAMb,QAAiBC,MAAMvC,KAAKE,OAAQ,CACtCsC,KAAMJ,EACNK,OAAQ,OACRR,QAASA,EACTS,YAAa,gBACdC,MAAKL,GAAYA,EAASM,SAE7B,MAAMQ,EAASpD,KAAK2B,KAAKC,cAAc,yBAEvC,GAAGU,EAASe,OAAO,iBAAkB,EAAID,EAAOE,KAAKtD,KAAKQ,0BACrD4C,EAAOE,M","ignoreList":[]}
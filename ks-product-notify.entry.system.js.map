{"version":3,"file":"ks-product-notify.entry.system.js","sources":["src/components/product/product-notify.css?tag=ks-product-notify","src/components/product/product-notify.tsx"],"sourcesContent":["ks-product-notify {\n    display: block;\n}\n\nks-product-notify fieldset {\n    border: none;\n    margin: 0;\n    padding: 0;\n}\n\nks-product-notify .info {\n    text-align: center;\n    margin-bottom: 40px;\n}\n\nks-product-notify .info a {\n    text-decoration: none;\n    color: black;\n    margin: 0 5px;\n}\n\nks-product-notify h3 {\n    font-family: var(--font-emphasis);\n    font-size: 20px;\n    font-weight: 700;\n}\n\nks-product-notify ks-input-check {\n    margin-bottom: 5px;\n}\n\nks-product-notify ks-button {\n    margin-top: 20px;\n}","import { Component, h, Element, Method, State } from '@stencil/core';\nimport { product } from \"../../global/data/product\";\nimport { common } from \"../../global/data/common\";\nimport { commonDynamic } from \"../../global/data/commonDynamic\";\nimport ValidateInput from '../input/validate';\n\n@Component({\n    tag: 'ks-product-notify',\n    styleUrl: 'product-notify.css'\n})\nexport class ProductNotify {\n    @Element() root: HTMLElement;\n    dialog: HTMLKsDialogElement;\n\n    @State() resultHeading: string;\n    @State() resultParagraph: string;\n\n    async requestHandler(event: Event) {\n        const strings = product.get(\"strings\");\n        const productId = product.get(\"id\");\n        const api = commonDynamic.get(\"api\").notifyAvailability;\n\n        event.preventDefault();\n        if(!await ValidateInput(this.root.querySelector('form')))\n            return;\n\n        this.dialog.showLoading();\n\n        const target = event.target as HTMLFormElement;\n        const data = new FormData(target);\n        data.append(\"product\", productId);\n\n        await fetch(api, { body: data, method: \"post\"})\n        .then(async response => response.json())\n        .then(async data => {\n            const containsData = \"status\" in data && \"heading\" in data && \"paragraph\" in data;\n            if (!containsData) throw new Error(strings.notifyErrorParagraph);\n                \n            if(data.status == \"success\")\n                this.dialog.showSuccess(data.heading, data.paragraph);\n\n            else this.dialog.showFailure(data.heading, data.paragraph);\n        })\n        .catch(async error => {\n            let message = \"\";\n\n            if(!window.navigator.onLine)\n                message = strings.noInternet;\n\n            else if(error.message != \"\")\n                message = error.message;\n\n            console.log(error.message);\n            this.dialog.showFailure(strings.notifyErrorHeading, message);\n        });\n    }\n\n    @Method()\n    async show() {\n        this.dialog.show();\n    }\n\n    componentDidLoad() {\n        this.dialog = this.root.querySelector('ks-dialog');\n    }\n\n\trender() {\n        const strings = product.get(\"strings\");\n\n\t\treturn <ks-dialog dark>\n            <form onSubmit={e => this.requestHandler(e)}>\n                <fieldset>\n                    <div class=\"info\">\n                        <h3>{strings.notifyHeading}</h3>\n                        <p>{strings.notifyParagraph}</p>\n\n                        <a href={\"mailto:\" + common.get('email')}>{common.get('email')}</a> â€¢\n                        <a href={\"tel:\" + common.get('phone')}>{common.get('phone')}</a>\n                    </div>\n\n                    <ks-input-text email name=\"email\" required nomessage placeholder=\"E-mail\" icon=\"mail\"/>\n                    <ks-input-check checked name=\"backorders\" nomessage label={strings.notifyBackorders}></ks-input-check>\n\n                    <ks-input-check name=\"zgoda\" required nomessage label={strings.notifyAgreement}></ks-input-check>\n\n                    <ks-button submit name={strings.notifyMe} />\n                </fieldset>\n            </form>\n        </ks-dialog>;\n    }\n\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;YAAA,MAAM,gBAAgB,GAAG,qZAAqZ;;kBCUja,aAAa,gCAAA,MAAA;;;;gBAOtB,MAAM,cAAc,CAAC,KAAY,EAAA;oBAC7B,MAAM,OAAO,GAAG,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC;oBACtC,MAAM,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC;oBACnC,MAAM,GAAG,GAAG,aAAa,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,kBAAkB;oBAEvD,KAAK,CAAC,cAAc,EAAE;YACtB,QAAA,IAAG,CAAC,MAAM,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;wBACpD;YAEJ,QAAA,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;YAEzB,QAAA,MAAM,MAAM,GAAG,KAAK,CAAC,MAAyB;YAC9C,QAAA,MAAM,IAAI,GAAG,IAAI,QAAQ,CAAC,MAAM,CAAC;YACjC,QAAA,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,SAAS,CAAC;YAEjC,QAAA,MAAM,KAAK,CAAC,GAAG,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAC;yBAC7C,IAAI,CAAC,OAAM,QAAQ,KAAI,QAAQ,CAAC,IAAI,EAAE;YACtC,aAAA,IAAI,CAAC,OAAM,IAAI,KAAG;YACf,YAAA,MAAM,YAAY,GAAG,QAAQ,IAAI,IAAI,IAAI,SAAS,IAAI,IAAI,IAAI,WAAW,IAAI,IAAI;YACjF,YAAA,IAAI,CAAC,YAAY;YAAE,gBAAA,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,oBAAoB,CAAC;YAEhE,YAAA,IAAG,IAAI,CAAC,MAAM,IAAI,SAAS;YACvB,gBAAA,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC;;YAEpD,gBAAA,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC;YAC9D,SAAC;YACA,aAAA,KAAK,CAAC,OAAM,KAAK,KAAG;wBACjB,IAAI,OAAO,GAAG,EAAE;YAEhB,YAAA,IAAG,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM;YACvB,gBAAA,OAAO,GAAG,OAAO,CAAC,UAAU;YAE3B,iBAAA,IAAG,KAAK,CAAC,OAAO,IAAI,EAAE;YACvB,gBAAA,OAAO,GAAG,KAAK,CAAC,OAAO;YAE3B,YAAA,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC;wBAC1B,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,kBAAkB,EAAE,OAAO,CAAC;YAChE,SAAC,CAAC;;YAIN,IAAA,MAAM,IAAI,GAAA;YACN,QAAA,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;;gBAGtB,gBAAgB,GAAA;oBACZ,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC;;gBAGzD,MAAM,GAAA;oBACC,MAAM,OAAO,GAAG,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC;YAE5C,QAAA,OAAO,kEAAW,IAAI,EAAA,IAAA,EAAA,EACZ,CAAM,CAAA,MAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAA,QAAQ,EAAE,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,EAAA,EACvC,CAAA,CAAA,UAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAA,EACI,CAAK,CAAA,KAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAA,KAAK,EAAC,MAAM,EAAA,EACb,CAAK,CAAA,IAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAA,EAAA,OAAO,CAAC,aAAa,CAAM,EAChC,CAAI,CAAA,GAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAA,EAAA,OAAO,CAAC,eAAe,CAAK,EAEhC,CAAA,CAAA,GAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAG,IAAI,EAAE,SAAS,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,IAAG,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAK,aACnE,CAAA,CAAA,GAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAG,IAAI,EAAE,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,EAAA,EAAG,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAK,CAC9D,EAEN,CAAA,CAAA,eAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAe,KAAK,EAAC,IAAA,EAAA,IAAI,EAAC,OAAO,EAAC,QAAQ,EAAA,IAAA,EAAC,SAAS,EAAA,IAAA,EAAC,WAAW,EAAC,QAAQ,EAAC,IAAI,EAAC,MAAM,EAAE,CAAA,EACvF,CAAA,CAAA,gBAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAgB,OAAO,EAAA,IAAA,EAAC,IAAI,EAAC,YAAY,EAAC,SAAS,EAAA,IAAA,EAAC,KAAK,EAAE,OAAO,CAAC,gBAAgB,EAAmB,CAAA,EAEtG,CAAA,CAAA,gBAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAgB,IAAI,EAAC,OAAO,EAAC,QAAQ,EAAA,IAAA,EAAC,SAAS,EAAA,IAAA,EAAC,KAAK,EAAE,OAAO,CAAC,eAAe,EAAmB,CAAA,EAEjG,CAAW,CAAA,WAAA,EAAA,EAAA,GAAA,EAAA,0CAAA,EAAA,MAAM,EAAC,IAAA,EAAA,IAAI,EAAE,OAAO,CAAC,QAAQ,EAAI,CAAA,CACrC,CACR,CACC;;;;;;;;;;;;"}
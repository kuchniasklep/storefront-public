import{r as i,c as t,h as s,g as e}from"./index-1b90b4d2.js";import{w as o}from"./deferredpromise-05d3e1e9.js";const n="ks-img3{display:block;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:0;max-height:inherit;position:relative}ks-img3 picture{max-height:inherit}ks-img3 img{width:100%;height:100%;max-height:inherit;-o-object-position:center;object-position:center;opacity:1;-webkit-transition:opacity 0.3s ease;transition:opacity 0.3s ease}ks-img3 img.loading{opacity:0;height:0}ks-img3[fit='contain'] img{-o-object-fit:contain;object-fit:contain}ks-img3[fit='cover'] img{-o-object-fit:cover;object-fit:cover}ks-img3[fit='fill'] img{-o-object-fit:fill;object-fit:fill}ks-img3[fit='scale-down'] img{-o-object-fit:scale-down;object-fit:scale-down}ks-img3[fit='none'] img{-o-object-fit:none;object-fit:none}ks-img3[fit='contain'] canvas{-o-object-fit:contain;object-fit:contain}ks-img3[fit='cover'] canvas{-o-object-fit:cover;object-fit:cover}ks-img3[fit='fill'] canvas{-o-object-fit:fill;object-fit:fill}ks-img3[fit='scale-down'] canvas{-o-object-fit:scale-down;object-fit:scale-down}ks-img3[fit='none'] canvas{-o-object-fit:none;object-fit:none}ks-img2 canvas{display:inline-block;width:auto;height:auto;max-width:inherit;max-height:inherit;font-size:0;vertical-align:middle}";const a=class{constructor(s){i(this,s);this.lazyLoaded=t(this,"lazyLoaded",7);this.image=undefined;this.webp=undefined;this.alt=undefined;this.target=undefined;this.observerMargin=undefined;this.sync=false;this.width=undefined;this.height=undefined;this.fit=undefined;this.loaded=false}loadHandler(i){var t;if(i.target instanceof HTMLElement&&!((t=i.target.getAttribute("src"))===null||t===void 0?void 0:t.includes("data:image"))){this.loaded=true;this.lazyLoaded.emit()}}srcListener(){const i=this.root.querySelector("img");i.removeAttribute("src");i.setAttribute("src",this.image);setTimeout((()=>{if(!i.complete){this.loaded=false}}),200)}componentDidLoad(){if(!this.sync)o.promise.then((()=>this.initializeObserver()))}initializeObserver(){this.img=this.root.querySelector("img");this.source=this.root.querySelector("source");const i=this.target?this.root.closest(this.target):this.root.parentElement;const t=i=>{var t;for(const s of i){if(s.isIntersecting){if(this.observer){this.observer.disconnect()}if((t=this.source)===null||t===void 0?void 0:t.getAttribute("data-srcSet")){this.source.setAttribute("srcSet",this.source.getAttribute("data-srcSet"));this.source.removeAttribute("data-srcSet")}if(this.img.getAttribute("data-src")){this.img.setAttribute("src",this.img.getAttribute("data-src"));this.img.removeAttribute("data-src")}}}};if(this.image&&i){this.observer=new IntersectionObserver(t,{rootMargin:this.observerMargin});this.observer.observe(i)}}render(){const i=this.loaded?"":"loading";if(this.sync)return[s("picture",null,this.webp?s("source",{srcSet:this.webp,type:"image/webp"}):null,s("img",{src:this.image,alt:this.alt,width:this.width,height:this.height}))];return[s("picture",null,this.webp?s("source",{"data-srcSet":this.webp,type:"image/webp"}):null,s("img",{class:i,onLoad:i=>this.loadHandler(i),"data-src":this.image,alt:this.alt,width:this.width,height:this.height})),!this.loaded?[s("ks-loader",{dark:true}),s("canvas",{width:this.width,height:this.height})]:null]}get root(){return e(this)}static get watchers(){return{image:["srcListener"]}}};a.style=n;export{a as ks_img3};
//# sourceMappingURL=ks-img3.entry.js.map
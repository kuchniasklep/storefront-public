{"version":3,"names":["listing","createStore","listingCss","PageListing","componentWillLoad","listingDataElement","document","getElementById","this","listingData","JSON","parse","innerHTML","Object","keys","map","key","set","track","get","DataLayer","state","render","bottomDescription","infoBanner","tags","navigation","filters","products","query","review","strings","common","h","skipbase","commonData","commonDynamicData","content","heading","breadcrumbs","description","categories","autocorrect","length","base","post","paginationBase","current","count","pattern","card","product","noContentHome","noContentBack","slot","crumb","href","link","name","grey"],"sources":["src/global/data/listing.ts","src/components/pages/listing/listing.css?tag=ks-page-listing","src/components/pages/listing/listing.tsx"],"sourcesContent":["import { createStore } from \"@stencil/store\";\nimport { InfoBannerData, ReviewAverage } from \"./common\";\nimport { CategoryNameData } from \"./product\";\n\nexport const listing = createStore({} as ListingData);\n\nexport interface ListingData {\n    type: string;\n\n    title: string;\n    sorting: number;\n    autocorrect: string;\n    query: string;\n    description: string;\n    bottomDescription: string;\n\n    infoBanner: InfoBannerData;\n    breadcrumbs: NameLinkData[];\n    categories: NameLinkData[];\n    tags: NameLinkData[];\n    products: ProductCardData[];\n\n    navigation: ListingNavigationData;\n    filters: ListingFilterData[];\n\n    noContentHeading: string;\n    noContentMessage: string;\n    reviewAverage: ReviewAverage;\n}\n\nexport interface NameLinkData {\n    id: string;\n    name: string;\n    link: string;\n}\n\nexport interface ListingNavigationData {\n    count: number;\n    current: number;\n    products: number;\n    base: string;\n    paginationBase: string;\n    pattern: string;\n}\n\nexport interface ListingFilterData {\n    name: string;\n    type: string;\n    active: boolean;\n    items: (ListingFilterCheckboxData|ListingFilterSliderData)[];\n}\n\nexport interface ListingFilterCheckboxData {\n    name: string;\n    value: string;\n    content: string;\n    active: boolean;\n}\n\nexport interface ListingFilterSliderData {\n    name: string;\n    values: string;\n    snap: boolean;\n    steps?: string;\n    from?: number;\n    to?: number;\n}\n\nexport interface ProductCardData {\n    id: string;\n    sku: string;\n    name: string;\n    link: string;\n    image: string;\n    imageFull: string;\n    webp: string;\n    unavailable?: boolean;\n    currentPrice: number;\n    previousPrice?: number;\n    shippingMessage?: string;\n    currency: string;\n    categories: CategoryNameData[];\n    breadcrumbs: CategoryNameData[];\n    brandName: string;\n}","ks-page-listing {\n    flex: 1 1 0;\n}\n\nks-page-listing .noresults {\n    width: auto;\n    max-height: 300px\n}","import { Component, h, Prop } from '@stencil/core';\nimport { common } from '../../../global/data/common';\nimport { listing, ListingData } from \"../../../global/data/listing\";\nimport { DataLayer } from '../../../global/dataLayer';\n\n@Component({\n    tag: 'ks-page-listing',\n    styleUrl: 'listing.css'\n})\nexport class PageListing {\n    @Prop() skipbase: boolean;\n    @Prop() commonData: string;\n    @Prop() commonDynamicData: string;\n\n    @Prop() listingData: string;\n\n    componentWillLoad() {\n        const listingDataElement = document.getElementById(this.listingData);\n\t\tconst listingData = JSON.parse(listingDataElement.innerHTML) as ListingData;\n\n        Object.keys(listingData).map(key => {\n\t\t\tlisting.set(key as keyof ListingData, listingData[key]);\n\t\t});\n\n        this.track();\n    }\n\n    track() {\n        if(!listing.get('query')) {\n            DataLayer.listing(listing.state);\n        }\n    }\n\n\trender() {\n        if(!listing?.get('title')) return false;\n\n        const bottomDescription = listing.get('bottomDescription');\n        const infoBanner = listing.get(\"infoBanner\");\n        const tags = listing.get('tags');\n        const navigation = listing.get('navigation');\n        const filters = listing.get('filters');\n        const products = listing.get('products');\n        const query = listing.get('query');\n        const review = listing.get('reviewAverage');\n\n        const strings = common.get('translations');\n\n\t\treturn <ks-page-base skipbase={this.skipbase} commonData={this.commonData} commonDynamicData={this.commonDynamicData}>\n\n            {infoBanner ? \n                <ks-content-info-banner content={infoBanner} />\n            : null}\n\n            <ks-listing-header\n                heading={listing.get('title')}\n                breadcrumbs={listing.get('breadcrumbs')}\n                description={listing.get('description')}\n                categories={listing.get('categories')}\n                query={query}\n                autocorrect={listing.get('autocorrect')}\n            />\n\n            {navigation && products?.length > 0 ?\n                <ks-listing-navigation products={navigation.products}>\n                    \n                    {filters?.length > 0 ?\n                        <ks-filtering base-url={navigation.base} query={query} filters={filters} />\n                    : null}\n\n                    <ks-sorting post={navigation.paginationBase} current={listing.get('sorting')}></ks-sorting>\n                    <ks-pagination count={navigation.count} current={navigation.current} base={navigation.paginationBase} pattern={navigation.pattern} />\n                </ks-listing-navigation>\n            : null}\n\n            {products?.length > 0 ?\n                <ks-product-container>\n                    {products.map(card => \n                        <ks-product-card product={card}/>\n                    )}\n                </ks-product-container>\n            : \n                <ks-nocontent\n                    link-name={strings.noContentHome}\n                    back-name={strings.noContentBack}\n                >\n                    <h1>{listing.get('noContentHeading')}</h1>\n                    <p>{listing.get('noContentMessage')}</p>\n                </ks-nocontent>\n            }\n\n            {navigation && products?.length > 0 ?\n                <ks-listing-navigation products={navigation.products}>\n                    <ks-pagination count={navigation.count} current={navigation.current} base={navigation.paginationBase} pattern={navigation.pattern} />\n                </ks-listing-navigation>\n            : null}\n\n            { bottomDescription || tags?.length > 0 ?\n                <ks-listing-footer description={bottomDescription}>\n                    {tags?.length > 0 ?\n                        <div slot=\"tags\">\n                            {tags.map(crumb =>\n                                <a href={crumb.link}>{crumb.name}</a>\n                            )}\n                        </div>\n                    : null}\n\n                    {!query && navigation && products?.length > 0 && review ?\n                        <ks-content-reviews content={review} slot=\"comments\" grey />\n                    : null}\n                </ks-listing-footer>\n\n            : !query && navigation && products?.length > 0 && review ?\n                <ks-content-reviews content={review} />\n            : null }\n\n            \n        </ks-page-base>;\n\t}\n}\n"],"mappings":"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"}
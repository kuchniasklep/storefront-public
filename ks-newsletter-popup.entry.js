import{r as e,h as t,g as s}from"./index-1b90b4d2.js";import{V as i}from"./validate-fd0da345.js";import{c as p}from"./commonDynamic-3e6c308f.js";import{D as o}from"./dataLayer-d75ea728.js";import"./index-33fbe4a7.js";import"./fetch-13200e62.js";const n="ks-newsletter-popup{display:block}ks-newsletter-popup form{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:justify;justify-content:space-between;height:100%;width:100%;max-width:720px}ks-newsletter-popup .info{padding:60px 60px 20px 60px;fill:#252525;-ms-flex:1 0 auto;flex:1 0 auto;min-height:10px}ks-newsletter-popup .info .top{width:100%;margin-bottom:10px;font-size:initial;max-height:30px}ks-newsletter-popup .info .heading{width:100%;font-family:var(--font-emphasis);font-size:initial;max-height:80px;margin-bottom:10px}ks-newsletter-popup .info p{text-align:center;margin-top:10px}ks-newsletter-popup .buttons{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;min-height:10px;margin-top:30px}ks-newsletter-popup .buttons>*{-ms-flex:1;flex:1}ks-newsletter-popup .close{color:black !important}ks-newsletter-popup ks-input-check{margin:20px;font-size:13px;line-height:18px}ks-newsletter-popup .email-form{display:-ms-flexbox;display:flex}ks-newsletter-popup .email-form>*{margin-bottom:0px}ks-newsletter-popup .email-form>* input{height:60px}ks-newsletter-popup .email-form>ks-button{width:30%}ks-newsletter-popup .email-form>ks-input-text{width:100%}ks-newsletter-popup .email{-ms-flex:1 0 0px;flex:1 0 0;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;background-color:#e5e5e5;color:black;font-size:18px;min-height:50px}@media (max-width: 720px){ks-newsletter-popup .info .heading{max-height:50px}ks-newsletter-popup .email{font-size:16px}}@media (max-width: 540px){ks-newsletter-popup .info{padding:70px 25px 20px 25px;min-height:180px}ks-newsletter-popup .info .top{display:none}ks-newsletter-popup .info p{font-size:13px}ks-newsletter-popup ks-input-check{font-size:11px;line-height:16px}ks-newsletter-popup .email-form{display:block}ks-newsletter-popup .email-form>ks-button{width:100%}ks-newsletter-popup .buttons{display:block;margin-top:0px}ks-newsletter-popup .buttons>*:first-child{border-bottom:1px solid #3a3a3a}ks-newsletter-popup ks-input-check{margin:15px}ks-newsletter-popup .info .heading{width:100%;max-height:40px}}";const a=class{constructor(t){e(this,t);this.success=false;this.api=undefined;this.loginLink=undefined;this.registerLink=undefined;this.displayOnLoad=false;this.loggedIn=false;this.subscribed=false;this.email=undefined;this.agreement="Wyrażam zgodę na przetwarzanie danych osobowych do celów marketingowych, w celu zbadania opinii o sklepie oraz na otrzymywanie informacji handlowych na wskazany przeze mnie adres e-mail.";this.infoMessage="Aby otrzymać kupon rabatowy musisz posiadać konto w naszym sklepie. Minimalna wartość zamówienia wynosi: 100,00 zł";this.successHeading="ZAPISANO DO NEWSLETTERA";this.successUnsubHeading="WYPISANO Z NEWSLETTERA";this.faliureHeading="BŁĄD ZAPISU"}componentDidLoad(){this.dialog=this.root.querySelector("ks-dialog");if(this.displayOnLoad&&document.cookie.search("newsletterPopup=tak")==-1){setTimeout((()=>{this.Show()}),4e3)}}async requestHandler(e){e.preventDefault();if(!await i(this.root.querySelector("form")))return;this.dialog.showLoading();const t=e.target;const s=new FormData(t);if(this.subscribed)s.append("unsubscribe","1");s.append("email",this.email);s.append("popup","1");fetch(this.api,{body:s,method:"post"}).then((async e=>{const t=await e.text();if(t.search("SUCCESS")!=-1){const e=this.subscribed?this.successUnsubHeading:this.successHeading;this.dialog.showSuccess(e,t.replace("SUCCESS",""));this.track();this.success=true}else this.dialog.showFailure(this.faliureHeading,t)})).catch((async e=>{let t="";if(!window.navigator.onLine)t="Brak internetu.";if(e.message)t=e.message;this.dialog.showFailure(this.faliureHeading,t)}))}track(){const e={email:this.email,subscriber:!this.subscribed,place:"Zapis do newslettera | Popup"};o.subscribe(e)}setSubscription(){let e=p.get("customer");e.subscriber=!this.subscribed;p.set("customer",e);this.subscribed=!this.subscribed}async Show(){this.dialog.show()}SetCookie(){var e="";var t=new Date;t.setMonth(t.getMonth()+1);e="expires="+t.toUTCString()+"; ";document.cookie="newsletterPopup=tak; "+e+"path=/";if(this.success){this.setSubscription();this.success=false}}render(){return[t("ks-dialog",{dark:true,smallmobile:true,nopadding:true,onClosed:()=>this.SetCookie()},t("form",{onSubmit:e=>this.requestHandler(e)},t("div",{class:"info"},t("svg",{class:"top",viewBox:"0 0 303 15",width:909,height:45},t("text",{x:"0",y:"12"},"Zapisz się do naszego Newslettera i zyskaj")),t("svg",{class:"heading",viewBox:"0 0 96 12",width:960,height:130},t("text",{x:"-1",y:"12"},"KUPON 10ZŁ")),t("p",null,this.infoMessage)),!this.loggedIn?t("div",{class:"buttons"},t("ks-button",{tall:true,name:"ZALOGUJ SIĘ",link:this.loginLink}),t("ks-button",{tall:true,name:"NOWE KONTO",link:this.registerLink})):[this.subscribed?null:t("ks-input-check",{large:true,required:true,nomessage:true,name:"zgoda",label:this.agreement}),t("div",{class:"email-form"},t("div",{class:"email"},this.email),t("ks-button",{submit:true,secondary:this.subscribed,name:this.subscribed?"WYPISZ SIĘ":"ZAPISZ SIĘ"}))]))]}get root(){return s(this)}};a.style=n;export{a as ks_newsletter_popup};
//# sourceMappingURL=ks-newsletter-popup.entry.js.map
{"version":3,"file":"addToCart-DaSe44f4.js","sources":["src/global/functions/addToCart.ts"],"sourcesContent":["import { commonDynamic } from \"../data/commonDynamic\";\nimport { ProductShortData } from \"../data/product\";\nimport Fetch from \"./fetch\";\nimport { DataLayer } from \"../dataLayer\";\n\nexport async function addToCart(product: ProductShortData, place = 1) {\n    const errorpopup = document.querySelector('ks-error-popup') as HTMLKsErrorPopupElement;\n    const messagepopup = document.querySelector('ks-message-popup') as HTMLKsMessagePopupElement;\n    const navbar = document.querySelector('ks-navbar') as HTMLKsNavbarElement;\n\n    let body = new FormData();\n    body.append(\"id\", product.id);\n    body.append(\"ilosc\", product.quantity.toString());\n    body.append(\"nazwa\", product.name);\n    body.append(\"value\", product.currentPrice.toString());\n    body.append(\"cechy\", product.traitIDs);\n    body.append(\"akcja\", 'dodaj');\n    body.append(\"miejsce\", place.toString());\n\n    const api = commonDynamic.get('api').addToCart;\n    return Fetch(api, body)\n        .then(async data => data.json())\n        .then(async data => {\n            if(!data.status) {\n                if(data.productLink)\n                    messagepopup.show(\"Wymagany wybór cechy\", data.message, \"Przejdź do produktu\", product.link);\n                else messagepopup.show(\"Błąd dodawania produktu\", data.message);\n                return;\n            }\n    \n            navbar.IncrementCart(product.quantity.toString());\n            OpenSuggestions(product.id, product.name);\n\n            DataLayer.addToCart(product, data.event);\n        })\n        .catch(error => {\n            errorpopup.show(error);\n        });\n};\n\nfunction OpenSuggestions(id: string, name: string) {\n    const suggestions = document.querySelector(\"ks-product-suggestions\");\n    suggestions.show(id, name);\n}"],"names":[],"mappings":";;;;AAKO,eAAe,SAAS,CAAC,OAAyB,EAAE,KAAK,GAAG,CAAC,EAAA;IAChE,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,gBAAgB,CAA4B;IACtF,MAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,kBAAkB,CAA8B;IAC5F,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAwB;AAEzE,IAAA,IAAI,IAAI,GAAG,IAAI,QAAQ,EAAE;IACzB,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,EAAE,CAAC;AAC7B,IAAA,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;IACjD,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,IAAI,CAAC;AAClC,IAAA,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;IACrD,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC;AACtC,IAAA,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC;IAC7B,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,CAAC,QAAQ,EAAE,CAAC;IAExC,MAAM,GAAG,GAAG,aAAa,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,SAAS;AAC9C,IAAA,OAAO,KAAK,CAAC,GAAG,EAAE,IAAI;SACjB,IAAI,CAAC,OAAM,IAAI,KAAI,IAAI,CAAC,IAAI,EAAE;AAC9B,SAAA,IAAI,CAAC,OAAM,IAAI,KAAG;AACf,QAAA,IAAG,CAAC,IAAI,CAAC,MAAM,EAAE;YACb,IAAG,IAAI,CAAC,WAAW;AACf,gBAAA,YAAY,CAAC,IAAI,CAAC,sBAAsB,EAAE,IAAI,CAAC,OAAO,EAAE,qBAAqB,EAAE,OAAO,CAAC,IAAI,CAAC;;gBAC3F,YAAY,CAAC,IAAI,CAAC,yBAAyB,EAAE,IAAI,CAAC,OAAO,CAAC;YAC/D;;QAGJ,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;QACjD,eAAe,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,IAAI,CAAC;QAEzC,SAAS,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC;AAC5C,KAAC;SACA,KAAK,CAAC,KAAK,IAAG;AACX,QAAA,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC;AAC1B,KAAC,CAAC;AACV;AAEA,SAAS,eAAe,CAAC,EAAU,EAAE,IAAY,EAAA;IAC7C,MAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,wBAAwB,CAAC;AACpE,IAAA,WAAW,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC;AAC9B;;;;"}
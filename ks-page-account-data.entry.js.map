{"version":3,"names":["dataCss","PageRegister","constructor","hostRef","this","heading","update","removeInfo","updateApi","emailApi","emailError","postcodeError","streetError","phoneError","success_heading","success_message","failure_heading","failure_message","notification_button","country","company","email","companyName","companyNip","firstname","lastname","phone","city","street","postcode","loading","countryWatcher","setTimeout","root","querySelector","Validate","render","postcodeRegex","undefined","h","Host","key","class","id","enctype","onSubmit","event","submit_register","api","message","required","name","label","icon","value","radio","checked","onChange","e","target","regex","regexMessage","type","address_id","customer_id","token","rounded","submit","border","link","accountLink","dark","notification_heading","notification_message","onClick","hide_notification","close","large","redirect_to_account","dialog","show","window","location","href","show_notification","hide","preventDefault","form","ValidateInput","filteredParams","URLSearchParams","FormData","forEach","append","toString","formData","headers","Headers","fetch","body","method","credentials","then","response","ok","status","text","includes","catch","error","console","log","navigator","onLine","Number","isInteger"],"sources":["src/components/pages/account/data.css?tag=ks-page-account-data","src/components/pages/account/data.tsx"],"sourcesContent":["ks-page-account-data {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex: 1 1 auto;\n    \n}\n\nks-page-account-data .container {\n    max-width: 100%;\n    width: 1000px;\n    box-sizing: border-box;\n    padding: 30px;\n    margin: 30px 0px;\n    background-color: #fff;\n    border-radius: 10px;\n}\n\nks-page-account-data .buttons {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    margin-top: 30px;\n}\n\nks-page-account-data .container > h1 {\n    text-align: center;\n    margin: 10px 0px 5px 0px;\n}\n\nks-page-account-data form > h2 {\n    margin-top: 30px;\n}\n\nks-page-account-data form > ks-button {\n    margin-top: 40px;\n}\n\n\nks-page-account-data .columns {\n    display: flex;\n    gap: 20px;\n    margin-bottom: 15px;\n}\n\nks-page-account-data .columns > * {\n    width: 100%;\n}\n\nks-page-account-data .radio {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 10px;\n}\n\nks-page-account-data .success {\n    text-align: center;\n}\n\nks-page-account-data .success .loader {\n    position: relative;\n    width: 100px;\n    height: 100px;\n    margin: auto;\n}\n\nks-page-account-data ks-dialog .content {\n    width: 100%;\n}\n\nks-page-account-data #notification-dialog section ks-button {\n    margin-top: 20px;\n}\n\n@media (max-width: 1060px) {\n    ks-page-account-data {\n        background-color: #fff;\n    }\n\n    ks-page-account-data .container {\n        padding: 20px;\n        margin: 0px;\n    }\n}\n\n@media (max-width: 960px) {\n    ks-page-account-data .columns {\n        flex-direction: column;\n        gap: 20px;\n    }\n}","import { Component, h, Host, Prop, Element, State, Watch } from '@stencil/core';\nimport ValidateInput from '../../input/validate';\n\n@Component({\n    tag: 'ks-page-account-data',\n    styleUrl: 'data.css'\n})\nexport class PageRegister {\n    @Element() root: HTMLElement;\n    \n    @Prop() heading: string = \"Moje dane\";\n    @Prop() update: string = \"Aktualizuj dane\";\n    @Prop() removeInfo: string = \"W celu usunięcia konta skontaktuj się z naszym działem obsługi klienta drogą mailową lub telefoniczną.\";\n\n    @Prop() address_id: string;\n    @Prop() customer_id: string;\n    @Prop() token: string;\n    \n    @Prop() accountLink: string;\n    @Prop() updateApi: string = \"\";\n    @Prop() emailApi: string = \"res/true?email=\";\n    @Prop() emailError: string = \"Podany email został już wykorzystany, skorzystaj z funkcji odzyskiwania hasła.\";\n    @Prop() postcodeError: string = \"Wprowadź kod pocztowy w formacie XX-XXX\";\n    @Prop() streetError: string = \"Wprowadź conajmniej nazwę ulicy oraz numer domu\";\n    @Prop() phoneError: string = \"Wprowadź prawidłowy numer telefonu\";\n    \n    @Prop() success_heading: string = \"Dane zaktualizowane\";\n    @Prop() success_message: string = \"Twoje dane zostały zaktualizowane, za chwilę nastąpi przekierowanie na panel klienta.\";\n\n    @Prop() failure_heading: string = \"Dane nie zaktualizowane\";\n    @Prop() failure_message: string = \"Sprawdź wprowadzone dane i spróbuj ponownie, jeżeli problem dalej występuje skontaktuj się z naszą obsługą.\";\n    @Prop() notification_button: string = \"Wróć do aktualizacji danych\";\n\n    @Prop({mutable: true}) country: string = \"170\";\n    @Prop({mutable: true}) company: string = \"1\";\n    @Prop() email: string = \"\";\n    @Prop() companyName: string = \"\";\n    @Prop() companyNip: string = \"\";\n    @Prop() firstname: string = \"\";\n    @Prop() lastname: string = \"\";\n    @Prop() phone: string = \"\";\n    @Prop() city: string = \"\";\n    @Prop() street: string = \"\";\n    @Prop() postcode: string = \"\";\n    \n    @State() loading: boolean = false;\n    @State() notification_heading: string;\n    @State() notification_message: string;\n\n    @Watch(\"country\") async countryWatcher() {\n        setTimeout(() => {\n            (this.root.querySelector(\"#postcode_input\") as HTMLKsInputTextElement).Validate();\n        }, 100);\n    }\n\n    render() {\n        const postcodeRegex = this.country == \"170\" ? \"^[0-9]{2}-[0-9]{3}$\" : undefined;\n\n        return <Host>\n            <section class=\"container\">\n                <h1>{this.heading}</h1>\n\n                <form id=\"dataupdate\" enctype=\"application/x-www-form-urlencoded\" onSubmit={(event)=>this.submit_register(event)}>\n                    <ks-input-dynamic api={this.emailApi} message={this.emailError}>\n                        <ks-input-text email required name='email' label=\"Adres email\" icon=\"mail\" value={this.email} />\n                    </ks-input-dynamic>\n\n                    <div class=\"radio\">\n                        <ks-input-check radio name=\"osobowosc\" value=\"1\" label=\"Osoba fizyczna\" checked={this.company == \"1\"} onChange={() => this.company = \"1\"} />\n                        <ks-input-check radio name=\"osobowosc\" value=\"0\" label=\"Firma\"          checked={this.company == \"0\"} onChange={() => this.company = \"0\"}/>\n                    </div>\n\n                    {this.company && <div class=\"columns\">\n                        <ks-input-text required name='nazwa_firmy' label=\"Nazwa Firmy\" icon=\"briefcase\" value={this.companyName} />\n                        <ks-input-text required name='nip_firmy' label=\"Numer NIP\" icon=\"briefcase\" value={this.companyNip}  />\n                    </div>}\n\n                    <ks-input-select name='panstwo' label=\"Kraj\" onChange={e => this.country = (e.target as HTMLSelectElement).value}>\n                        <slot name=\"country\" />\n                    </ks-input-select>\n\n                    <div class=\"columns\">\n                        <div>\n                            <ks-input-text required name='imie' label=\"Imię\" icon=\"user\" value={this.firstname} />\n                            <ks-input-text required name='nazwisko' label=\"Nazwisko\" icon=\"user\" value={this.lastname} />\n                            <ks-input-text required phone name='telefon' label=\"Numer Telefonu\" icon=\"phone\" value={this.phone} />\n                        </div>\n\n                        <div>\n                            <ks-input-text required name='miasto' label=\"Miasto\" icon=\"map-pin\" value={this.city} />\n                            <ks-input-text required name='ulica' label=\"Ulica i numer domu / lokalu\" icon=\"map-pin\" value={this.street} regex=\"[a-zа-я].*[0-9]|[0-9].*[a-zа-я]\" regexMessage={this.streetError}/>\n                            <ks-input-text required id=\"postcode_input\" name='kod_pocztowy' label=\"Kod Pocztowy\" icon=\"map-pin\" value={this.postcode} regex={postcodeRegex} regexMessage={this.postcodeError} />\n                        </div>\n                    </div>\n\n                    <input type=\"hidden\" value=\"1\" name=\"przetwarzanie_dodatkowe\" />\n                    <input type=\"hidden\" name=\"adres_id\" value={this.address_id} />\n                    <input type=\"hidden\" name=\"id_klienta\" id=\"id_klienta\" value={this.customer_id} />\n                    <input type=\"hidden\" name=\"tok\" value={this.token} />\n                    <input type=\"hidden\" name=\"akcja\" value=\"zapisz\" />\n\n\n                    <p>{this.removeInfo}</p>\n\n                    <div class=\"buttons\">\n                        <ks-button rounded submit name={this.update} loading={this.loading} />\n                        <ks-button rounded border link={this.accountLink} name=\"Wróć do panelu klienta\" loading={this.loading} />\n                    </div>\n                </form>\n\n                <ks-dialog id=\"notification-dialog\" dark>\n                    <section>\n                        <h1>{this.notification_heading}</h1>\n                        <p>{this.notification_message}</p>\n\n                        <ks-button rounded onClick={()=>this.hide_notification()} name={this.notification_button} />\n                    </section>\n                </ks-dialog>\n\n                <ks-overlay dark id=\"loading-overlay\" close={false}>\n                    <div class=\"success\">\n                        <h1>{this.success_heading}</h1>\n                        <p>{this.success_message}</p>\n                        <div class=\"loader\">\n                            <ks-loader large />\n                        </div>\n                    </div>\n                </ks-overlay>\n            </section>\n        </Host>;\n    }\n\n    redirect_to_account() {\n        const dialog = this.root.querySelector(\"#loading-overlay\") as any;\n        dialog.show();\n\n        setTimeout(() => {\n            window.location.href = this.accountLink;\n        }, 1000);\n    }\n\n    show_notification(heading: string, message: string) {\n        this.notification_heading = heading;\n        this.notification_message = message;\n\n        const dialog = this.root.querySelector(\"#notification-dialog\") as any;\n        dialog.show();\n    }\n\n    hide_notification() {\n        const dialog = this.root.querySelector(\"#notification-dialog\") as any;\n        dialog.hide();\n    }\n\n    async submit_register(event: Event) {\n        event.preventDefault();\n        this.loading = true;\n\n        const form = this.root.querySelector(\"#dataupdate\") as HTMLFormElement;\n\n        if(!await ValidateInput(form)) {\n            this.loading = false;\n            return;\n        }\n\n        const filteredParams = new URLSearchParams();\n\n        new FormData(form).forEach((value, key) => {\n            filteredParams.append(key, value.toString());\n        })\n\n        const formData = new FormData();\n        formData.append(\"data\", filteredParams.toString());\n\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        await fetch(this.updateApi, {\n            body: formData,\n            method: 'POST',\n            headers: headers,\n            credentials: \"same-origin\"\n        })\n        .then(response => {\n            if(!response.ok) throw response.status;\n            return response.text();\n        })\n        .then(response => {\n            if(response.includes(\"Twoje konto zostało założone\") || true)\n                this.redirect_to_account();\n            //else this.show_notification(this.failure_heading, this.failure_message);\n        })\n        .catch(error => {\n            console.log(error);\n            let message = error;\n\n            if(!navigator.onLine)\n                message = \"Brak połączenia z internetem.\";\n\n            else if(Number.isInteger(error))\n                message = `Błąd połączenia - ${error}`;\n\n            this.show_notification(this.failure_heading, message);\n        });\n\n        this.loading = false;\n    }\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["orderDPDCss","OrderDPD","componentDidLoad","this","overlay","root","querySelector","show","event","preventDefault","initialized","hide","async","valid","code","point","Validate","formData","FormData","append","headers","Headers","fetch","api","method","body","credentials","render","h","pointMessage","class","missingMessage","round","icon","onClick","e","name","button","type","value","src","vertical","height","width","id","innerHTML"],"sources":["src/components/order/confirmation/orderDPD.css?tag=ks-order-dpd","src/components/order/confirmation/orderDPD.tsx"],"sourcesContent":["ks-order-dpd .content {\n    background-color: #e8e8e8;\n\n    position: relative;\n    box-sizing: border-box;\n    width: 100%;\n    height: 100%;\n}\n\nks-order-dpd > ks-button {\n    max-width: 300px;\n    margin: 15px auto 0 auto;\n}\n\nks-order-dpd .topBar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    background-color: #dc0032;\n}\n\nks-order-dpd .missing {\n    color: #dc0032;\n}\n\nks-order-dpd .topBar ks-img2 {\n    height: 40px;\n}","import { Component, h, Prop, Element, State, Method } from '@stencil/core';\n\n@Component({\n  tag: 'ks-order-dpd',\n  styleUrl: 'orderDPD.css'\n})\nexport class OrderDPD {\n    @Element() root: HTMLElement;\n    @Prop() api: string = \"\";\n    @Prop() button: string = \"\";\n    @Prop() pointMessage: string = \"\";\n    @Prop() missingMessage: string = \"\";\n    @Prop() description: string = \"\";\n\n    @State() code: string = \"\";\n    @State() initialized = false;\n\n    overlay: HTMLKsOverlayElement;\n    componentDidLoad() {\n        this.overlay = this.root.querySelector(\"ks-overlay\");\n    }\n\n    show(event: Event) {\n        event.preventDefault();\n        this.overlay.show();\n        this.initialized = true;\n    }\n\n    hide(event: Event) {\n        event?.preventDefault();\n        this.overlay.hide();\n    }\n\n    @State() valid: boolean = true;\n\n    @Method()\n    async Validate() {\n        this.valid = this.code != \"\";\n    }\n\n    @Method()\n    async IsValid() {\n        return this.valid;\n    }\n\n    @Method()\n    async select(point: string) {\n        this.code = point;\n        this.Validate();\n        this.hide(null);\n\n        let formData = new FormData();\n            formData.append(\"rodzaj\", \"wysylka_dpdpickup\");\n            formData.append(\"koszyk\", \"0\");\n            formData.append(\"value\", point);\n            formData.append(\"punktodbioru\", point);\n        \n        var headers = new Headers();\n            headers.append('pragma', 'no-cache');\n            headers.append('cache-control', 'no-cache');\n        \n        fetch(this.api, {\n            method: 'POST', \n            headers: headers, \n            body: formData,\n            credentials: \"same-origin\"\n        });\n    }\n\n    render() {\n        return [\n            this.code ? <p>{this.pointMessage}: {this.code}</p> : null,\n            this.valid === false ? <p class=\"missing\">{this.missingMessage}</p> : null,\n\n            <ks-button round icon=\"map-pin\" onClick={(e)=>this.show(e)} name={this.button}/>,\n                    \n            <input type=\"hidden\" name=\"lokalizacjaRuch\" value={this.code}/>,\n            <input type=\"hidden\" name=\"ShippingDestinationCode\" value={this.code}/>,\n\n            <ks-overlay>\n                <div class=\"content\">\n                    <div class=\"topBar\">\n                        <ks-img2 src=\"res/cart/dpd.svg\" vertical height={100} width={300}/>\n                        <ks-button icon=\"x\" onClick={(e)=>this.hide(e)} />\n                    </div>\n                    \n                    {this.initialized ? [\n                        <script id=\"dpd-widget\" type=\"text/javascript\" innerHTML=\"\n                            function pointSelected(pointID){\n                                document.querySelector('ks-order-dpd').select(pointID);\n                            }\n                        \"></script>,\n                        <script type=\"text/javascript\" src=\"//pudofinder.dpd.com.pl/source/dpd_widget.js?key=a9b08eb6c1b218b975529f9cea0e1364\"></script>\n                    ] : null}\n                </div>\n            </ks-overlay>\n        ];\n    }\n}"],"mappings":"sDAAA,MAAMA,EAAc,uc,MCMPC,EAAQ,M,kCAEK,G,YACG,G,kBACM,G,oBACE,G,iBACH,G,UAEN,G,iBACD,M,WAkBG,I,CAf1BC,mBACIC,KAAKC,QAAUD,KAAKE,KAAKC,cAAc,a,CAG3CC,KAAKC,GACDA,EAAMC,iBACNN,KAAKC,QAAQG,OACbJ,KAAKO,YAAc,I,CAGvBC,KAAKH,GACDA,IAAK,MAALA,SAAK,SAALA,EAAOC,iBACPN,KAAKC,QAAQO,M,CAMjBC,iBACIT,KAAKU,MAAQV,KAAKW,MAAQ,E,CAI9BF,gBACI,OAAOT,KAAKU,K,CAIhBD,aAAaG,GACTZ,KAAKW,KAAOC,EACZZ,KAAKa,WACLb,KAAKQ,KAAK,MAEV,IAAIM,EAAW,IAAIC,SACfD,EAASE,OAAO,SAAU,qBAC1BF,EAASE,OAAO,SAAU,KAC1BF,EAASE,OAAO,QAASJ,GACzBE,EAASE,OAAO,eAAgBJ,GAEpC,IAAIK,EAAU,IAAIC,QACdD,EAAQD,OAAO,SAAU,YACzBC,EAAQD,OAAO,gBAAiB,YAEpCG,MAAMnB,KAAKoB,IAAK,CACZC,OAAQ,OACRJ,QAASA,EACTK,KAAMR,EACNS,YAAa,e,CAIrBC,SACI,MAAO,CACHxB,KAAKW,KAAOc,EAAA,SAAIzB,KAAK0B,aAAY,KAAI1B,KAAKW,MAAY,KACtDX,KAAKU,QAAU,MAAQe,EAAA,KAAGE,MAAM,WAAW3B,KAAK4B,gBAAsB,KAEtEH,EAAA,aAAWI,MAAK,KAACC,KAAK,UAAUC,QAAUC,GAAIhC,KAAKI,KAAK4B,GAAIC,KAAMjC,KAAKkC,SAEvET,EAAA,SAAOU,KAAK,SAASF,KAAK,kBAAkBG,MAAOpC,KAAKW,OACxDc,EAAA,SAAOU,KAAK,SAASF,KAAK,0BAA0BG,MAAOpC,KAAKW,OAEhEc,EAAA,kBACIA,EAAA,OAAKE,MAAM,WACPF,EAAA,OAAKE,MAAM,UACPF,EAAA,WAASY,IAAI,mBAAmBC,SAAQ,KAACC,OAAQ,IAAKC,MAAO,MAC7Df,EAAA,aAAWK,KAAK,IAAIC,QAAUC,GAAIhC,KAAKQ,KAAKwB,MAG/ChC,KAAKO,YAAc,CAChBkB,EAAA,UAAQgB,GAAG,aAAaN,KAAK,kBAAkBO,UAAU,qNAKzDjB,EAAA,UAAQU,KAAK,kBAAkBE,IAAI,uFACnC,O"}
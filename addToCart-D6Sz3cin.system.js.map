{"version":3,"file":"addToCart-D6Sz3cin.system.js","sources":["src/global/functions/addToCart.ts"],"sourcesContent":["import { commonDynamic } from \"../data/commonDynamic\";\nimport { ProductShortData } from \"../data/product\";\nimport Fetch from \"./fetch\";\nimport { DataLayer } from \"../dataLayer\";\n\nexport async function addToCart(product: ProductShortData, place = 1) {\n    const errorpopup = document.querySelector('ks-error-popup') as HTMLKsErrorPopupElement;\n    const messagepopup = document.querySelector('ks-message-popup') as HTMLKsMessagePopupElement;\n    const navbar = document.querySelector('ks-navbar') as HTMLKsNavbarElement;\n\n    let body = new FormData();\n    body.append(\"id\", product.id);\n    body.append(\"ilosc\", product.quantity.toString());\n    body.append(\"nazwa\", product.name);\n    body.append(\"value\", product.currentPrice.toString());\n    body.append(\"cechy\", product.traitIDs);\n    body.append(\"akcja\", 'dodaj');\n    body.append(\"miejsce\", place.toString());\n\n    const api = commonDynamic.get('api').addToCart;\n    return Fetch(api, body)\n        .then(async data => data.json())\n        .then(async data => {\n            if(!data.status) {\n                if(data.productLink)\n                    messagepopup.show(\"Wymagany wybór cechy\", data.message, \"Przejdź do produktu\", product.link);\n                else messagepopup.show(\"Błąd dodawania produktu\", data.message);\n                return;\n            }\n    \n            navbar.IncrementCart(product.quantity.toString());\n            OpenSuggestions(product.id, product.name);\n\n            DataLayer.addToCart(product, data.event);\n        })\n        .catch(error => {\n            errorpopup.show(error);\n        });\n};\n\nfunction OpenSuggestions(id: string, name: string) {\n    const suggestions = document.querySelector(\"ks-product-suggestions\");\n    suggestions.show(id, name);\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;YAKO,eAAe,SAAS,CAAC,OAAyB,EAAE,KAAK,GAAG,CAAC,EAAA;gBAChE,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,gBAAgB,CAA4B;gBACtF,MAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,kBAAkB,CAA8B;gBAC5F,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAwB;YAEzE,IAAA,IAAI,IAAI,GAAG,IAAI,QAAQ,EAAE;gBACzB,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,EAAE,CAAC;YAC7B,IAAA,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;gBACjD,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,IAAI,CAAC;YAClC,IAAA,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC;gBACrD,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC;YACtC,IAAA,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC;gBAC7B,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,KAAK,CAAC,QAAQ,EAAE,CAAC;gBAExC,MAAM,GAAG,GAAG,aAAa,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,SAAS;YAC9C,IAAA,OAAO,KAAK,CAAC,GAAG,EAAE,IAAI;qBACjB,IAAI,CAAC,OAAM,IAAI,KAAI,IAAI,CAAC,IAAI,EAAE;YAC9B,SAAA,IAAI,CAAC,OAAM,IAAI,KAAG;YACf,QAAA,IAAG,CAAC,IAAI,CAAC,MAAM,EAAE;wBACb,IAAG,IAAI,CAAC,WAAW;YACf,gBAAA,YAAY,CAAC,IAAI,CAAC,sBAAsB,EAAE,IAAI,CAAC,OAAO,EAAE,qBAAqB,EAAE,OAAO,CAAC,IAAI,CAAC;;4BAC3F,YAAY,CAAC,IAAI,CAAC,yBAAyB,EAAE,IAAI,CAAC,OAAO,CAAC;wBAC/D;;oBAGJ,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;oBACjD,eAAe,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,IAAI,CAAC;oBAEzC,SAAS,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC;YAC5C,KAAC;qBACA,KAAK,CAAC,KAAK,IAAG;YACX,QAAA,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC;YAC1B,KAAC,CAAC;YACV;YAEA,SAAS,eAAe,CAAC,EAAU,EAAE,IAAY,EAAA;gBAC7C,MAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,wBAAwB,CAAC;YACpE,IAAA,WAAW,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC;YAC9B;;;;;;;;"}
{"version":3,"names":["InputSelectDynamic","constructor","hostRef","this","apiData","lightUp","data","Array","loading","message","FetchData","strings","common","get","headers","Headers","append","fetch","api","method","credentials","then","response","ok","status","json","catch","error","Number","isInteger","inputConnectionError","navigator","onLine","inputInternetConnectionError","Validate","IsValid","componentWillLoad","Decode","input","doc","DOMParser","parseFromString","documentElement","textContent","render","h","key","class","name","label","map","item","selected","selectedId","value","style","top","left","width","height","backgroundColor","onClick","inputRefresh"],"sources":["src/components/input/inputSelectDynamic.tsx"],"sourcesContent":["import { Component, h, Prop, State, Watch, Method } from '@stencil/core';\nimport { common } from '../../global/data/common';\n\n\ninterface SelectOption {\n    name: string;\n    value: string;\n}\n\n\n@Component({\n      tag: 'ks-input-select-dynamic'\n})\nexport class InputSelectDynamic {\n\n    @Prop() name: string;\n    @Prop() label: string;\n\n    @Prop() api: string;\n    @Prop({mutable: true, reflect: true}) apiData = \"\";\n    @Prop() selectedId: string;\n\n    @Prop({mutable: true}) lightUp: boolean = false;\n\n    @State() data = new Array<SelectOption>();\n\n    @State() loading: boolean = false;\n    @State() message: string = \"\";\n\n    @Watch('apiData')\n    async FetchData() {\n        const strings = common.get(\"translations\");\n\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        this.loading = true;\n        this.message = \"\";\n        await fetch(this.api + this.apiData, {\n            method: 'GET',\n            headers: headers,\n            credentials: \"same-origin\"\n        })\n            .then(response => {\n                if(!response.ok)\n                    throw response.status;\n\n                return response.json()\n            })\n            .then(data => {\n                this.data = data;\n            })\n            .catch(error => {\n                let message = error;\n\n                if(Number.isInteger(error))\n                    message = strings.inputConnectionError + error;\n\n                else if(!navigator.onLine)\n                    message = strings.inputInternetConnectionError;\n\n                this.message = message;\n            });\n    \n        this.loading = false;\n    }\n\n    @Method()\n    async Validate() {\n        this.lightUp = false;\n    }\n\n    @Method()\n    async IsValid() {\n        return !this.loading && this.message == \"\";\n    }\n\n    componentWillLoad() {\n        this.FetchData();\n    }\n\n    Decode(input) {\n        var doc = new DOMParser().parseFromString(input, \"text/html\");\n        return doc.documentElement.textContent;\n    }\n\n\trender() {            \n        const strings = common.get(\"translations\");\n\n        return(\n            <div class=\"uk-position-relative\">\n                <ks-input-select name={this.name} label={this.label} error={this.message != \"\"} light-up={this.lightUp}>\n                    {this.data.map( (item: SelectOption)=>\n                        <option selected={this.selectedId == item.value ? true : false} value={item.value}>{this.Decode(item.name)}</option>\n                    )}\n                </ks-input-select>\n\n                {this.loading ?\n                    <div class=\"uk-position-absolute uk-animation-fade\"\n                         style={{top: \"20px\", left: \"0px\", width: \"100%\", height: \"50px\", backgroundColor: \"rgba(255, 255, 255, 0.7)\"}}>\n\n                        <div uk-spinner class=\"uk-position-center\"></div>\n                    </div>\n                : null}\n\n                {this.message != \"\" ?\n                    <div class=\"uk-position-absolute\"\n                         style={{top: \"20px\", left: \"0px\", width: \"100%\", height: \"50px\", backgroundColor: \"rgba(255, 255, 255)\"}}>\n\n                        <p class=\"uk-position-center uk-text-danger\">\n                            {this.message} <a onClick={()=>this.FetchData()}>{strings.inputRefresh}</a>\n                        </p>\n                        \n                    </div>\n                : null}\n            </div>\n        );\n    }\n}\n"],"mappings":"0HAaaA,EAAkB,MAH/B,WAAAC,CAAAC,G,UAS0CC,KAAOC,QAAG,GAGzBD,KAAOE,QAAY,MAEjCF,KAAAG,KAAO,IAAIC,MAEXJ,KAAOK,QAAY,MACnBL,KAAOM,QAAW,EA4F9B,CAzFG,eAAMC,GACF,MAAMC,EAAUC,EAAOC,IAAI,gBAE3B,IAAIC,EAAU,IAAIC,QAClBD,EAAQE,OAAO,SAAU,YACzBF,EAAQE,OAAO,gBAAiB,YAEhCb,KAAKK,QAAU,KACfL,KAAKM,QAAU,SACTQ,MAAMd,KAAKe,IAAMf,KAAKC,QAAS,CACjCe,OAAQ,MACRL,QAASA,EACTM,YAAa,gBAEZC,MAAKC,IACF,IAAIA,EAASC,GACT,MAAMD,EAASE,OAEnB,OAAOF,EAASG,MAAM,IAEzBJ,MAAKf,IACFH,KAAKG,KAAOA,CAAI,IAEnBoB,OAAMC,IACH,IAAIlB,EAAUkB,EAEd,GAAGC,OAAOC,UAAUF,GAChBlB,EAAUE,EAAQmB,qBAAuBH,OAExC,IAAII,UAAUC,OACfvB,EAAUE,EAAQsB,6BAEtB9B,KAAKM,QAAUA,CAAO,IAG9BN,KAAKK,QAAU,K,CAInB,cAAM0B,GACF/B,KAAKE,QAAU,K,CAInB,aAAM8B,GACF,OAAQhC,KAAKK,SAAWL,KAAKM,SAAW,E,CAG5C,iBAAA2B,GACIjC,KAAKO,W,CAGT,MAAA2B,CAAOC,GACH,IAAIC,GAAM,IAAIC,WAAYC,gBAAgBH,EAAO,aACjD,OAAOC,EAAIG,gBAAgBC,W,CAGlC,MAAAC,GACO,MAAMjC,EAAUC,EAAOC,IAAI,gBAE3B,OACIgC,EAAA,OAAAC,IAAA,2CAAKC,MAAM,wBACPF,EAAA,mBAAAC,IAAA,2CAAiBE,KAAM7C,KAAK6C,KAAMC,MAAO9C,KAAK8C,MAAOtB,MAAOxB,KAAKM,SAAW,GAAE,WAAYN,KAAKE,SAC1FF,KAAKG,KAAK4C,KAAMC,GACbN,EAAQ,UAAAO,SAAUjD,KAAKkD,YAAcF,EAAKG,MAAQ,KAAO,MAAOA,MAAOH,EAAKG,OAAQnD,KAAKkC,OAAOc,EAAKH,UAI5G7C,KAAKK,QACFqC,EAAK,OAAAE,MAAM,yCACNQ,MAAO,CAACC,IAAK,OAAQC,KAAM,MAAOC,MAAO,OAAQC,OAAQ,OAAQC,gBAAiB,6BAEnFf,EAAA,yBAAgBE,MAAM,wBAE5B,KAED5C,KAAKM,SAAW,GACboC,EAAK,OAAAE,MAAM,uBACNQ,MAAO,CAACC,IAAK,OAAQC,KAAM,MAAOC,MAAO,OAAQC,OAAQ,OAAQC,gBAAiB,wBAEnFf,EAAG,KAAAE,MAAM,qCACJ5C,KAAKM,QAAO,IAAEoC,EAAA,KAAGgB,QAAS,IAAI1D,KAAKO,aAAcC,EAAQmD,gBAIpE,K","ignoreList":[]}
{"version":3,"names":["inputDynamicCss","InputDynamic","exports","class_1","hostRef","this","api","message","loading","prototype","componentDidLoad","_this","input","root","querySelector","component","setAttribute","onchange","Validate","strings","common","get","headers","Headers","append","ready","Promise","resolve","__awaiter","_a","sent","IsValid","fetch","value","method","credentials","then","response","ok","status","text","data","catch","error","Number","isInteger","inputConnectionError","navigator","onLine","inputInternetConnectionError","render","h","Host","key","class","dark"],"sources":["src/components/input/inputDynamic.css?tag=ks-input-dynamic","src/components/input/inputDynamic.tsx"],"sourcesContent":["ks-input-dynamic {\n    display: block;\n    position: relative;\n}\n\nks-input-dynamic .wrapper {\n    transition: 0.3s ease opacity;\n}\n\nks-input-dynamic[loading] .wrapper {\n    opacity: 0.3;\n    pointer-events: none;\n}","import { Component, h, Prop, Element, Method, Host } from '@stencil/core';\nimport { common } from '../../global/data/common';\n\n\n@Component({\n    tag: 'ks-input-dynamic',\n    styleUrl: 'inputDynamic.css'\n})\nexport class InputDynamic {\n    @Element() root: HTMLElement;\n\n    @Prop() api: string = \"\";\n    @Prop() message: string = \"\";\n    @Prop({mutable: true, reflect: true}) loading: boolean = false;\n\n    ready: Promise<boolean>;\n\n    componentDidLoad() { \n        const input = this.root.querySelector(\"input\") as HTMLInputElement;\n        const component = this.root.querySelector(\"ks-input-text\") as HTMLKsInputTextElement;\n        component.setAttribute(\"novalidate\", \"novalidate\");\n\n        input.onchange = ()=>this.Validate();\n    }\n\n    @Method()\n    async Validate() {\n        const strings = common.get(\"translations\");\n\n        const input = this.root.querySelector(\"input\") as HTMLInputElement;\n        const component = this.root.querySelector(\"ks-input-text\") as HTMLKsInputTextElement;\n\n        var headers = new Headers();\n        headers.append('pragma', 'no-cache');\n        headers.append('cache-control', 'no-cache');\n\n        this.ready = new Promise<boolean>(async (resolve)=>{\n            await component.Validate()\n            if(await component.IsValid()) {\n                this.loading = true;\n\n                await fetch(this.api + input.value, {\n                    method: 'GET', \n                    headers: headers,\n                    credentials: \"same-origin\"\n                })\n                    .then(response => {\n                        if(!response.ok)\n                            throw response.status;\n\n                        return response.text();\n                    })\n                    .then(data => {\n                        if (data == \"false\")\n                            throw this.message;\n\n                        else if (data != \"true\")\n                            throw data;\n\n                        else resolve(true);\n                    })\n                    .catch(error => {\n                        let message = error;\n\n                        if(Number.isInteger(error))\n                            message = strings.inputConnectionError + error;\n\n                        else if(!navigator.onLine)\n                            message = strings.inputInternetConnectionError;\n                        \n                        component.setAttribute(\"message\", message);\n                        resolve(false);\n                    });\n            }\n            else resolve(false);\n\n            this.loading = false;\n        });\n    }\n\n    @Method()\n    async IsValid() {\n        return await this.ready;\n    }\n\n\trender() {\n\t\treturn <Host>\n            <div class=\"wrapper\">\n                <slot />\n            </div>\n            {this.loading && <ks-loader dark />}\n        </Host>;\n    }\n}\n"],"mappings":"isDAAA,IAAMA,EAAkB,mN,ICQXC,EAAYC,EAAA,8BAJzB,SAAAC,EAAAC,G,UAOYC,KAAGC,IAAW,GACdD,KAAOE,QAAW,GACYF,KAAOG,QAAY,KAgF5D,CA5EGL,EAAAM,UAAAC,iBAAA,eAAAC,EAAAN,KACI,IAAMO,EAAQP,KAAKQ,KAAKC,cAAc,SACtC,IAAMC,EAAYV,KAAKQ,KAAKC,cAAc,iBAC1CC,EAAUC,aAAa,aAAc,cAErCJ,EAAMK,SAAW,WAAI,OAAAN,EAAKO,UAAL,C,EAInBf,EAAAM,UAAAS,SAAN,W,4GACUC,EAAUC,EAAOC,IAAI,gBAErBT,EAAQP,KAAKQ,KAAKC,cAAc,SAChCC,EAAYV,KAAKQ,KAAKC,cAAc,iBAEtCQ,EAAU,IAAIC,QAClBD,EAAQE,OAAO,SAAU,YACzBF,EAAQE,OAAO,gBAAiB,YAEhCnB,KAAKoB,MAAQ,IAAIC,SAAiB,SAAOC,GAAO,OAAAC,UAAAjB,OAAA,qB,uEAC5C,SAAMI,EAAUG,Y,OAAhBW,EAAAC,OACG,SAAMf,EAAUgB,W,WAAhBF,EAAAC,OAAA,YACCzB,KAAKG,QAAU,KAEf,SAAMwB,MAAM3B,KAAKC,IAAMM,EAAMqB,MAAO,CAChCC,OAAQ,MACRZ,QAASA,EACTa,YAAa,gBAEZC,MAAK,SAAAC,GACF,IAAIA,EAASC,GACT,MAAMD,EAASE,OAEnB,OAAOF,EAASG,MACpB,IACCJ,MAAK,SAAAK,GACF,GAAIA,GAAQ,QACR,MAAM9B,EAAKJ,aAEV,GAAIkC,GAAQ,OACb,MAAMA,OAELd,EAAQ,KACjB,IACCe,OAAM,SAAAC,GACH,IAAIpC,EAAUoC,EAEd,GAAGC,OAAOC,UAAUF,GAChBpC,EAAUY,EAAQ2B,qBAAuBH,OAExC,IAAII,UAAUC,OACfzC,EAAUY,EAAQ8B,6BAEtBlC,EAAUC,aAAa,UAAWT,GAClCoB,EAAQ,MACZ,K,OA/BJE,EAAAC,O,mBAiCCH,EAAQ,O,iBAEbtB,KAAKG,QAAU,M,qCAKjBL,EAAAM,UAAAsB,QAAN,W,4GACW,SAAM1B,KAAKoB,O,OAAlB,SAAOI,EAAAC,Q,QAGd3B,EAAAM,UAAAyC,OAAA,WACC,OAAOC,EAACC,EAAI,CAAAC,IAAA,4CACFF,EAAK,OAAAE,IAAA,2CAAAC,MAAM,WACPH,EAAA,QAAAE,IAAA,8CAEHhD,KAAKG,SAAW2C,EAAA,aAAAE,IAAA,2CAAWE,KAAI,O,yHAlFnB,I","ignoreList":[]}
{"version":3,"names":["async","addToCart","product","place","errorpopup","document","querySelector","messagepopup","navbar","body","FormData","append","id","quantity","toString","name","currentPrice","traitIDs","api","commonDynamic","get","Fetch","then","data","json","status","productLink","show","message","link","IncrementCart","OpenSuggestions","DataLayer","event","catch","error","suggestions"],"sources":["src/global/functions/addToCart.ts"],"sourcesContent":["import { commonDynamic } from \"../data/commonDynamic\";\nimport { ProductShortData } from \"../data/product\";\nimport Fetch from \"./fetch\";\nimport { DataLayer } from \"../dataLayer\";\n\nexport async function addToCart(product: ProductShortData, place = 1) {\n    const errorpopup = document.querySelector('ks-error-popup') as HTMLKsErrorPopupElement;\n    const messagepopup = document.querySelector('ks-message-popup') as HTMLKsMessagePopupElement;\n    const navbar = document.querySelector('ks-navbar') as HTMLKsNavbarElement;\n\n    let body = new FormData();\n    body.append(\"id\", product.id);\n    body.append(\"ilosc\", product.quantity.toString());\n    body.append(\"nazwa\", product.name);\n    body.append(\"value\", product.currentPrice.toString());\n    body.append(\"cechy\", product.traitIDs);\n    body.append(\"akcja\", 'dodaj');\n    body.append(\"miejsce\", place.toString());\n\n    const api = commonDynamic.get('api').addToCart;\n    return Fetch(api, body)\n        .then(async data => data.json())\n        .then(async data => {\n            if(!data.status) {\n                if(data.productLink)\n                    messagepopup.show(\"Wymagany wybór cechy\", data.message, \"Przejdź do produktu\", product.link);\n                else messagepopup.show(\"Błąd dodawania produktu\", data.message);\n                return;\n            }\n    \n            navbar.IncrementCart(product.quantity.toString());\n            OpenSuggestions(product.id, product.name);\n\n            DataLayer.addToCart(product, data.event);\n        })\n        .catch(error => {\n            errorpopup.show(error);\n        });\n};\n\nfunction OpenSuggestions(id: string, name: string) {\n    const suggestions = document.querySelector(\"ks-product-suggestions\");\n    suggestions.show(id, name);\n}"],"mappings":"oIAKOA,eAAeC,EAAUC,EAA2BC,EAAQ,GAC/D,MAAMC,EAAaC,SAASC,cAAc,kBAC1C,MAAMC,EAAeF,SAASC,cAAc,oBAC5C,MAAME,EAASH,SAASC,cAAc,aAEtC,IAAIG,EAAO,IAAIC,SACfD,EAAKE,OAAO,KAAMT,EAAQU,IAC1BH,EAAKE,OAAO,QAAST,EAAQW,SAASC,YACtCL,EAAKE,OAAO,QAAST,EAAQa,MAC7BN,EAAKE,OAAO,QAAST,EAAQc,aAAaF,YAC1CL,EAAKE,OAAO,QAAST,EAAQe,UAC7BR,EAAKE,OAAO,QAAS,SACrBF,EAAKE,OAAO,UAAWR,EAAMW,YAE7B,MAAMI,EAAMC,EAAcC,IAAI,OAAOnB,UACrC,OAAOoB,EAAMH,EAAKT,GACba,MAAKtB,MAAMuB,GAAQA,EAAKC,SACxBF,MAAKtB,MAAMuB,IACR,IAAIA,EAAKE,OAAQ,CACb,GAAGF,EAAKG,YACJnB,EAAaoB,KAAK,uBAAwBJ,EAAKK,QAAS,sBAAuB1B,EAAQ2B,WACtFtB,EAAaoB,KAAK,0BAA2BJ,EAAKK,SACvD,M,CAGJpB,EAAOsB,cAAc5B,EAAQW,SAASC,YACtCiB,EAAgB7B,EAAQU,GAAIV,EAAQa,MAEpCiB,EAAU/B,UAAUC,EAASqB,EAAKU,MAAM,IAE3CC,OAAMC,IACH/B,EAAWuB,KAAKQ,EAAM,GAElC,CAEA,SAASJ,EAAgBnB,EAAYG,GACjC,MAAMqB,EAAc/B,SAASC,cAAc,0BAC3C8B,EAAYT,KAAKf,EAAIG,EACzB,Q"}
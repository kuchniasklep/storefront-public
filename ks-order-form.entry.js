import{r as e,h as t,a as o}from"./index-0TTgkKkd.js";import{D as i}from"./dataLayer-BtunD6i_.js";import"./commonDynamic-uutiB2IM.js";import"./index-CZU_OQRD.js";import"./fetch-Cj4w559p.js";const n="ks-order-form .formsubmit>*{font-size:20px;font-weight:700;font-family:var(--font-emphasis)}ks-order-form .formsubmit{margin:20px}";const s=class{constructor(t){e(this,t);this.loading=false}render(){return t("form",{key:"73382364d8a9b630cf7a985008a5561e98e4eb76",action:this.action,method:this.method,enctype:"application/x-www-form-urlencoded",onSubmit:e=>this.Submit(e)},t("slot",{key:"b21d9dc83e2d4c17c8c872e469e50d7e517fae69"}),t("ks-button",{key:"db2947ed155403d602604f37a080d392831379b7",rounded:true,submit:true,secondary:true,name:this.button,loading:this.loading,tall:true,class:"formsubmit"}),t("ks-order-form-modal",{key:"9946e6b285d9842a56dfb274f9bb81ff3e811343",back:this.back}))}async Submit(e){e.preventDefault();const t=this.root.querySelector("form");const o=t.querySelectorAll("ks-input-dynamic, ks-input-select, ks-input-text, ks-input-check");let i=Number.MAX_VALUE;let n=true;for(let e=0;e<o.length;e++){const t=o[e];if(t.closest("ks-input-dynamic *")!=null)continue;if(t.closest("ks-order-check-section:not([active])")!=null)continue;if(t.closest("ks-order-enable-section:not([active])")!=null)continue;if(t.closest("*[hidden]")!=null)continue;await t.Validate();if(!await t.IsValid()){const e=t.getBoundingClientRect().top-document.body.getBoundingClientRect().top;if(e<i)i=e;n=false}}if(n){const e=new Array;for(let o=0;o<t.elements.length;o++){const i=t.elements[o];if(i.nodeName==="INPUT"&&i.type!="submit"&&i.name!=""){if((i.type=="checkbox"||i.type=="radio")&&!i.checked)continue;e.push(`${i.name}=${encodeURIComponent(i.value.toString())}`)}else if(i.nodeName==="SELECT"&&i.name!=""){e.push(`${i.name}=${encodeURIComponent(i.value.toString())}`)}}const o=new FormData;o.append("data",e.join("&"));this.loading=true;var s=new Headers;s.append("pragma","no-cache");s.append("cache-control","no-cache");await fetch(this.action,{body:o,method:"POST",headers:s,credentials:"same-origin"}).then((e=>{if(!e.ok)throw e.status;else{const e=t.querySelector("input[type=email]");const o=t.querySelector("input[name=biuletyn]");this.track(e?.value,o?.checked);window.location.href=this.destination}})).catch((e=>{let t=e;console.log(e);if(!navigator.onLine)t="Brak połączenia z internetem.";else if(Number.isInteger(e))t=`Błąd połączenia - ${e}`;this.ShowPrompt(t)}));this.loading=false}else{if("scrollBehavior"in document.documentElement.style)window.scroll({top:i-100,behavior:"smooth"});else window.scroll(0,i-100)}}track(e="",t=false){if(!e||!t)return;const o={email:e,subscriber:true,place:"Zapis do newslettera | Rejestracja Zamówienie"};i.subscribe(o)}ShowPrompt(e){const t=this.root.querySelector("ks-order-form-modal");t.Show(e)}get root(){return o(this)}};s.style=n;export{s as ks_order_form};
//# sourceMappingURL=ks-order-form.entry.js.map
import{r as e,h as t,a as i}from"./index-0TTgkKkd.js";import{D as o}from"./dataLayer-BtunD6i_.js";import"./commonDynamic-uutiB2IM.js";import"./index-CZU_OQRD.js";import"./fetch-Cj4w559p.js";const n=class{constructor(t){e(this,t);this.loading=false}render(){return t("form",{key:"dab4c93e084541c784a0e996457590749e01579d",action:this.action,method:this.method,enctype:"application/x-www-form-urlencoded",onSubmit:e=>this.Submit(e)},t("slot",{key:"5e85c6d1783c7051d010ec541f907e06d4e0988b"}),t("div",{key:"24fecb7a5d1daf33410d37e40f0dfd0ff042de5b",class:"uk-position-relative uk-margin-medium-top"},t("button",{key:"d0f501d20799065aaac3cf9bbb86759ba727d002",type:"submit",formnovalidate:true,class:"uk-button uk-button-danger uk-width-1-1 ks-text-decorated",style:{padding:"20px",fontSize:"28px",fontWeight:"700"}},t("span",{key:"aa82537586a1b4dc08e826c5864b321958e2cf9d"},this.button)),this.loading?t("div",{class:"uk-overlay uk-light uk-padding-remove uk-position-cover uk-animation-fade",style:{animationDuration:"0.3s",backgroundColor:"#e21334"}},t("div",{"uk-spinner":"ratio: 1.5",class:"uk-position-center"})):null),t("ks-order-form-modal",{key:"d3ac031dc2a28fe4a972ef1d26823a2819ce012e",back:this.back}))}async Submit(e){e.preventDefault();const t=this.root.querySelector("form");const i=t.querySelectorAll("ks-input-dynamic, ks-input-select-dynamic, ks-input-select, ks-input-text, ks-input-check");let o=Number.MAX_VALUE;let n=true;for(let e=0;e<i.length;e++){const t=i[e];if(t.closest("ks-input-dynamic *")!=null)continue;if(t.closest("ks-order-check-section:not([active])")!=null)continue;if(t.closest("ks-order-enable-section:not([active])")!=null)continue;if(t.closest("*[hidden]")!=null)continue;await t.Validate();if(!await t.IsValid()){const e=t.getBoundingClientRect().top-document.body.getBoundingClientRect().top;if(e<o)o=e;n=false}}if(n){const e=new Array;for(let i=0;i<t.elements.length;i++){const o=t.elements[i];if(o.nodeName==="INPUT"&&o.type!="submit"&&o.name!=""){if((o.type=="checkbox"||o.type=="radio")&&!o.checked)continue;e.push(`${o.name}=${encodeURIComponent(o.value.toString())}`)}else if(o.nodeName==="SELECT"&&o.name!=""){e.push(`${o.name}=${encodeURIComponent(o.value.toString())}`)}}const i=new FormData;i.append("data",e.join("&"));this.loading=true;var a=new Headers;a.append("pragma","no-cache");a.append("cache-control","no-cache");await fetch(this.action,{body:i,method:"POST",headers:a,credentials:"same-origin"}).then((e=>{if(!e.ok)throw e.status;else{const e=t.querySelector("input[type=email]");const i=t.querySelector("input[name=biuletyn]");this.track(e?.value,i?.checked);window.location.href=this.destination}})).catch((e=>{let t=e;console.log(e);if(!navigator.onLine)t="Brak połączenia z internetem.";else if(Number.isInteger(e))t=`Błąd połączenia - ${e}`;this.ShowPrompt(t)}));this.loading=false}else{if("scrollBehavior"in document.documentElement.style)window.scroll({top:o-100,behavior:"smooth"});else window.scroll(0,o-100)}}track(e="",t=false){if(!e||!t)return;const i={email:e,subscriber:true,place:"Zapis do newslettera | Rejestracja Zamówienie"};o.subscribe(i)}ShowPrompt(e){const t=this.root.querySelector("ks-order-form-modal");t.setAttribute("message",e);t.Show()}get root(){return i(this)}};export{n as ks_order_form};
//# sourceMappingURL=ks-order-form.entry.js.map
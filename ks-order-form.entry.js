import{r as t,h as o,c as e}from"./index-ca9b706f.js";import{D as i}from"./dataLayer-452698da.js";import"./commonDynamic-5e51121d.js";import"./index-9843a78d.js";import"./fetch-1f8a9006.js";const n=class{constructor(o){t(this,o),this.action=void 0,this.method=void 0,this.destination=void 0,this.button=void 0,this.back=void 0,this.loading=!1}render(){return o("form",{action:this.action,method:this.method,enctype:"application/x-www-form-urlencoded",onSubmit:t=>this.Submit(t)},o("slot",null),o("div",{class:"uk-position-relative uk-margin-medium-top"},o("button",{type:"submit",formnovalidate:!0,class:"uk-button uk-button-danger uk-width-1-1 ks-text-decorated",style:{padding:"20px",fontSize:"28px",fontWeight:"700"}},o("span",null,this.button)),this.loading?o("div",{class:"uk-overlay uk-light uk-padding-remove uk-position-cover uk-animation-fade",style:{animationDuration:"0.3s",backgroundColor:"#e21334"}},o("div",{"uk-spinner":"ratio: 1.5",class:"uk-position-center"})):null),o("ks-order-form-modal",{back:this.back}))}async Submit(t){t.preventDefault();const o=this.root.querySelector("form"),e=o.querySelectorAll("ks-input-dynamic, ks-input-select-dynamic, ks-input-select, ks-input-text, ks-input-check");let i=Number.MAX_VALUE,n=!0;for(let a=0;a<e.length;a++){const t=e[a];if(null==t.closest("ks-input-dynamic *")&&null==t.closest("ks-order-check-section:not([active])")&&null==t.closest("ks-order-enable-section:not([active])")&&null==t.closest("*[hidden]")&&(await t.Validate(),!(await t.IsValid()))){const o=t.getBoundingClientRect().top-document.body.getBoundingClientRect().top;o<i&&(i=o),n=!1}}if(n){const t=new Array;for(let i=0;i<o.elements.length;i++){const e=o.elements[i];if("INPUT"===e.nodeName&&"submit"!=e.type&&""!=e.name){if(("checkbox"==e.type||"radio"==e.type)&&!e.checked)continue;t.push(`${e.name}=${encodeURIComponent(e.value.toString())}`)}else"SELECT"===e.nodeName&&""!=e.name&&t.push(`${e.name}=${encodeURIComponent(e.value.toString())}`)}const e=new FormData;e.append("data",t.join("&")),this.loading=!0;var s=new Headers;s.append("pragma","no-cache"),s.append("cache-control","no-cache"),await fetch(this.action,{body:e,method:"POST",headers:s,credentials:"same-origin"}).then((t=>{if(!t.ok)throw t.status;{const t=o.querySelector("input[type=email]"),e=o.querySelector("input[name=biuletyn]");this.track(null==t?void 0:t.value,null==e?void 0:e.checked),window.location.href=this.destination}})).catch((t=>{let o=t;console.log(t),navigator.onLine?Number.isInteger(t)&&(o=`Błąd połączenia - ${t}`):o="Brak połączenia z internetem.",this.ShowPrompt(o)})),this.loading=!1}else"scrollBehavior"in document.documentElement.style?window.scroll({top:i-100,behavior:"smooth"}):window.scroll(0,i-100)}track(t="",o=!1){t&&o&&i.subscribe({email:t,subscriber:!0,place:"Zapis do newslettera | Rejestracja Zamówienie"})}ShowPrompt(t){const o=this.root.querySelector("ks-order-form-modal");o.setAttribute("message",t),o.Show()}get root(){return e(this)}};export{n as ks_order_form}
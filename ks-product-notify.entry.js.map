{"version":3,"names":["productNotifyCss","ProductNotify","requestHandler","event","strings","product","get","productId","api","commonDynamic","notifyAvailability","preventDefault","ValidateInput","this","root","querySelector","dialog","showLoading","target","data","FormData","append","fetch","body","method","then","async","response","json","containsData","Error","notifyErrorParagraph","status","showSuccess","heading","paragraph","showFailure","catch","error","message","window","navigator","onLine","noInternet","console","log","notifyErrorHeading","show","componentDidLoad","render","h","key","dark","onSubmit","e","class","notifyHeading","notifyParagraph","href","common","email","name","required","nomessage","placeholder","icon","checked","label","notifyBackorders","notifyAgreement","submit","notifyMe"],"sources":["src/components/product/product-notify.css?tag=ks-product-notify","src/components/product/product-notify.tsx"],"sourcesContent":["ks-product-notify {\n    display: block;\n}\n\nks-product-notify fieldset {\n    border: none;\n    margin: 0;\n    padding: 0;\n}\n\nks-product-notify .info {\n    text-align: center;\n    margin-bottom: 40px;\n}\n\nks-product-notify .info a {\n    text-decoration: none;\n    color: black;\n    margin: 0 5px;\n}\n\nks-product-notify h3 {\n    font-family: var(--font-emphasis);\n    font-size: 20px;\n    font-weight: 700;\n}\n\nks-product-notify ks-input-check {\n    margin-bottom: 5px;\n}\n\nks-product-notify ks-button {\n    margin-top: 20px;\n}","import { Component, h, Element, Method, State } from '@stencil/core';\nimport { product } from \"../../global/data/product\";\nimport { common } from \"../../global/data/common\";\nimport { commonDynamic } from \"../../global/data/commonDynamic\";\nimport ValidateInput from '../input/validate';\n\n@Component({\n    tag: 'ks-product-notify',\n    styleUrl: 'product-notify.css'\n})\nexport class ProductNotify {\n    @Element() root: HTMLElement;\n    dialog: HTMLKsDialogElement;\n\n    @State() resultHeading: string;\n    @State() resultParagraph: string;\n\n    async requestHandler(event: Event) {\n        const strings = product.get(\"strings\");\n        const productId = product.get(\"id\");\n        const api = commonDynamic.get(\"api\").notifyAvailability;\n\n        event.preventDefault();\n        if(!await ValidateInput(this.root.querySelector('form')))\n            return;\n\n        this.dialog.showLoading();\n\n        const target = event.target as HTMLFormElement;\n        const data = new FormData(target);\n        data.append(\"product\", productId);\n\n        await fetch(api, { body: data, method: \"post\"})\n        .then(async response => response.json())\n        .then(async data => {\n            const containsData = \"status\" in data && \"heading\" in data && \"paragraph\" in data;\n            if (!containsData) throw new Error(strings.notifyErrorParagraph);\n                \n            if(data.status == \"success\")\n                this.dialog.showSuccess(data.heading, data.paragraph);\n\n            else this.dialog.showFailure(data.heading, data.paragraph);\n        })\n        .catch(async error => {\n            let message = \"\";\n\n            if(!window.navigator.onLine)\n                message = strings.noInternet;\n\n            else if(error.message != \"\")\n                message = error.message;\n\n            console.log(error.message);\n            this.dialog.showFailure(strings.notifyErrorHeading, message);\n        });\n    }\n\n    @Method()\n    async show() {\n        this.dialog.show();\n    }\n\n    componentDidLoad() {\n        this.dialog = this.root.querySelector('ks-dialog');\n    }\n\n\trender() {\n        const strings = product.get(\"strings\");\n\n\t\treturn <ks-dialog dark>\n            <form onSubmit={e => this.requestHandler(e)}>\n                <fieldset>\n                    <div class=\"info\">\n                        <h3>{strings.notifyHeading}</h3>\n                        <p>{strings.notifyParagraph}</p>\n\n                        <a href={\"mailto:\" + common.get('email')}>{common.get('email')}</a> â€¢\n                        <a href={\"tel:\" + common.get('phone')}>{common.get('phone')}</a>\n                    </div>\n\n                    <ks-input-text email name=\"email\" required nomessage placeholder=\"E-mail\" icon=\"mail\"/>\n                    <ks-input-check checked name=\"backorders\" nomessage label={strings.notifyBackorders}></ks-input-check>\n\n                    <ks-input-check name=\"zgoda\" required nomessage label={strings.notifyAgreement}></ks-input-check>\n\n                    <ks-button submit name={strings.notifyMe} />\n                </fieldset>\n            </form>\n        </ks-dialog>;\n    }\n\n}\n"],"mappings":"gQAAA,MAAMA,EAAmB,sZ,MCUZC,EAAa,M,yBAOtB,oBAAMC,CAAeC,GACjB,MAAMC,EAAUC,EAAQC,IAAI,WAC5B,MAAMC,EAAYF,EAAQC,IAAI,MAC9B,MAAME,EAAMC,EAAcH,IAAI,OAAOI,mBAErCP,EAAMQ,iBACN,UAAUC,EAAcC,KAAKC,KAAKC,cAAc,SAC5C,OAEJF,KAAKG,OAAOC,cAEZ,MAAMC,EAASf,EAAMe,OACrB,MAAMC,EAAO,IAAIC,SAASF,GAC1BC,EAAKE,OAAO,UAAWd,SAEjBe,MAAMd,EAAK,CAAEe,KAAMJ,EAAMK,OAAQ,SACtCC,MAAKC,MAAMC,GAAYA,EAASC,SAChCH,MAAKC,MAAMP,IACR,MAAMU,EAAe,WAAYV,GAAQ,YAAaA,GAAQ,cAAeA,EAC7E,IAAKU,EAAc,MAAM,IAAIC,MAAM1B,EAAQ2B,sBAE3C,GAAGZ,EAAKa,QAAU,UACdnB,KAAKG,OAAOiB,YAAYd,EAAKe,QAASf,EAAKgB,gBAE1CtB,KAAKG,OAAOoB,YAAYjB,EAAKe,QAASf,EAAKgB,UAAU,IAE7DE,OAAMX,MAAMY,IACT,IAAIC,EAAU,GAEd,IAAIC,OAAOC,UAAUC,OACjBH,EAAUnC,EAAQuC,gBAEjB,GAAGL,EAAMC,SAAW,GACrBA,EAAUD,EAAMC,QAEpBK,QAAQC,IAAIP,EAAMC,SAClB1B,KAAKG,OAAOoB,YAAYhC,EAAQ0C,mBAAoBP,EAAQ,G,CAKpE,UAAMQ,GACFlC,KAAKG,OAAO+B,M,CAGhB,gBAAAC,GACInC,KAAKG,OAASH,KAAKC,KAAKC,cAAc,Y,CAG7C,MAAAkC,GACO,MAAM7C,EAAUC,EAAQC,IAAI,WAElC,OAAO4C,EAAA,aAAAC,IAAA,2CAAWC,KAAI,MACZF,EAAM,QAAAC,IAAA,2CAAAE,SAAUC,GAAKzC,KAAKX,eAAeoD,IACrCJ,EAAA,YAAAC,IAAA,4CACID,EAAK,OAAAC,IAAA,2CAAAI,MAAM,QACPL,EAAK,MAAAC,IAAA,4CAAA/C,EAAQoD,eACbN,EAAI,KAAAC,IAAA,4CAAA/C,EAAQqD,iBAEZP,EAAA,KAAAC,IAAA,2CAAGO,KAAM,UAAYC,EAAOrD,IAAI,UAAWqD,EAAOrD,IAAI,UAAa,KACnE4C,EAAA,KAAAC,IAAA,2CAAGO,KAAM,OAASC,EAAOrD,IAAI,UAAWqD,EAAOrD,IAAI,WAGvD4C,EAAA,iBAAAC,IAAA,2CAAeS,MAAM,KAAAC,KAAK,QAAQC,SAAQ,KAACC,UAAS,KAACC,YAAY,SAASC,KAAK,SAC/Ef,EAAA,kBAAAC,IAAA,2CAAgBe,QAAO,KAACL,KAAK,aAAaE,UAAS,KAACI,MAAO/D,EAAQgE,mBAEnElB,EAAA,kBAAAC,IAAA,2CAAgBU,KAAK,QAAQC,SAAQ,KAACC,UAAS,KAACI,MAAO/D,EAAQiE,kBAE/DnB,EAAW,aAAAC,IAAA,2CAAAmB,OAAO,KAAAT,KAAMzD,EAAQmE,a","ignoreList":[]}
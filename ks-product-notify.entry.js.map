{"version":3,"names":["productNotifyCss","ProductNotify","async","event","strings","product","get","productId","api","commonDynamic","notifyAvailability","preventDefault","ValidateInput","this","root","querySelector","dialog","showLoading","target","data","FormData","append","fetch","body","method","then","response","json","containsData","Error","notifyErrorParagraph","status","showSuccess","heading","paragraph","showFailure","catch","error","message","window","navigator","onLine","noInternet","console","log","notifyErrorHeading","show","componentDidLoad","render","h","onSubmit","e","requestHandler","class","notifyHeading","notifyParagraph","href","common","email","name","required","nomessage","placeholder","icon","checked","label","notifyBackorders","notifyAgreement","submit","notifyMe"],"sources":["src/components/product/product-notify.css?tag=ks-product-notify","src/components/product/product-notify.tsx"],"sourcesContent":["ks-product-notify {\n    display: block;\n}\n\nks-product-notify fieldset {\n    border: none;\n    margin: 0;\n    padding: 0;\n}\n\nks-product-notify .info {\n    text-align: center;\n    margin-bottom: 40px;\n}\n\nks-product-notify .info a {\n    text-decoration: none;\n    color: black;\n    margin: 0 5px;\n}\n\nks-product-notify h3 {\n    font-family: var(--font-emphasis);\n    font-size: 20px;\n    font-weight: 700;\n}\n\nks-product-notify ks-input-check {\n    margin-bottom: 5px;\n}\n\nks-product-notify ks-button {\n    margin-top: 20px;\n}","import { Component, h, Element, Method, State } from '@stencil/core';\nimport { product } from \"../../global/data/product\";\nimport { common } from \"../../global/data/common\";\nimport { commonDynamic } from \"../../global/data/commonDynamic\";\nimport ValidateInput from '../input/validate';\n\n@Component({\n    tag: 'ks-product-notify',\n    styleUrl: 'product-notify.css'\n})\nexport class ProductNotify {\n    @Element() root: HTMLElement;\n    dialog: HTMLKsDialogElement;\n\n    @State() resultHeading: string;\n    @State() resultParagraph: string;\n\n    async requestHandler(event: Event) {\n        const strings = product.get(\"strings\");\n        const productId = product.get(\"id\");\n        const api = commonDynamic.get(\"api\").notifyAvailability;\n\n        event.preventDefault();\n        if(!await ValidateInput(this.root.querySelector('form')))\n            return;\n\n        this.dialog.showLoading();\n\n        const target = event.target as HTMLFormElement;\n        const data = new FormData(target);\n        data.append(\"product\", productId);\n\n        await fetch(api, { body: data, method: \"post\"})\n        .then(async response => response.json())\n        .then(async data => {\n            const containsData = \"status\" in data && \"heading\" in data && \"paragraph\" in data;\n            if (!containsData) throw new Error(strings.notifyErrorParagraph);\n                \n            if(data.status == \"success\")\n                this.dialog.showSuccess(data.heading, data.paragraph);\n\n            else this.dialog.showFailure(data.heading, data.paragraph);\n        })\n        .catch(async error => {\n            let message = \"\";\n\n            if(!window.navigator.onLine)\n                message = strings.noInternet;\n\n            else if(error.message != \"\")\n                message = error.message;\n\n            console.log(error.message);\n            this.dialog.showFailure(strings.notifyErrorHeading, message);\n        });\n    }\n\n    @Method()\n    async show() {\n        this.dialog.show();\n    }\n\n    componentDidLoad() {\n        this.dialog = this.root.querySelector('ks-dialog');\n    }\n\n\trender() {\n        const strings = product.get(\"strings\");\n\n\t\treturn <ks-dialog>\n            <form onSubmit={e => this.requestHandler(e)}>\n                <fieldset>\n                    <div class=\"info\">\n                        <h3>{strings.notifyHeading}</h3>\n                        <p>{strings.notifyParagraph}</p>\n\n                        <a href={\"mailto:\" + common.get('email')}>{common.get('email')}</a> â€¢\n                        <a href={\"tel:\" + common.get('phone')}>{common.get('phone')}</a>\n                    </div>\n\n                    <ks-input-text email name=\"email\" required nomessage placeholder=\"E-mail\" icon=\"mail\"/>\n                    <ks-input-check checked name=\"backorders\" nomessage label={strings.notifyBackorders}></ks-input-check>\n\n                    <ks-input-check name=\"zgoda\" required nomessage label={strings.notifyAgreement}></ks-input-check>\n\n                    <ks-button submit name={strings.notifyMe} />\n                </fieldset>\n            </form>\n        </ks-dialog>;\n    }\n\n}\n"],"mappings":"gQAAA,MAAMA,EAAmB,sZ,MCUZC,EAAa,M,qFAOtBC,qBAAqBC,GACjB,MAAMC,EAAUC,EAAQC,IAAI,WAC5B,MAAMC,EAAYF,EAAQC,IAAI,MAC9B,MAAME,EAAMC,EAAcH,IAAI,OAAOI,mBAErCP,EAAMQ,iBACN,UAAUC,EAAcC,KAAKC,KAAKC,cAAc,SAC5C,OAEJF,KAAKG,OAAOC,cAEZ,MAAMC,EAASf,EAAMe,OACrB,MAAMC,EAAO,IAAIC,SAASF,GAC1BC,EAAKE,OAAO,UAAWd,SAEjBe,MAAMd,EAAK,CAAEe,KAAMJ,EAAMK,OAAQ,SACtCC,MAAKvB,MAAMwB,GAAYA,EAASC,SAChCF,MAAKvB,MAAMiB,IACR,MAAMS,EAAe,WAAYT,GAAQ,YAAaA,GAAQ,cAAeA,EAC7E,IAAKS,EAAc,MAAM,IAAIC,MAAMzB,EAAQ0B,sBAE3C,GAAGX,EAAKY,QAAU,UACdlB,KAAKG,OAAOgB,YAAYb,EAAKc,QAASd,EAAKe,gBAE1CrB,KAAKG,OAAOmB,YAAYhB,EAAKc,QAASd,EAAKe,UAAU,IAE7DE,OAAMlC,MAAMmC,IACT,IAAIC,EAAU,GAEd,IAAIC,OAAOC,UAAUC,OACjBH,EAAUlC,EAAQsC,gBAEjB,GAAGL,EAAMC,SAAW,GACrBA,EAAUD,EAAMC,QAEpBK,QAAQC,IAAIP,EAAMC,SAClBzB,KAAKG,OAAOmB,YAAY/B,EAAQyC,mBAAoBP,EAAQ,G,CAKpEpC,aACIW,KAAKG,OAAO8B,M,CAGhBC,mBACIlC,KAAKG,OAASH,KAAKC,KAAKC,cAAc,Y,CAG7CiC,SACO,MAAM5C,EAAUC,EAAQC,IAAI,WAElC,OAAO2C,EAAA,iBACGA,EAAA,QAAMC,SAAUC,GAAKtC,KAAKuC,eAAeD,IACrCF,EAAA,gBACIA,EAAA,OAAKI,MAAM,QACPJ,EAAA,UAAK7C,EAAQkD,eACbL,EAAA,SAAI7C,EAAQmD,iBAEZN,EAAA,KAAGO,KAAM,UAAYC,EAAOnD,IAAI,UAAWmD,EAAOnD,IAAI,UAAa,KACnE2C,EAAA,KAAGO,KAAM,OAASC,EAAOnD,IAAI,UAAWmD,EAAOnD,IAAI,WAGvD2C,EAAA,iBAAeS,MAAK,KAACC,KAAK,QAAQC,SAAQ,KAACC,UAAS,KAACC,YAAY,SAASC,KAAK,SAC/Ed,EAAA,kBAAgBe,QAAO,KAACL,KAAK,aAAaE,UAAS,KAACI,MAAO7D,EAAQ8D,mBAEnEjB,EAAA,kBAAgBU,KAAK,QAAQC,SAAQ,KAACC,UAAS,KAACI,MAAO7D,EAAQ+D,kBAE/DlB,EAAA,aAAWmB,OAAM,KAACT,KAAMvD,EAAQiE,a"}